{"ast":null,"code":"import { Browser, remove, EventHandler, isUndefined, closest, classList, isBlazor } from '@syncfusion/ej2-base';\nimport { parentsUntil } from '../base/util';\nimport * as events from '../base/constant';\n/**\n * The `Clipboard` module is used to handle clipboard copy action.\n */\n\nvar Clipboard =\n/** @class */\nfunction () {\n  /**\n   * Constructor for the Grid clipboard module\n   * @hidden\n   */\n  function Clipboard(parent) {\n    this.copyContent = '';\n    this.isSelect = false;\n    this.parent = parent;\n    this.addEventListener();\n  }\n  /**\n   * @hidden\n   */\n\n\n  Clipboard.prototype.addEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.on(events.contentReady, this.initialEnd, this);\n    this.parent.on(events.keyPressed, this.keyDownHandler, this);\n    this.parent.on(events.click, this.clickHandler, this);\n    EventHandler.add(this.parent.element, 'keydown', this.pasteHandler, this);\n  };\n  /**\n   * @hidden\n   */\n\n\n  Clipboard.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.off(events.keyPressed, this.keyDownHandler);\n    this.parent.off(events.contentReady, this.initialEnd);\n    this.parent.off(events.click, this.clickHandler);\n    EventHandler.remove(this.parent.element, 'keydown', this.pasteHandler);\n  };\n\n  Clipboard.prototype.clickHandler = function (e) {\n    var target = e.target;\n    target = parentsUntil(target, 'e-rowcell');\n  };\n\n  Clipboard.prototype.pasteHandler = function (e) {\n    var _this = this;\n\n    var grid = this.parent;\n    var isMacLike = /(Mac)/i.test(navigator.platform);\n\n    if (e.keyCode === 86 && (e.ctrlKey || isMacLike && e.metaKey) && !grid.isEdit) {\n      var target = closest(document.activeElement, '.e-rowcell');\n\n      if (!target || !grid.editSettings.allowEditing || grid.editSettings.mode !== 'Batch' || grid.selectionSettings.mode !== 'Cell' || grid.selectionSettings.cellSelectionMode === 'Flow') {\n        return;\n      }\n\n      this.activeElement = document.activeElement;\n      this.clipBoardTextArea.value = '';\n      var x_1 = window.scrollX;\n      var y_1 = window.scrollY;\n      this.clipBoardTextArea.focus();\n      setTimeout(function () {\n        _this.activeElement.focus();\n\n        window.scrollTo(x_1, y_1);\n\n        _this.paste(_this.clipBoardTextArea.value, _this.parent.getSelectedRowCellIndexes()[0].rowIndex, _this.parent.getSelectedRowCellIndexes()[0].cellIndexes[0]);\n      }, 10);\n    }\n  };\n  /**\n   * Paste data from clipboard to selected cells.\n   * @param {boolean} data - Specifies the date for paste.\n   * @param {boolean} rowIndex - Specifies the row index.\n   * @param {boolean} colIndex - Specifies the column index.\n   */\n\n\n  Clipboard.prototype.paste = function (data, rowIndex, colIndex) {\n    var grid = this.parent;\n    var cIdx = colIndex;\n    var rIdx = rowIndex;\n    var col;\n    var value;\n    var isAvail;\n\n    if (!grid.editSettings.allowEditing || grid.editSettings.mode !== 'Batch' || grid.selectionSettings.mode !== 'Cell' || grid.selectionSettings.cellSelectionMode === 'Flow') {\n      return;\n    }\n\n    var rows = data.split('\\n');\n    var cols;\n    var dataRows = grid.getDataRows();\n    var mRows;\n    var frRows;\n    var isFrozen = this.parent.isFrozenGrid();\n\n    if (isFrozen) {\n      mRows = grid.getMovableDataRows();\n\n      if (grid.getFrozenRightColumnsCount()) {\n        frRows = grid.getFrozenRightDataRows();\n      }\n    }\n\n    for (var r = 0; r < rows.length; r++) {\n      cols = rows[r].split('\\t');\n      cIdx = colIndex;\n\n      if (r === rows.length - 1 && rows[r] === '' || isUndefined(grid.getRowByIndex(rIdx))) {\n        cIdx++;\n        break;\n      }\n\n      for (var c = 0; c < cols.length; c++) {\n        isAvail = grid.getCellFromIndex(rIdx, cIdx);\n\n        if (isFrozen) {\n          var fTr = dataRows[rIdx];\n          var mTr = mRows[rIdx];\n          isAvail = !fTr.querySelector('[aria-colindex=\"' + cIdx + '\"]') ? mTr.querySelector('[aria-colindex=\"' + cIdx + '\"]') : true;\n\n          if (frRows && !isAvail) {\n            var frTr = frRows[rIdx];\n            isAvail = frTr.querySelector('[aria-colindex=\"' + cIdx + '\"]');\n          }\n        }\n\n        if (!isAvail) {\n          cIdx++;\n          break;\n        }\n\n        col = grid.getColumnByIndex(cIdx);\n        value = col.getParser() ? col.getParser()(cols[c]) : cols[c];\n\n        if (col.allowEditing && !col.isPrimaryKey && !col.template) {\n          var args = {\n            column: col,\n            data: value,\n            rowIndex: rIdx\n          };\n          this.parent.trigger(events.beforePaste, args);\n          rIdx = args.rowIndex;\n\n          if (!args.cancel) {\n            if (grid.editModule) {\n              if (col.type === 'number') {\n                this.parent.editModule.updateCell(rIdx, col.field, parseFloat(args.data));\n              } else {\n                grid.editModule.updateCell(rIdx, col.field, args.data);\n              }\n            }\n          }\n        }\n\n        cIdx++;\n      }\n\n      rIdx++;\n    }\n\n    grid.selectionModule.selectCellsByRange({\n      rowIndex: rowIndex,\n      cellIndex: colIndex\n    }, {\n      rowIndex: rIdx - 1,\n      cellIndex: cIdx - 1\n    });\n    var cell = this.parent.getCellFromIndex(rIdx - 1, cIdx - 1);\n\n    if (cell) {\n      classList(cell, ['e-focus', 'e-focused'], []);\n    }\n  };\n\n  Clipboard.prototype.initialEnd = function () {\n    this.parent.off(events.contentReady, this.initialEnd);\n    this.clipBoardTextArea = this.parent.createElement('textarea', {\n      className: 'e-clipboard',\n      styles: 'opacity: 0',\n      attrs: {\n        tabindex: '-1',\n        'aria-label': 'clipboard'\n      }\n    });\n    this.parent.element.appendChild(this.clipBoardTextArea);\n  };\n\n  Clipboard.prototype.keyDownHandler = function (e) {\n    if (e.action === 'ctrlPlusC') {\n      this.copy();\n    } else if (e.action === 'ctrlShiftPlusH') {\n      this.copy(true);\n    }\n  };\n\n  Clipboard.prototype.setCopyData = function (withHeader) {\n    if (window.getSelection().toString() === '') {\n      var isFrozen = this.parent.isFrozenGrid();\n      this.clipBoardTextArea.value = this.copyContent = '';\n      var mRows = void 0;\n      var frRows = void 0;\n      var rows = this.parent.getRows();\n\n      if (isFrozen) {\n        mRows = this.parent.getMovableDataRows();\n\n        if (this.parent.getFrozenMode() === 'Left-Right') {\n          frRows = this.parent.getFrozenRightRows();\n        }\n      }\n\n      if (this.parent.selectionSettings.mode !== 'Cell') {\n        var selectedIndexes = this.parent.getSelectedRowIndexes().sort(function (a, b) {\n          return a - b;\n        });\n\n        if (withHeader) {\n          var headerTextArray = [];\n\n          for (var i = 0; i < this.parent.getVisibleColumns().length; i++) {\n            headerTextArray[i] = this.parent.getVisibleColumns()[i].headerText;\n          }\n\n          this.getCopyData(headerTextArray, false, '\\t', withHeader);\n          this.copyContent += '\\n';\n        }\n\n        for (var i = 0; i < selectedIndexes.length; i++) {\n          if (i > 0) {\n            this.copyContent += '\\n';\n          }\n\n          var cells = [].slice.call(rows[selectedIndexes[i]].querySelectorAll('.e-rowcell'));\n\n          if (isFrozen) {\n            cells.push.apply(cells, [].slice.call(mRows[selectedIndexes[i]].querySelectorAll('.e-rowcell')));\n\n            if (frRows) {\n              cells.push.apply(cells, [].slice.call(frRows[selectedIndexes[i]].querySelectorAll('.e-rowcell')));\n            }\n          }\n\n          this.getCopyData(cells, false, '\\t', withHeader);\n        }\n      } else {\n        var obj = this.checkBoxSelection();\n\n        if (obj.status) {\n          if (withHeader) {\n            var headers = [];\n\n            for (var i = 0; i < obj.colIndexes.length; i++) {\n              headers.push(this.parent.getColumnHeaderByIndex(obj.colIndexes[i]));\n            }\n\n            this.getCopyData(headers, false, '\\t', withHeader);\n            this.copyContent += '\\n';\n          }\n\n          for (var i = 0; i < obj.rowIndexes.length; i++) {\n            if (i > 0) {\n              this.copyContent += '\\n';\n            }\n\n            var cells = [].slice.call(rows[obj.rowIndexes[i]].querySelectorAll('.e-cellselectionbackground'));\n\n            if (isFrozen) {\n              cells.push.apply(cells, [].slice.call(mRows[obj.rowIndexes[i]].querySelectorAll('.e-cellselectionbackground')));\n\n              if (frRows) {\n                cells.push.apply(cells, [].slice.call(frRows[obj.rowIndexes[i]].querySelectorAll('.e-cellselectionbackground')));\n              }\n            }\n\n            this.getCopyData(cells, false, '\\t', withHeader);\n          }\n        } else {\n          this.getCopyData([].slice.call(this.parent.element.querySelectorAll('.e-cellselectionbackground')), true, '\\n', withHeader);\n        }\n      }\n\n      var args = {\n        data: this.copyContent,\n        cancel: false\n      };\n      this.parent.trigger(events.beforeCopy, args);\n\n      if (args.cancel) {\n        return;\n      }\n\n      this.clipBoardTextArea.value = this.copyContent = args.data;\n\n      if (!Browser.userAgent.match(/ipad|ipod|iphone/i)) {\n        this.clipBoardTextArea.select();\n      } else {\n        this.clipBoardTextArea.setSelectionRange(0, this.clipBoardTextArea.value.length);\n      }\n\n      this.isSelect = true;\n    }\n  };\n\n  Clipboard.prototype.getCopyData = function (cells, isCell, splitKey, withHeader) {\n    var isElement = typeof cells[0] !== 'string';\n\n    for (var j = 0; j < cells.length; j++) {\n      if (withHeader && isCell) {\n        this.copyContent += this.parent.getColumns()[parseInt(cells[j].getAttribute('aria-colindex'), 10)].headerText + '\\n';\n      }\n\n      if (isElement) {\n        if (!cells[j].classList.contains('e-hide')) {\n          if (isBlazor()) {\n            if (!cells[j].classList.contains('e-gridchkbox') && Object.keys(cells[j].querySelectorAll('.e-check')).length) {\n              this.copyContent += true;\n            } else if (!cells[j].classList.contains('e-gridchkbox') && Object.keys(cells[j].querySelectorAll('.e-uncheck')).length) {\n              this.copyContent += false;\n            } else {\n              this.copyContent += cells[j].innerText;\n            }\n          } else {\n            this.copyContent += cells[j].innerText;\n          }\n        }\n      } else {\n        this.copyContent += cells[j];\n      }\n\n      if (j < cells.length - 1) {\n        this.copyContent += splitKey;\n      }\n    }\n  };\n  /**\n   * Copy selected rows or cells data into clipboard.\n   * @param {boolean} withHeader - Specifies whether the column header data need to be copied or not.\n   */\n\n\n  Clipboard.prototype.copy = function (withHeader) {\n    if (document.queryCommandSupported('copy')) {\n      this.setCopyData(withHeader);\n      document.execCommand('copy');\n      this.clipBoardTextArea.blur();\n    }\n\n    if (this.isSelect) {\n      window.getSelection().removeAllRanges();\n      this.isSelect = false;\n    }\n  };\n  /**\n   * For internal use only - Get the module name.\n   * @private\n   */\n\n\n  Clipboard.prototype.getModuleName = function () {\n    return 'clipboard';\n  };\n  /**\n   * To destroy the clipboard\n   * @return {void}\n   * @hidden\n   */\n\n\n  Clipboard.prototype.destroy = function () {\n    this.removeEventListener();\n\n    if (this.clipBoardTextArea) {\n      remove(this.clipBoardTextArea);\n    }\n  };\n\n  Clipboard.prototype.checkBoxSelection = function () {\n    var gridObj = this.parent;\n    var obj = {\n      status: false\n    };\n\n    if (gridObj.selectionSettings.mode === 'Cell') {\n      var rowCellIndxes = gridObj.getSelectedRowCellIndexes();\n      var str = void 0;\n      var isBox = void 0;\n      var rowIndexes = [];\n      var i = void 0;\n\n      for (i = 0; i < rowCellIndxes.length; i++) {\n        if (rowCellIndxes[i].cellIndexes.length) {\n          rowIndexes.push(rowCellIndxes[i].rowIndex);\n        }\n\n        if (rowCellIndxes[i].cellIndexes.length) {\n          if (!str) {\n            str = JSON.stringify(rowCellIndxes[i].cellIndexes.sort());\n          }\n\n          if (str !== JSON.stringify(rowCellIndxes[i].cellIndexes.sort())) {\n            break;\n          }\n        }\n      }\n\n      rowIndexes.sort(function (a, b) {\n        return a - b;\n      });\n\n      if (i === rowCellIndxes.length && rowIndexes[rowIndexes.length - 1] - rowIndexes[0] === rowIndexes.length - 1) {\n        obj = {\n          status: true,\n          rowIndexes: rowIndexes,\n          colIndexes: rowCellIndxes[0].cellIndexes\n        };\n      }\n    }\n\n    return obj;\n  };\n\n  return Clipboard;\n}();\n\nexport { Clipboard };","map":{"version":3,"sources":["C:/Users/appsk/Documents/Projects/PredictiveMaintenance/React PDM/env/frontend/node_modules/@syncfusion/ej2-grids/src/grid/actions/clipboard.js"],"names":["Browser","remove","EventHandler","isUndefined","closest","classList","isBlazor","parentsUntil","events","Clipboard","parent","copyContent","isSelect","addEventListener","prototype","isDestroyed","on","contentReady","initialEnd","keyPressed","keyDownHandler","click","clickHandler","add","element","pasteHandler","removeEventListener","off","e","target","_this","grid","isMacLike","test","navigator","platform","keyCode","ctrlKey","metaKey","isEdit","document","activeElement","editSettings","allowEditing","mode","selectionSettings","cellSelectionMode","clipBoardTextArea","value","x_1","window","scrollX","y_1","scrollY","focus","setTimeout","scrollTo","paste","getSelectedRowCellIndexes","rowIndex","cellIndexes","data","colIndex","cIdx","rIdx","col","isAvail","rows","split","cols","dataRows","getDataRows","mRows","frRows","isFrozen","isFrozenGrid","getMovableDataRows","getFrozenRightColumnsCount","getFrozenRightDataRows","r","length","getRowByIndex","c","getCellFromIndex","fTr","mTr","querySelector","frTr","getColumnByIndex","getParser","isPrimaryKey","template","args","column","trigger","beforePaste","cancel","editModule","type","updateCell","field","parseFloat","selectionModule","selectCellsByRange","cellIndex","cell","createElement","className","styles","attrs","tabindex","appendChild","action","copy","setCopyData","withHeader","getSelection","toString","getRows","getFrozenMode","getFrozenRightRows","selectedIndexes","getSelectedRowIndexes","sort","a","b","headerTextArray","i","getVisibleColumns","headerText","getCopyData","cells","slice","call","querySelectorAll","push","apply","obj","checkBoxSelection","status","headers","colIndexes","getColumnHeaderByIndex","rowIndexes","beforeCopy","userAgent","match","select","setSelectionRange","isCell","splitKey","isElement","j","getColumns","parseInt","getAttribute","contains","Object","keys","innerText","queryCommandSupported","execCommand","blur","removeAllRanges","getModuleName","destroy","gridObj","rowCellIndxes","str","isBox","JSON","stringify"],"mappings":"AAAA,SAASA,OAAT,EAAkBC,MAAlB,EAA0BC,YAA1B,EAAwCC,WAAxC,EAAqDC,OAArD,EAA8DC,SAA9D,EAAyEC,QAAzE,QAAyF,sBAAzF;AACA,SAASC,YAAT,QAA6B,cAA7B;AACA,OAAO,KAAKC,MAAZ,MAAwB,kBAAxB;AACA;AACA;AACA;;AACA,IAAIC,SAAS;AAAG;AAAe,YAAY;AACvC;AACJ;AACA;AACA;AACI,WAASA,SAAT,CAAmBC,MAAnB,EAA2B;AACvB,SAAKC,WAAL,GAAmB,EAAnB;AACA,SAAKC,QAAL,GAAgB,KAAhB;AACA,SAAKF,MAAL,GAAcA,MAAd;AACA,SAAKG,gBAAL;AACH;AACD;AACJ;AACA;;;AACIJ,EAAAA,SAAS,CAACK,SAAV,CAAoBD,gBAApB,GAAuC,YAAY;AAC/C,QAAI,KAAKH,MAAL,CAAYK,WAAhB,EAA6B;AACzB;AACH;;AACD,SAAKL,MAAL,CAAYM,EAAZ,CAAeR,MAAM,CAACS,YAAtB,EAAoC,KAAKC,UAAzC,EAAqD,IAArD;AACA,SAAKR,MAAL,CAAYM,EAAZ,CAAeR,MAAM,CAACW,UAAtB,EAAkC,KAAKC,cAAvC,EAAuD,IAAvD;AACA,SAAKV,MAAL,CAAYM,EAAZ,CAAeR,MAAM,CAACa,KAAtB,EAA6B,KAAKC,YAAlC,EAAgD,IAAhD;AACApB,IAAAA,YAAY,CAACqB,GAAb,CAAiB,KAAKb,MAAL,CAAYc,OAA7B,EAAsC,SAAtC,EAAiD,KAAKC,YAAtD,EAAoE,IAApE;AACH,GARD;AASA;AACJ;AACA;;;AACIhB,EAAAA,SAAS,CAACK,SAAV,CAAoBY,mBAApB,GAA0C,YAAY;AAClD,QAAI,KAAKhB,MAAL,CAAYK,WAAhB,EAA6B;AACzB;AACH;;AACD,SAAKL,MAAL,CAAYiB,GAAZ,CAAgBnB,MAAM,CAACW,UAAvB,EAAmC,KAAKC,cAAxC;AACA,SAAKV,MAAL,CAAYiB,GAAZ,CAAgBnB,MAAM,CAACS,YAAvB,EAAqC,KAAKC,UAA1C;AACA,SAAKR,MAAL,CAAYiB,GAAZ,CAAgBnB,MAAM,CAACa,KAAvB,EAA8B,KAAKC,YAAnC;AACApB,IAAAA,YAAY,CAACD,MAAb,CAAoB,KAAKS,MAAL,CAAYc,OAAhC,EAAyC,SAAzC,EAAoD,KAAKC,YAAzD;AACH,GARD;;AASAhB,EAAAA,SAAS,CAACK,SAAV,CAAoBQ,YAApB,GAAmC,UAAUM,CAAV,EAAa;AAC5C,QAAIC,MAAM,GAAGD,CAAC,CAACC,MAAf;AACAA,IAAAA,MAAM,GAAGtB,YAAY,CAACsB,MAAD,EAAS,WAAT,CAArB;AACH,GAHD;;AAIApB,EAAAA,SAAS,CAACK,SAAV,CAAoBW,YAApB,GAAmC,UAAUG,CAAV,EAAa;AAC5C,QAAIE,KAAK,GAAG,IAAZ;;AACA,QAAIC,IAAI,GAAG,KAAKrB,MAAhB;AACA,QAAIsB,SAAS,GAAG,SAASC,IAAT,CAAcC,SAAS,CAACC,QAAxB,CAAhB;;AACA,QAAIP,CAAC,CAACQ,OAAF,KAAc,EAAd,KAAqBR,CAAC,CAACS,OAAF,IAAcL,SAAS,IAAIJ,CAAC,CAACU,OAAlD,KAA+D,CAACP,IAAI,CAACQ,MAAzE,EAAiF;AAC7E,UAAIV,MAAM,GAAGzB,OAAO,CAACoC,QAAQ,CAACC,aAAV,EAAyB,YAAzB,CAApB;;AACA,UAAI,CAACZ,MAAD,IAAW,CAACE,IAAI,CAACW,YAAL,CAAkBC,YAA9B,IAA8CZ,IAAI,CAACW,YAAL,CAAkBE,IAAlB,KAA2B,OAAzE,IACAb,IAAI,CAACc,iBAAL,CAAuBD,IAAvB,KAAgC,MADhC,IAC0Cb,IAAI,CAACc,iBAAL,CAAuBC,iBAAvB,KAA6C,MAD3F,EACmG;AAC/F;AACH;;AACD,WAAKL,aAAL,GAAqBD,QAAQ,CAACC,aAA9B;AACA,WAAKM,iBAAL,CAAuBC,KAAvB,GAA+B,EAA/B;AACA,UAAIC,GAAG,GAAGC,MAAM,CAACC,OAAjB;AACA,UAAIC,GAAG,GAAGF,MAAM,CAACG,OAAjB;AACA,WAAKN,iBAAL,CAAuBO,KAAvB;AACAC,MAAAA,UAAU,CAAC,YAAY;AACnBzB,QAAAA,KAAK,CAACW,aAAN,CAAoBa,KAApB;;AACAJ,QAAAA,MAAM,CAACM,QAAP,CAAgBP,GAAhB,EAAqBG,GAArB;;AACAtB,QAAAA,KAAK,CAAC2B,KAAN,CAAY3B,KAAK,CAACiB,iBAAN,CAAwBC,KAApC,EAA2ClB,KAAK,CAACpB,MAAN,CAAagD,yBAAb,GAAyC,CAAzC,EAA4CC,QAAvF,EAAiG7B,KAAK,CAACpB,MAAN,CAAagD,yBAAb,GAAyC,CAAzC,EAA4CE,WAA5C,CAAwD,CAAxD,CAAjG;AACH,OAJS,EAIP,EAJO,CAAV;AAKH;AACJ,GArBD;AAsBA;AACJ;AACA;AACA;AACA;AACA;;;AACInD,EAAAA,SAAS,CAACK,SAAV,CAAoB2C,KAApB,GAA4B,UAAUI,IAAV,EAAgBF,QAAhB,EAA0BG,QAA1B,EAAoC;AAC5D,QAAI/B,IAAI,GAAG,KAAKrB,MAAhB;AACA,QAAIqD,IAAI,GAAGD,QAAX;AACA,QAAIE,IAAI,GAAGL,QAAX;AACA,QAAIM,GAAJ;AACA,QAAIjB,KAAJ;AACA,QAAIkB,OAAJ;;AACA,QAAI,CAACnC,IAAI,CAACW,YAAL,CAAkBC,YAAnB,IAAmCZ,IAAI,CAACW,YAAL,CAAkBE,IAAlB,KAA2B,OAA9D,IACAb,IAAI,CAACc,iBAAL,CAAuBD,IAAvB,KAAgC,MADhC,IAC0Cb,IAAI,CAACc,iBAAL,CAAuBC,iBAAvB,KAA6C,MAD3F,EACmG;AAC/F;AACH;;AACD,QAAIqB,IAAI,GAAGN,IAAI,CAACO,KAAL,CAAW,IAAX,CAAX;AACA,QAAIC,IAAJ;AACA,QAAIC,QAAQ,GAAGvC,IAAI,CAACwC,WAAL,EAAf;AACA,QAAIC,KAAJ;AACA,QAAIC,MAAJ;AACA,QAAIC,QAAQ,GAAG,KAAKhE,MAAL,CAAYiE,YAAZ,EAAf;;AACA,QAAID,QAAJ,EAAc;AACVF,MAAAA,KAAK,GAAGzC,IAAI,CAAC6C,kBAAL,EAAR;;AACA,UAAI7C,IAAI,CAAC8C,0BAAL,EAAJ,EAAuC;AACnCJ,QAAAA,MAAM,GAAG1C,IAAI,CAAC+C,sBAAL,EAAT;AACH;AACJ;;AACD,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGZ,IAAI,CAACa,MAAzB,EAAiCD,CAAC,EAAlC,EAAsC;AAClCV,MAAAA,IAAI,GAAGF,IAAI,CAACY,CAAD,CAAJ,CAAQX,KAAR,CAAc,IAAd,CAAP;AACAL,MAAAA,IAAI,GAAGD,QAAP;;AACA,UAAKiB,CAAC,KAAKZ,IAAI,CAACa,MAAL,GAAc,CAApB,IAAyBb,IAAI,CAACY,CAAD,CAAJ,KAAY,EAAtC,IAA6C5E,WAAW,CAAC4B,IAAI,CAACkD,aAAL,CAAmBjB,IAAnB,CAAD,CAA5D,EAAwF;AACpFD,QAAAA,IAAI;AACJ;AACH;;AACD,WAAK,IAAImB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGb,IAAI,CAACW,MAAzB,EAAiCE,CAAC,EAAlC,EAAsC;AAClChB,QAAAA,OAAO,GAAGnC,IAAI,CAACoD,gBAAL,CAAsBnB,IAAtB,EAA4BD,IAA5B,CAAV;;AACA,YAAIW,QAAJ,EAAc;AACV,cAAIU,GAAG,GAAGd,QAAQ,CAACN,IAAD,CAAlB;AACA,cAAIqB,GAAG,GAAGb,KAAK,CAACR,IAAD,CAAf;AACAE,UAAAA,OAAO,GAAG,CAACkB,GAAG,CAACE,aAAJ,CAAkB,qBAAqBvB,IAArB,GAA4B,IAA9C,CAAD,GACNsB,GAAG,CAACC,aAAJ,CAAkB,qBAAqBvB,IAArB,GAA4B,IAA9C,CADM,GACgD,IAD1D;;AAEA,cAAIU,MAAM,IAAI,CAACP,OAAf,EAAwB;AACpB,gBAAIqB,IAAI,GAAGd,MAAM,CAACT,IAAD,CAAjB;AACAE,YAAAA,OAAO,GAAGqB,IAAI,CAACD,aAAL,CAAmB,qBAAqBvB,IAArB,GAA4B,IAA/C,CAAV;AACH;AACJ;;AACD,YAAI,CAACG,OAAL,EAAc;AACVH,UAAAA,IAAI;AACJ;AACH;;AACDE,QAAAA,GAAG,GAAGlC,IAAI,CAACyD,gBAAL,CAAsBzB,IAAtB,CAAN;AACAf,QAAAA,KAAK,GAAGiB,GAAG,CAACwB,SAAJ,KAAkBxB,GAAG,CAACwB,SAAJ,GAAgBpB,IAAI,CAACa,CAAD,CAApB,CAAlB,GAA6Cb,IAAI,CAACa,CAAD,CAAzD;;AACA,YAAIjB,GAAG,CAACtB,YAAJ,IAAoB,CAACsB,GAAG,CAACyB,YAAzB,IAAyC,CAACzB,GAAG,CAAC0B,QAAlD,EAA4D;AACxD,cAAIC,IAAI,GAAG;AACPC,YAAAA,MAAM,EAAE5B,GADD;AAEPJ,YAAAA,IAAI,EAAEb,KAFC;AAGPW,YAAAA,QAAQ,EAAEK;AAHH,WAAX;AAKA,eAAKtD,MAAL,CAAYoF,OAAZ,CAAoBtF,MAAM,CAACuF,WAA3B,EAAwCH,IAAxC;AACA5B,UAAAA,IAAI,GAAG4B,IAAI,CAACjC,QAAZ;;AACA,cAAI,CAACiC,IAAI,CAACI,MAAV,EAAkB;AACd,gBAAIjE,IAAI,CAACkE,UAAT,EAAqB;AACjB,kBAAIhC,GAAG,CAACiC,IAAJ,KAAa,QAAjB,EAA2B;AACvB,qBAAKxF,MAAL,CAAYuF,UAAZ,CAAuBE,UAAvB,CAAkCnC,IAAlC,EAAwCC,GAAG,CAACmC,KAA5C,EAAmDC,UAAU,CAACT,IAAI,CAAC/B,IAAN,CAA7D;AACH,eAFD,MAGK;AACD9B,gBAAAA,IAAI,CAACkE,UAAL,CAAgBE,UAAhB,CAA2BnC,IAA3B,EAAiCC,GAAG,CAACmC,KAArC,EAA4CR,IAAI,CAAC/B,IAAjD;AACH;AACJ;AACJ;AACJ;;AACDE,QAAAA,IAAI;AACP;;AACDC,MAAAA,IAAI;AACP;;AACDjC,IAAAA,IAAI,CAACuE,eAAL,CAAqBC,kBAArB,CAAwC;AAAE5C,MAAAA,QAAQ,EAAEA,QAAZ;AAAsB6C,MAAAA,SAAS,EAAE1C;AAAjC,KAAxC,EAAqF;AAAEH,MAAAA,QAAQ,EAAEK,IAAI,GAAG,CAAnB;AAAsBwC,MAAAA,SAAS,EAAEzC,IAAI,GAAG;AAAxC,KAArF;AACA,QAAI0C,IAAI,GAAG,KAAK/F,MAAL,CAAYyE,gBAAZ,CAA6BnB,IAAI,GAAG,CAApC,EAAuCD,IAAI,GAAG,CAA9C,CAAX;;AACA,QAAI0C,IAAJ,EAAU;AACNpG,MAAAA,SAAS,CAACoG,IAAD,EAAO,CAAC,SAAD,EAAY,WAAZ,CAAP,EAAiC,EAAjC,CAAT;AACH;AACJ,GA5ED;;AA6EAhG,EAAAA,SAAS,CAACK,SAAV,CAAoBI,UAApB,GAAiC,YAAY;AACzC,SAAKR,MAAL,CAAYiB,GAAZ,CAAgBnB,MAAM,CAACS,YAAvB,EAAqC,KAAKC,UAA1C;AACA,SAAK6B,iBAAL,GAAyB,KAAKrC,MAAL,CAAYgG,aAAZ,CAA0B,UAA1B,EAAsC;AAC3DC,MAAAA,SAAS,EAAE,aADgD;AAE3DC,MAAAA,MAAM,EAAE,YAFmD;AAG3DC,MAAAA,KAAK,EAAE;AAAEC,QAAAA,QAAQ,EAAE,IAAZ;AAAkB,sBAAc;AAAhC;AAHoD,KAAtC,CAAzB;AAKA,SAAKpG,MAAL,CAAYc,OAAZ,CAAoBuF,WAApB,CAAgC,KAAKhE,iBAArC;AACH,GARD;;AASAtC,EAAAA,SAAS,CAACK,SAAV,CAAoBM,cAApB,GAAqC,UAAUQ,CAAV,EAAa;AAC9C,QAAIA,CAAC,CAACoF,MAAF,KAAa,WAAjB,EAA8B;AAC1B,WAAKC,IAAL;AACH,KAFD,MAGK,IAAIrF,CAAC,CAACoF,MAAF,KAAa,gBAAjB,EAAmC;AACpC,WAAKC,IAAL,CAAU,IAAV;AACH;AACJ,GAPD;;AAQAxG,EAAAA,SAAS,CAACK,SAAV,CAAoBoG,WAApB,GAAkC,UAAUC,UAAV,EAAsB;AACpD,QAAIjE,MAAM,CAACkE,YAAP,GAAsBC,QAAtB,OAAqC,EAAzC,EAA6C;AACzC,UAAI3C,QAAQ,GAAG,KAAKhE,MAAL,CAAYiE,YAAZ,EAAf;AACA,WAAK5B,iBAAL,CAAuBC,KAAvB,GAA+B,KAAKrC,WAAL,GAAmB,EAAlD;AACA,UAAI6D,KAAK,GAAG,KAAK,CAAjB;AACA,UAAIC,MAAM,GAAG,KAAK,CAAlB;AACA,UAAIN,IAAI,GAAG,KAAKzD,MAAL,CAAY4G,OAAZ,EAAX;;AACA,UAAI5C,QAAJ,EAAc;AACVF,QAAAA,KAAK,GAAG,KAAK9D,MAAL,CAAYkE,kBAAZ,EAAR;;AACA,YAAI,KAAKlE,MAAL,CAAY6G,aAAZ,OAAgC,YAApC,EAAkD;AAC9C9C,UAAAA,MAAM,GAAG,KAAK/D,MAAL,CAAY8G,kBAAZ,EAAT;AACH;AACJ;;AACD,UAAI,KAAK9G,MAAL,CAAYmC,iBAAZ,CAA8BD,IAA9B,KAAuC,MAA3C,EAAmD;AAC/C,YAAI6E,eAAe,GAAG,KAAK/G,MAAL,CAAYgH,qBAAZ,GAAoCC,IAApC,CAAyC,UAAUC,CAAV,EAAaC,CAAb,EAAgB;AAAE,iBAAOD,CAAC,GAAGC,CAAX;AAAe,SAA1E,CAAtB;;AACA,YAAIV,UAAJ,EAAgB;AACZ,cAAIW,eAAe,GAAG,EAAtB;;AACA,eAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKrH,MAAL,CAAYsH,iBAAZ,GAAgChD,MAApD,EAA4D+C,CAAC,EAA7D,EAAiE;AAC7DD,YAAAA,eAAe,CAACC,CAAD,CAAf,GAAqB,KAAKrH,MAAL,CAAYsH,iBAAZ,GAAgCD,CAAhC,EAAmCE,UAAxD;AACH;;AACD,eAAKC,WAAL,CAAiBJ,eAAjB,EAAkC,KAAlC,EAAyC,IAAzC,EAA+CX,UAA/C;AACA,eAAKxG,WAAL,IAAoB,IAApB;AACH;;AACD,aAAK,IAAIoH,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGN,eAAe,CAACzC,MAApC,EAA4C+C,CAAC,EAA7C,EAAiD;AAC7C,cAAIA,CAAC,GAAG,CAAR,EAAW;AACP,iBAAKpH,WAAL,IAAoB,IAApB;AACH;;AACD,cAAIwH,KAAK,GAAG,GAAGC,KAAH,CAASC,IAAT,CAAclE,IAAI,CAACsD,eAAe,CAACM,CAAD,CAAhB,CAAJ,CAAyBO,gBAAzB,CAA0C,YAA1C,CAAd,CAAZ;;AACA,cAAI5D,QAAJ,EAAc;AACVyD,YAAAA,KAAK,CAACI,IAAN,CAAWC,KAAX,CAAiBL,KAAjB,EAAwB,GAAGC,KAAH,CAASC,IAAT,CAAc7D,KAAK,CAACiD,eAAe,CAACM,CAAD,CAAhB,CAAL,CAA0BO,gBAA1B,CAA2C,YAA3C,CAAd,CAAxB;;AACA,gBAAI7D,MAAJ,EAAY;AACR0D,cAAAA,KAAK,CAACI,IAAN,CAAWC,KAAX,CAAiBL,KAAjB,EAAwB,GAAGC,KAAH,CAASC,IAAT,CAAc5D,MAAM,CAACgD,eAAe,CAACM,CAAD,CAAhB,CAAN,CAA2BO,gBAA3B,CAA4C,YAA5C,CAAd,CAAxB;AACH;AACJ;;AACD,eAAKJ,WAAL,CAAiBC,KAAjB,EAAwB,KAAxB,EAA+B,IAA/B,EAAqChB,UAArC;AACH;AACJ,OAvBD,MAwBK;AACD,YAAIsB,GAAG,GAAG,KAAKC,iBAAL,EAAV;;AACA,YAAID,GAAG,CAACE,MAAR,EAAgB;AACZ,cAAIxB,UAAJ,EAAgB;AACZ,gBAAIyB,OAAO,GAAG,EAAd;;AACA,iBAAK,IAAIb,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGU,GAAG,CAACI,UAAJ,CAAe7D,MAAnC,EAA2C+C,CAAC,EAA5C,EAAgD;AAC5Ca,cAAAA,OAAO,CAACL,IAAR,CAAa,KAAK7H,MAAL,CAAYoI,sBAAZ,CAAmCL,GAAG,CAACI,UAAJ,CAAed,CAAf,CAAnC,CAAb;AACH;;AACD,iBAAKG,WAAL,CAAiBU,OAAjB,EAA0B,KAA1B,EAAiC,IAAjC,EAAuCzB,UAAvC;AACA,iBAAKxG,WAAL,IAAoB,IAApB;AACH;;AACD,eAAK,IAAIoH,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGU,GAAG,CAACM,UAAJ,CAAe/D,MAAnC,EAA2C+C,CAAC,EAA5C,EAAgD;AAC5C,gBAAIA,CAAC,GAAG,CAAR,EAAW;AACP,mBAAKpH,WAAL,IAAoB,IAApB;AACH;;AACD,gBAAIwH,KAAK,GAAG,GAAGC,KAAH,CAASC,IAAT,CAAclE,IAAI,CAACsE,GAAG,CAACM,UAAJ,CAAehB,CAAf,CAAD,CAAJ,CACtBO,gBADsB,CACL,4BADK,CAAd,CAAZ;;AAEA,gBAAI5D,QAAJ,EAAc;AACVyD,cAAAA,KAAK,CAACI,IAAN,CAAWC,KAAX,CAAiBL,KAAjB,EAAwB,GAAGC,KAAH,CAASC,IAAT,CAAc7D,KAAK,CAACiE,GAAG,CAACM,UAAJ,CAAehB,CAAf,CAAD,CAAL,CACjCO,gBADiC,CAChB,4BADgB,CAAd,CAAxB;;AAEA,kBAAI7D,MAAJ,EAAY;AACR0D,gBAAAA,KAAK,CAACI,IAAN,CAAWC,KAAX,CAAiBL,KAAjB,EAAwB,GAAGC,KAAH,CAASC,IAAT,CAAc5D,MAAM,CAACgE,GAAG,CAACM,UAAJ,CAAehB,CAAf,CAAD,CAAN,CACjCO,gBADiC,CAChB,4BADgB,CAAd,CAAxB;AAEH;AACJ;;AACD,iBAAKJ,WAAL,CAAiBC,KAAjB,EAAwB,KAAxB,EAA+B,IAA/B,EAAqChB,UAArC;AACH;AACJ,SAzBD,MA0BK;AACD,eAAKe,WAAL,CAAiB,GAAGE,KAAH,CAASC,IAAT,CAAc,KAAK3H,MAAL,CAAYc,OAAZ,CAAoB8G,gBAApB,CAAqC,4BAArC,CAAd,CAAjB,EAAoG,IAApG,EAA0G,IAA1G,EAAgHnB,UAAhH;AACH;AACJ;;AACD,UAAIvB,IAAI,GAAG;AACP/B,QAAAA,IAAI,EAAE,KAAKlD,WADJ;AAEPqF,QAAAA,MAAM,EAAE;AAFD,OAAX;AAIA,WAAKtF,MAAL,CAAYoF,OAAZ,CAAoBtF,MAAM,CAACwI,UAA3B,EAAuCpD,IAAvC;;AACA,UAAIA,IAAI,CAACI,MAAT,EAAiB;AACb;AACH;;AACD,WAAKjD,iBAAL,CAAuBC,KAAvB,GAA+B,KAAKrC,WAAL,GAAmBiF,IAAI,CAAC/B,IAAvD;;AACA,UAAI,CAAC7D,OAAO,CAACiJ,SAAR,CAAkBC,KAAlB,CAAwB,mBAAxB,CAAL,EAAmD;AAC/C,aAAKnG,iBAAL,CAAuBoG,MAAvB;AACH,OAFD,MAGK;AACD,aAAKpG,iBAAL,CAAuBqG,iBAAvB,CAAyC,CAAzC,EAA4C,KAAKrG,iBAAL,CAAuBC,KAAvB,CAA6BgC,MAAzE;AACH;;AACD,WAAKpE,QAAL,GAAgB,IAAhB;AACH;AACJ,GAtFD;;AAuFAH,EAAAA,SAAS,CAACK,SAAV,CAAoBoH,WAApB,GAAkC,UAAUC,KAAV,EAAiBkB,MAAjB,EAAyBC,QAAzB,EAAmCnC,UAAnC,EAA+C;AAC7E,QAAIoC,SAAS,GAAG,OAAOpB,KAAK,CAAC,CAAD,CAAZ,KAAoB,QAApC;;AACA,SAAK,IAAIqB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGrB,KAAK,CAACnD,MAA1B,EAAkCwE,CAAC,EAAnC,EAAuC;AACnC,UAAIrC,UAAU,IAAIkC,MAAlB,EAA0B;AACtB,aAAK1I,WAAL,IAAoB,KAAKD,MAAL,CAAY+I,UAAZ,GAAyBC,QAAQ,CAACvB,KAAK,CAACqB,CAAD,CAAL,CAASG,YAAT,CAAsB,eAAtB,CAAD,EAAyC,EAAzC,CAAjC,EAA+E1B,UAA/E,GAA4F,IAAhH;AACH;;AACD,UAAIsB,SAAJ,EAAe;AACX,YAAI,CAACpB,KAAK,CAACqB,CAAD,CAAL,CAASnJ,SAAT,CAAmBuJ,QAAnB,CAA4B,QAA5B,CAAL,EAA4C;AACxC,cAAItJ,QAAQ,EAAZ,EAAgB;AACZ,gBAAK,CAAC6H,KAAK,CAACqB,CAAD,CAAL,CAASnJ,SAAT,CAAmBuJ,QAAnB,CAA4B,cAA5B,CAAF,IACAC,MAAM,CAACC,IAAP,CAAY3B,KAAK,CAACqB,CAAD,CAAL,CAASlB,gBAAT,CAA0B,UAA1B,CAAZ,EAAmDtD,MADvD,EAC+D;AAC3D,mBAAKrE,WAAL,IAAoB,IAApB;AACH,aAHD,MAIK,IAAK,CAACwH,KAAK,CAACqB,CAAD,CAAL,CAASnJ,SAAT,CAAmBuJ,QAAnB,CAA4B,cAA5B,CAAF,IACLC,MAAM,CAACC,IAAP,CAAY3B,KAAK,CAACqB,CAAD,CAAL,CAASlB,gBAAT,CAA0B,YAA1B,CAAZ,EAAqDtD,MADpD,EAC4D;AAC7D,mBAAKrE,WAAL,IAAoB,KAApB;AACH,aAHI,MAIA;AACD,mBAAKA,WAAL,IAAoBwH,KAAK,CAACqB,CAAD,CAAL,CAASO,SAA7B;AACH;AACJ,WAZD,MAaK;AACD,iBAAKpJ,WAAL,IAAoBwH,KAAK,CAACqB,CAAD,CAAL,CAASO,SAA7B;AACH;AACJ;AACJ,OAnBD,MAoBK;AACD,aAAKpJ,WAAL,IAAoBwH,KAAK,CAACqB,CAAD,CAAzB;AACH;;AACD,UAAIA,CAAC,GAAGrB,KAAK,CAACnD,MAAN,GAAe,CAAvB,EAA0B;AACtB,aAAKrE,WAAL,IAAoB2I,QAApB;AACH;AACJ;AACJ,GAjCD;AAkCA;AACJ;AACA;AACA;;;AACI7I,EAAAA,SAAS,CAACK,SAAV,CAAoBmG,IAApB,GAA2B,UAAUE,UAAV,EAAsB;AAC7C,QAAI3E,QAAQ,CAACwH,qBAAT,CAA+B,MAA/B,CAAJ,EAA4C;AACxC,WAAK9C,WAAL,CAAiBC,UAAjB;AACA3E,MAAAA,QAAQ,CAACyH,WAAT,CAAqB,MAArB;AACA,WAAKlH,iBAAL,CAAuBmH,IAAvB;AACH;;AACD,QAAI,KAAKtJ,QAAT,EAAmB;AACfsC,MAAAA,MAAM,CAACkE,YAAP,GAAsB+C,eAAtB;AACA,WAAKvJ,QAAL,GAAgB,KAAhB;AACH;AACJ,GAVD;AAWA;AACJ;AACA;AACA;;;AACIH,EAAAA,SAAS,CAACK,SAAV,CAAoBsJ,aAApB,GAAoC,YAAY;AAC5C,WAAO,WAAP;AACH,GAFD;AAGA;AACJ;AACA;AACA;AACA;;;AACI3J,EAAAA,SAAS,CAACK,SAAV,CAAoBuJ,OAApB,GAA8B,YAAY;AACtC,SAAK3I,mBAAL;;AACA,QAAI,KAAKqB,iBAAT,EAA4B;AACxB9C,MAAAA,MAAM,CAAC,KAAK8C,iBAAN,CAAN;AACH;AACJ,GALD;;AAMAtC,EAAAA,SAAS,CAACK,SAAV,CAAoB4H,iBAApB,GAAwC,YAAY;AAChD,QAAI4B,OAAO,GAAG,KAAK5J,MAAnB;AACA,QAAI+H,GAAG,GAAG;AAAEE,MAAAA,MAAM,EAAE;AAAV,KAAV;;AACA,QAAI2B,OAAO,CAACzH,iBAAR,CAA0BD,IAA1B,KAAmC,MAAvC,EAA+C;AAC3C,UAAI2H,aAAa,GAAGD,OAAO,CAAC5G,yBAAR,EAApB;AACA,UAAI8G,GAAG,GAAG,KAAK,CAAf;AACA,UAAIC,KAAK,GAAG,KAAK,CAAjB;AACA,UAAI1B,UAAU,GAAG,EAAjB;AACA,UAAIhB,CAAC,GAAG,KAAK,CAAb;;AACA,WAAKA,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGwC,aAAa,CAACvF,MAA9B,EAAsC+C,CAAC,EAAvC,EAA2C;AACvC,YAAIwC,aAAa,CAACxC,CAAD,CAAb,CAAiBnE,WAAjB,CAA6BoB,MAAjC,EAAyC;AACrC+D,UAAAA,UAAU,CAACR,IAAX,CAAgBgC,aAAa,CAACxC,CAAD,CAAb,CAAiBpE,QAAjC;AACH;;AACD,YAAI4G,aAAa,CAACxC,CAAD,CAAb,CAAiBnE,WAAjB,CAA6BoB,MAAjC,EAAyC;AACrC,cAAI,CAACwF,GAAL,EAAU;AACNA,YAAAA,GAAG,GAAGE,IAAI,CAACC,SAAL,CAAeJ,aAAa,CAACxC,CAAD,CAAb,CAAiBnE,WAAjB,CAA6B+D,IAA7B,EAAf,CAAN;AACH;;AACD,cAAI6C,GAAG,KAAKE,IAAI,CAACC,SAAL,CAAeJ,aAAa,CAACxC,CAAD,CAAb,CAAiBnE,WAAjB,CAA6B+D,IAA7B,EAAf,CAAZ,EAAiE;AAC7D;AACH;AACJ;AACJ;;AACDoB,MAAAA,UAAU,CAACpB,IAAX,CAAgB,UAAUC,CAAV,EAAaC,CAAb,EAAgB;AAAE,eAAOD,CAAC,GAAGC,CAAX;AAAe,OAAjD;;AACA,UAAIE,CAAC,KAAKwC,aAAa,CAACvF,MAApB,IAA8B+D,UAAU,CAACA,UAAU,CAAC/D,MAAX,GAAoB,CAArB,CAAV,GAAoC+D,UAAU,CAAC,CAAD,CAA9C,KAAsDA,UAAU,CAAC/D,MAAX,GAAoB,CAA5G,EAA+G;AAC3GyD,QAAAA,GAAG,GAAG;AAAEE,UAAAA,MAAM,EAAE,IAAV;AAAgBI,UAAAA,UAAU,EAAEA,UAA5B;AAAwCF,UAAAA,UAAU,EAAE0B,aAAa,CAAC,CAAD,CAAb,CAAiB3G;AAArE,SAAN;AACH;AACJ;;AACD,WAAO6E,GAAP;AACH,GA5BD;;AA6BA,SAAOhI,SAAP;AACH,CAzV8B,EAA/B;;AA0VA,SAASA,SAAT","sourcesContent":["import { Browser, remove, EventHandler, isUndefined, closest, classList, isBlazor } from '@syncfusion/ej2-base';\nimport { parentsUntil } from '../base/util';\nimport * as events from '../base/constant';\n/**\n * The `Clipboard` module is used to handle clipboard copy action.\n */\nvar Clipboard = /** @class */ (function () {\n    /**\n     * Constructor for the Grid clipboard module\n     * @hidden\n     */\n    function Clipboard(parent) {\n        this.copyContent = '';\n        this.isSelect = false;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * @hidden\n     */\n    Clipboard.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.on(events.contentReady, this.initialEnd, this);\n        this.parent.on(events.keyPressed, this.keyDownHandler, this);\n        this.parent.on(events.click, this.clickHandler, this);\n        EventHandler.add(this.parent.element, 'keydown', this.pasteHandler, this);\n    };\n    /**\n     * @hidden\n     */\n    Clipboard.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off(events.keyPressed, this.keyDownHandler);\n        this.parent.off(events.contentReady, this.initialEnd);\n        this.parent.off(events.click, this.clickHandler);\n        EventHandler.remove(this.parent.element, 'keydown', this.pasteHandler);\n    };\n    Clipboard.prototype.clickHandler = function (e) {\n        var target = e.target;\n        target = parentsUntil(target, 'e-rowcell');\n    };\n    Clipboard.prototype.pasteHandler = function (e) {\n        var _this = this;\n        var grid = this.parent;\n        var isMacLike = /(Mac)/i.test(navigator.platform);\n        if (e.keyCode === 86 && (e.ctrlKey || (isMacLike && e.metaKey)) && !grid.isEdit) {\n            var target = closest(document.activeElement, '.e-rowcell');\n            if (!target || !grid.editSettings.allowEditing || grid.editSettings.mode !== 'Batch' ||\n                grid.selectionSettings.mode !== 'Cell' || grid.selectionSettings.cellSelectionMode === 'Flow') {\n                return;\n            }\n            this.activeElement = document.activeElement;\n            this.clipBoardTextArea.value = '';\n            var x_1 = window.scrollX;\n            var y_1 = window.scrollY;\n            this.clipBoardTextArea.focus();\n            setTimeout(function () {\n                _this.activeElement.focus();\n                window.scrollTo(x_1, y_1);\n                _this.paste(_this.clipBoardTextArea.value, _this.parent.getSelectedRowCellIndexes()[0].rowIndex, _this.parent.getSelectedRowCellIndexes()[0].cellIndexes[0]);\n            }, 10);\n        }\n    };\n    /**\n     * Paste data from clipboard to selected cells.\n     * @param {boolean} data - Specifies the date for paste.\n     * @param {boolean} rowIndex - Specifies the row index.\n     * @param {boolean} colIndex - Specifies the column index.\n     */\n    Clipboard.prototype.paste = function (data, rowIndex, colIndex) {\n        var grid = this.parent;\n        var cIdx = colIndex;\n        var rIdx = rowIndex;\n        var col;\n        var value;\n        var isAvail;\n        if (!grid.editSettings.allowEditing || grid.editSettings.mode !== 'Batch' ||\n            grid.selectionSettings.mode !== 'Cell' || grid.selectionSettings.cellSelectionMode === 'Flow') {\n            return;\n        }\n        var rows = data.split('\\n');\n        var cols;\n        var dataRows = grid.getDataRows();\n        var mRows;\n        var frRows;\n        var isFrozen = this.parent.isFrozenGrid();\n        if (isFrozen) {\n            mRows = grid.getMovableDataRows();\n            if (grid.getFrozenRightColumnsCount()) {\n                frRows = grid.getFrozenRightDataRows();\n            }\n        }\n        for (var r = 0; r < rows.length; r++) {\n            cols = rows[r].split('\\t');\n            cIdx = colIndex;\n            if ((r === rows.length - 1 && rows[r] === '') || isUndefined(grid.getRowByIndex(rIdx))) {\n                cIdx++;\n                break;\n            }\n            for (var c = 0; c < cols.length; c++) {\n                isAvail = grid.getCellFromIndex(rIdx, cIdx);\n                if (isFrozen) {\n                    var fTr = dataRows[rIdx];\n                    var mTr = mRows[rIdx];\n                    isAvail = !fTr.querySelector('[aria-colindex=\"' + cIdx + '\"]') ?\n                        mTr.querySelector('[aria-colindex=\"' + cIdx + '\"]') : true;\n                    if (frRows && !isAvail) {\n                        var frTr = frRows[rIdx];\n                        isAvail = frTr.querySelector('[aria-colindex=\"' + cIdx + '\"]');\n                    }\n                }\n                if (!isAvail) {\n                    cIdx++;\n                    break;\n                }\n                col = grid.getColumnByIndex(cIdx);\n                value = col.getParser() ? col.getParser()(cols[c]) : cols[c];\n                if (col.allowEditing && !col.isPrimaryKey && !col.template) {\n                    var args = {\n                        column: col,\n                        data: value,\n                        rowIndex: rIdx\n                    };\n                    this.parent.trigger(events.beforePaste, args);\n                    rIdx = args.rowIndex;\n                    if (!args.cancel) {\n                        if (grid.editModule) {\n                            if (col.type === 'number') {\n                                this.parent.editModule.updateCell(rIdx, col.field, parseFloat(args.data));\n                            }\n                            else {\n                                grid.editModule.updateCell(rIdx, col.field, args.data);\n                            }\n                        }\n                    }\n                }\n                cIdx++;\n            }\n            rIdx++;\n        }\n        grid.selectionModule.selectCellsByRange({ rowIndex: rowIndex, cellIndex: colIndex }, { rowIndex: rIdx - 1, cellIndex: cIdx - 1 });\n        var cell = this.parent.getCellFromIndex(rIdx - 1, cIdx - 1);\n        if (cell) {\n            classList(cell, ['e-focus', 'e-focused'], []);\n        }\n    };\n    Clipboard.prototype.initialEnd = function () {\n        this.parent.off(events.contentReady, this.initialEnd);\n        this.clipBoardTextArea = this.parent.createElement('textarea', {\n            className: 'e-clipboard',\n            styles: 'opacity: 0',\n            attrs: { tabindex: '-1', 'aria-label': 'clipboard' }\n        });\n        this.parent.element.appendChild(this.clipBoardTextArea);\n    };\n    Clipboard.prototype.keyDownHandler = function (e) {\n        if (e.action === 'ctrlPlusC') {\n            this.copy();\n        }\n        else if (e.action === 'ctrlShiftPlusH') {\n            this.copy(true);\n        }\n    };\n    Clipboard.prototype.setCopyData = function (withHeader) {\n        if (window.getSelection().toString() === '') {\n            var isFrozen = this.parent.isFrozenGrid();\n            this.clipBoardTextArea.value = this.copyContent = '';\n            var mRows = void 0;\n            var frRows = void 0;\n            var rows = this.parent.getRows();\n            if (isFrozen) {\n                mRows = this.parent.getMovableDataRows();\n                if (this.parent.getFrozenMode() === 'Left-Right') {\n                    frRows = this.parent.getFrozenRightRows();\n                }\n            }\n            if (this.parent.selectionSettings.mode !== 'Cell') {\n                var selectedIndexes = this.parent.getSelectedRowIndexes().sort(function (a, b) { return a - b; });\n                if (withHeader) {\n                    var headerTextArray = [];\n                    for (var i = 0; i < this.parent.getVisibleColumns().length; i++) {\n                        headerTextArray[i] = this.parent.getVisibleColumns()[i].headerText;\n                    }\n                    this.getCopyData(headerTextArray, false, '\\t', withHeader);\n                    this.copyContent += '\\n';\n                }\n                for (var i = 0; i < selectedIndexes.length; i++) {\n                    if (i > 0) {\n                        this.copyContent += '\\n';\n                    }\n                    var cells = [].slice.call(rows[selectedIndexes[i]].querySelectorAll('.e-rowcell'));\n                    if (isFrozen) {\n                        cells.push.apply(cells, [].slice.call(mRows[selectedIndexes[i]].querySelectorAll('.e-rowcell')));\n                        if (frRows) {\n                            cells.push.apply(cells, [].slice.call(frRows[selectedIndexes[i]].querySelectorAll('.e-rowcell')));\n                        }\n                    }\n                    this.getCopyData(cells, false, '\\t', withHeader);\n                }\n            }\n            else {\n                var obj = this.checkBoxSelection();\n                if (obj.status) {\n                    if (withHeader) {\n                        var headers = [];\n                        for (var i = 0; i < obj.colIndexes.length; i++) {\n                            headers.push(this.parent.getColumnHeaderByIndex(obj.colIndexes[i]));\n                        }\n                        this.getCopyData(headers, false, '\\t', withHeader);\n                        this.copyContent += '\\n';\n                    }\n                    for (var i = 0; i < obj.rowIndexes.length; i++) {\n                        if (i > 0) {\n                            this.copyContent += '\\n';\n                        }\n                        var cells = [].slice.call(rows[obj.rowIndexes[i]].\n                            querySelectorAll('.e-cellselectionbackground'));\n                        if (isFrozen) {\n                            cells.push.apply(cells, [].slice.call(mRows[obj.rowIndexes[i]]\n                                .querySelectorAll('.e-cellselectionbackground')));\n                            if (frRows) {\n                                cells.push.apply(cells, [].slice.call(frRows[obj.rowIndexes[i]]\n                                    .querySelectorAll('.e-cellselectionbackground')));\n                            }\n                        }\n                        this.getCopyData(cells, false, '\\t', withHeader);\n                    }\n                }\n                else {\n                    this.getCopyData([].slice.call(this.parent.element.querySelectorAll('.e-cellselectionbackground')), true, '\\n', withHeader);\n                }\n            }\n            var args = {\n                data: this.copyContent,\n                cancel: false,\n            };\n            this.parent.trigger(events.beforeCopy, args);\n            if (args.cancel) {\n                return;\n            }\n            this.clipBoardTextArea.value = this.copyContent = args.data;\n            if (!Browser.userAgent.match(/ipad|ipod|iphone/i)) {\n                this.clipBoardTextArea.select();\n            }\n            else {\n                this.clipBoardTextArea.setSelectionRange(0, this.clipBoardTextArea.value.length);\n            }\n            this.isSelect = true;\n        }\n    };\n    Clipboard.prototype.getCopyData = function (cells, isCell, splitKey, withHeader) {\n        var isElement = typeof cells[0] !== 'string';\n        for (var j = 0; j < cells.length; j++) {\n            if (withHeader && isCell) {\n                this.copyContent += this.parent.getColumns()[parseInt(cells[j].getAttribute('aria-colindex'), 10)].headerText + '\\n';\n            }\n            if (isElement) {\n                if (!cells[j].classList.contains('e-hide')) {\n                    if (isBlazor()) {\n                        if ((!cells[j].classList.contains('e-gridchkbox')) &&\n                            Object.keys(cells[j].querySelectorAll('.e-check')).length) {\n                            this.copyContent += true;\n                        }\n                        else if ((!cells[j].classList.contains('e-gridchkbox')) &&\n                            Object.keys(cells[j].querySelectorAll('.e-uncheck')).length) {\n                            this.copyContent += false;\n                        }\n                        else {\n                            this.copyContent += cells[j].innerText;\n                        }\n                    }\n                    else {\n                        this.copyContent += cells[j].innerText;\n                    }\n                }\n            }\n            else {\n                this.copyContent += cells[j];\n            }\n            if (j < cells.length - 1) {\n                this.copyContent += splitKey;\n            }\n        }\n    };\n    /**\n     * Copy selected rows or cells data into clipboard.\n     * @param {boolean} withHeader - Specifies whether the column header data need to be copied or not.\n     */\n    Clipboard.prototype.copy = function (withHeader) {\n        if (document.queryCommandSupported('copy')) {\n            this.setCopyData(withHeader);\n            document.execCommand('copy');\n            this.clipBoardTextArea.blur();\n        }\n        if (this.isSelect) {\n            window.getSelection().removeAllRanges();\n            this.isSelect = false;\n        }\n    };\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    Clipboard.prototype.getModuleName = function () {\n        return 'clipboard';\n    };\n    /**\n     * To destroy the clipboard\n     * @return {void}\n     * @hidden\n     */\n    Clipboard.prototype.destroy = function () {\n        this.removeEventListener();\n        if (this.clipBoardTextArea) {\n            remove(this.clipBoardTextArea);\n        }\n    };\n    Clipboard.prototype.checkBoxSelection = function () {\n        var gridObj = this.parent;\n        var obj = { status: false };\n        if (gridObj.selectionSettings.mode === 'Cell') {\n            var rowCellIndxes = gridObj.getSelectedRowCellIndexes();\n            var str = void 0;\n            var isBox = void 0;\n            var rowIndexes = [];\n            var i = void 0;\n            for (i = 0; i < rowCellIndxes.length; i++) {\n                if (rowCellIndxes[i].cellIndexes.length) {\n                    rowIndexes.push(rowCellIndxes[i].rowIndex);\n                }\n                if (rowCellIndxes[i].cellIndexes.length) {\n                    if (!str) {\n                        str = JSON.stringify(rowCellIndxes[i].cellIndexes.sort());\n                    }\n                    if (str !== JSON.stringify(rowCellIndxes[i].cellIndexes.sort())) {\n                        break;\n                    }\n                }\n            }\n            rowIndexes.sort(function (a, b) { return a - b; });\n            if (i === rowCellIndxes.length && rowIndexes[rowIndexes.length - 1] - rowIndexes[0] === rowIndexes.length - 1) {\n                obj = { status: true, rowIndexes: rowIndexes, colIndexes: rowCellIndxes[0].cellIndexes };\n            }\n        }\n        return obj;\n    };\n    return Clipboard;\n}());\nexport { Clipboard };\n"]},"metadata":{},"sourceType":"module"}