{"ast":null,"code":"import { isNullOrUndefined, extend } from '@syncfusion/ej2-base';\nimport { setStyleAttribute, closest as getClosest, remove, isBlazor } from '@syncfusion/ej2-base';\nimport { classList } from '@syncfusion/ej2-base';\nimport { CellType } from '../base/enum';\nimport { RowRenderer } from './row-renderer';\nimport { Cell } from '../models/cell';\nimport { Row } from '../models/row';\nimport * as events from '../base/constant';\nimport { Draggable, Droppable } from '@syncfusion/ej2-base';\nimport { parentsUntil, wrap, measureColumnDepth, appendChildren, getFrozenTableName } from '../base/util';\n/**\n * Content module is used to render grid content\n * @hidden\n */\n\nvar HeaderRender =\n/** @class */\nfunction () {\n  /**\n   * Constructor for header renderer module\n   */\n  function HeaderRender(parent, serviceLocator) {\n    var _this = this;\n\n    this.frzIdx = 0;\n    this.notfrzIdx = 0;\n    this.isFirstCol = false;\n    this.isReplaceDragEle = true;\n\n    this.helper = function (e) {\n      var gObj = _this.parent;\n      var target = _this.draggable.currentStateTarget;\n      var parentEle = parentsUntil(target, 'e-headercell');\n\n      if (!(gObj.allowReordering || gObj.allowGrouping) || !isNullOrUndefined(parentEle) && parentEle.querySelectorAll('.e-checkselectall').length > 0) {\n        return false;\n      }\n\n      var visualElement = _this.parent.createElement('div', {\n        className: 'e-cloneproperties e-dragclone e-headerclone'\n      });\n\n      var element = target.classList.contains('e-headercell') ? target : parentEle;\n\n      if (!element || !gObj.allowReordering && element.classList.contains('e-stackedheadercell')) {\n        return false;\n      }\n\n      var height = element.offsetHeight;\n      var headercelldiv = element.querySelector('.e-headercelldiv') || element.querySelector('.e-stackedheadercelldiv');\n      var col;\n\n      if (headercelldiv) {\n        if (element.querySelector('.e-stackedheadercelldiv')) {\n          col = gObj.getStackedHeaderColumnByHeaderText(headercelldiv.innerText.trim(), gObj.columns);\n        } else {\n          col = gObj.getColumnByUid(headercelldiv.getAttribute('e-mappinguid'));\n        }\n\n        _this.column = col;\n\n        if (_this.column.lockColumn) {\n          return false;\n        }\n\n        visualElement.setAttribute('e-mappinguid', _this.column.uid);\n      }\n\n      if (col && !isNullOrUndefined(col.headerTemplate)) {\n        if (!isNullOrUndefined(col.headerTemplate)) {\n          var result = void 0;\n          var colIndex = gObj.getColumnIndexByField(col.field);\n          result = col.getHeaderTemplate()(extend({\n            'index': colIndex\n          }, col), gObj, 'headerTemplate');\n          appendChildren(visualElement, result);\n        } else {\n          visualElement.innerHTML = col.headerTemplate;\n        }\n      } else {\n        visualElement.innerHTML = headercelldiv ? col.headerText : element.firstElementChild.innerHTML;\n      }\n\n      visualElement.style.width = element.offsetWidth + 'px';\n      visualElement.style.height = element.offsetHeight + 'px';\n      visualElement.style.lineHeight = (height - 6).toString() + 'px';\n      gObj.element.appendChild(visualElement);\n      return visualElement;\n    };\n\n    this.dragStart = function (e) {\n      var gObj = _this.parent;\n      gObj.element.querySelector('.e-gridpopup').style.display = 'none';\n      gObj.notify(events.columnDragStart, {\n        target: _this.draggable.currentStateTarget,\n        column: _this.column,\n        event: e.event\n      });\n\n      if (isBlazor()) {\n        e.bindEvents(e.dragElement);\n      }\n    };\n\n    this.drag = function (e) {\n      var gObj = _this.parent;\n      var target = e.target;\n\n      if (target) {\n        var closest = getClosest(target, '.e-grid');\n\n        var cloneElement = _this.parent.element.querySelector('.e-cloneproperties');\n\n        if (!closest || closest.getAttribute('id') !== gObj.element.getAttribute('id')) {\n          classList(cloneElement, ['e-notallowedcur'], ['e-defaultcur']);\n\n          if (gObj.allowReordering) {\n            gObj.element.querySelector('.e-reorderuparrow').style.display = 'none';\n            gObj.element.querySelector('.e-reorderdownarrow').style.display = 'none';\n          }\n\n          if (!gObj.groupSettings.allowReordering) {\n            return;\n          }\n        }\n\n        gObj.notify(events.columnDrag, {\n          target: e.target,\n          column: _this.column,\n          event: e.event\n        });\n      }\n    };\n\n    this.dragStop = function (e) {\n      var gObj = _this.parent;\n      var cancel;\n      gObj.element.querySelector('.e-gridpopup').style.display = 'none';\n\n      if (!parentsUntil(e.target, 'e-headercell') && !parentsUntil(e.target, 'e-groupdroparea') || !gObj.allowReordering && parentsUntil(e.target, 'e-headercell') || !e.helper.getAttribute('e-mappinguid') && parentsUntil(e.target, 'e-groupdroparea')) {\n        remove(e.helper);\n        cancel = true;\n      }\n\n      gObj.notify(events.columnDragStop, {\n        target: e.target,\n        event: e.event,\n        column: _this.column,\n        cancel: cancel\n      });\n    };\n\n    this.drop = function (e) {\n      var gObj = _this.parent;\n      var uid = e.droppedElement.getAttribute('e-mappinguid');\n      var closest = getClosest(e.target, '.e-grid');\n      remove(e.droppedElement);\n\n      if (closest && closest.getAttribute('id') !== gObj.element.getAttribute('id') || !(gObj.allowReordering || gObj.allowGrouping)) {\n        return;\n      }\n\n      gObj.notify(events.headerDrop, {\n        target: e.target,\n        uid: uid,\n        droppedElement: e.droppedElement\n      });\n    };\n\n    this.parent = parent;\n    this.serviceLocator = serviceLocator;\n    this.ariaService = this.serviceLocator.getService('ariaService');\n    this.widthService = this.serviceLocator.getService('widthService');\n\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    if (!this.parent.enableColumnVirtualization && !this.parent.getFrozenLeftColumnsCount() && !this.parent.getFrozenRightColumnsCount()) {\n      this.parent.on(events.columnVisibilityChanged, this.setVisible, this);\n    }\n\n    this.parent.on(events.columnPositionChanged, this.colPosRefresh, this);\n  }\n  /**\n   * The function is used to render grid header div\n   */\n\n\n  HeaderRender.prototype.renderPanel = function () {\n    var div = this.parent.element.querySelector('.e-gridheader');\n    var isRendered = div != null;\n    div = isRendered ? div : this.parent.createElement('div', {\n      className: 'e-gridheader'\n    });\n    var innerDiv = isRendered ? div.querySelector('.e-headercontent') : this.parent.createElement('div', {\n      className: 'e-headercontent'\n    });\n    this.toggleStackClass(div);\n    div.appendChild(innerDiv);\n    this.setPanel(div);\n\n    if (!isRendered) {\n      this.parent.element.appendChild(div);\n    }\n  };\n  /**\n   * The function is used to render grid header table\n   */\n\n\n  HeaderRender.prototype.renderTable = function () {\n    var headerDiv = this.getPanel();\n    headerDiv.appendChild(this.createHeaderTable());\n    this.setTable(headerDiv.querySelector('.e-table'));\n\n    if (!this.parent.getFrozenColumns() && !this.parent.getFrozenRightColumnsCount() && !this.parent.getFrozenLeftColumnsCount()) {\n      this.initializeHeaderDrag();\n      this.initializeHeaderDrop();\n    }\n\n    this.parent.notify(events.headerRefreshed, {\n      rows: this.rows,\n      args: {\n        isFrozen: this.parent.isFrozenGrid()\n      }\n    });\n  };\n  /**\n   * Get the header content div element of grid\n   * @return {Element}\n   */\n\n\n  HeaderRender.prototype.getPanel = function () {\n    return this.headerPanel;\n  };\n  /**\n   * Set the header content div element of grid\n   * @param  {Element} panel\n   */\n\n\n  HeaderRender.prototype.setPanel = function (panel) {\n    this.headerPanel = panel;\n  };\n  /**\n   * Get the header table element of grid\n   * @return {Element}\n   */\n\n\n  HeaderRender.prototype.getTable = function () {\n    return this.headerTable;\n  };\n  /**\n   * Set the header table element of grid\n   * @param  {Element} table\n   */\n\n\n  HeaderRender.prototype.setTable = function (table) {\n    this.headerTable = table;\n  };\n  /**\n   * Get the header colgroup element\n   * @returns {Element}\n   */\n\n\n  HeaderRender.prototype.getColGroup = function () {\n    return this.colgroup;\n  };\n  /**\n   * Set the header colgroup element\n   * @param {Element} colgroup\n   * @returns {Element}\n   */\n\n\n  HeaderRender.prototype.setColGroup = function (colGroup) {\n    return this.colgroup = colGroup;\n  };\n  /**\n   * Get the header row element collection.\n   * @return {Element[]}\n   */\n\n\n  HeaderRender.prototype.getRows = function () {\n    var table = this.getTable();\n    return table.tHead.rows;\n  };\n  /**\n   * The function is used to create header table elements\n   * @return {Element}\n   * @hidden\n   */\n\n\n  HeaderRender.prototype.createHeaderTable = function () {\n    var skipDom = isBlazor() && this.parent.frozenRows !== 0;\n    var table = this.createTable();\n    var innerDiv = this.getPanel().querySelector('.e-headercontent');\n\n    if (!skipDom) {\n      innerDiv.appendChild(table);\n    }\n\n    return innerDiv;\n  };\n  /**\n   * @hidden\n   */\n\n\n  HeaderRender.prototype.createTable = function (tableEle) {\n    if (tableEle === void 0) {\n      tableEle = null;\n    }\n\n    var skipDom = isBlazor() && this.parent.frozenRows !== 0;\n    var gObj = this.parent;\n    var isFrozen = gObj.isFrozenGrid();\n\n    if (!(isBlazor() && !gObj.isJsComponent) && this.getTable() && !isFrozen) {\n      remove(this.getTable());\n    }\n\n    var columns = gObj.getColumns();\n    var innerDiv = this.getPanel().querySelector('.e-headercontent');\n    var table = skipDom ? tableEle || innerDiv.querySelector('.e-table') : this.parent.createElement('table', {\n      className: 'e-table',\n      attrs: {\n        cellspacing: '0.25px',\n        role: 'grid'\n      }\n    });\n    var findHeaderRow = this.createHeaderContent();\n    var thead = findHeaderRow.thead;\n    var tbody = this.parent.createElement('tbody', {\n      className: this.parent.frozenRows ? '' : 'e-hide'\n    });\n    this.caption = this.parent.createElement('caption', {\n      innerHTML: this.parent.element.id + '_header_table',\n      className: 'e-hide'\n    });\n    var colGroup = this.parent.createElement('colgroup');\n    var rowBody = this.parent.createElement('tr');\n    var bodyCell;\n    var rows = this.rows = findHeaderRow.rows;\n    var rowRenderer = new RowRenderer(this.serviceLocator, CellType.Header, this.parent);\n\n    for (var i = 0, len = rows.length; i < len; i++) {\n      for (var j = 0, len_1 = rows[i].cells.length; j < len_1; j++) {\n        var cell = rows[i].cells[j];\n        bodyCell = this.parent.createElement('td');\n        rowBody.appendChild(bodyCell);\n      }\n    }\n\n    if (gObj.allowFiltering || gObj.allowSorting || gObj.allowGrouping) {\n      table.classList.add('e-sortfilter');\n    }\n\n    this.updateColGroup(colGroup);\n\n    if (!skipDom) {\n      tbody.appendChild(rowBody);\n    }\n\n    table.appendChild(this.setColGroup(colGroup));\n    table.appendChild(thead);\n\n    if (!skipDom) {\n      table.appendChild(tbody);\n    }\n\n    table.appendChild(this.caption);\n    this.ariaService.setOptions(table, {\n      colcount: gObj.getColumns().length.toString()\n    });\n    return table;\n  };\n\n  HeaderRender.prototype.createHeaderContent = function () {\n    var gObj = this.parent;\n    var frozenMode = gObj.getFrozenMode();\n    var columns = gObj.getColumns();\n    var thead = this.parent.createElement('thead');\n    var colHeader = this.parent.createElement('tr', {\n      className: 'e-columnheader'\n    });\n    var rowRenderer = new RowRenderer(this.serviceLocator, CellType.Header, gObj);\n    rowRenderer.element = colHeader;\n    var rows = [];\n    var headerRow;\n    this.colDepth = measureColumnDepth(gObj.columns);\n\n    for (var i = 0, len = this.colDepth; i < len; i++) {\n      rows[i] = this.generateRow(i);\n      rows[i].cells = [];\n    }\n\n    if (frozenMode !== 'Right') {\n      rows = this.ensureColumns(rows);\n    }\n\n    rows = this.getHeaderCells(rows);\n\n    if (frozenMode === 'Right') {\n      rows = this.ensureColumns(rows);\n    }\n\n    var frzCols = this.parent.getFrozenColumns();\n\n    if (this.parent.isRowDragable() && this.parent.isFrozenGrid() && rows[0].cells[1]) {\n      var colFreezeMode = rows[0].cells[1].column.getFreezeTableName();\n\n      if (colFreezeMode === 'movable' || frozenMode === 'Left-Right' && colFreezeMode === 'frozen-right') {\n        if (frozenMode === 'Right') {\n          rows[0].cells.pop();\n        } else {\n          rows[0].cells.shift();\n        }\n      } else if (!frzCols && colFreezeMode === 'frozen-left') {\n        rows[0].cells[0].column.freeze = colFreezeMode === 'frozen-left' ? 'Left' : 'Right';\n      } else if (frozenMode === 'Right' && colFreezeMode === 'frozen-right') {\n        rows[0].cells[rows[0].cells.length - 1].column.freeze = 'Right';\n      }\n    }\n\n    for (var i = 0, len = this.colDepth; i < len; i++) {\n      headerRow = rowRenderer.render(rows[i], columns);\n\n      if (this.parent.rowHeight && headerRow.querySelector('.e-headercell')) {\n        headerRow.style.height = this.parent.rowHeight + 'px';\n      }\n\n      thead.appendChild(headerRow);\n    }\n\n    var findHeaderRow = {\n      thead: thead,\n      rows: rows\n    };\n    return findHeaderRow;\n  };\n\n  HeaderRender.prototype.updateColGroup = function (colGroup) {\n    var cols = this.parent.getColumns();\n    var col;\n    var indexes = this.parent.getColumnIndexesInView();\n\n    if (this.parent.enableColumnVirtualization && this.parent.getFrozenColumns() && this.parent.contentModule.isXaxis()) {\n      cols = extend([], this.parent.getColumns());\n      cols.splice(0, this.parent.getFrozenColumns());\n    }\n\n    colGroup.id = this.parent.element.id + 'colGroup';\n\n    if (this.parent.allowGrouping) {\n      for (var i = 0, len = this.parent.groupSettings.columns.length; i < len; i++) {\n        if (this.parent.enableColumnVirtualization && indexes.indexOf(i) === -1) {\n          continue;\n        }\n\n        col = this.parent.createElement('col', {\n          className: 'e-group-intent'\n        });\n        colGroup.appendChild(col);\n      }\n    }\n\n    if (this.parent.detailTemplate || this.parent.childGrid) {\n      col = this.parent.createElement('col', {\n        className: 'e-detail-intent'\n      });\n      colGroup.appendChild(col);\n    }\n\n    if (this.parent.isRowDragable() && this.parent.getFrozenMode() !== 'Right') {\n      col = this.parent.createElement('col', {\n        className: 'e-drag-intent'\n      });\n      colGroup.appendChild(col);\n    }\n\n    for (var i = 0, len = cols.length; i < len; i++) {\n      col = this.parent.createElement('col');\n\n      if (cols[i].visible === false) {\n        setStyleAttribute(col, {\n          'display': 'none'\n        });\n      }\n\n      colGroup.appendChild(col);\n    }\n\n    if (this.parent.isRowDragable() && this.parent.getFrozenMode() === 'Right') {\n      col = this.parent.createElement('col', {\n        className: 'e-drag-intent'\n      });\n      colGroup.appendChild(col);\n    }\n\n    return colGroup;\n  };\n\n  HeaderRender.prototype.ensureColumns = function (rows) {\n    //TODO: generate dummy column for group, detail, stacked row here; ensureColumns here\n    var gObj = this.parent;\n    var indexes = this.parent.getColumnIndexesInView();\n\n    for (var i = 0, len = rows.length; i < len; i++) {\n      if (gObj.allowGrouping) {\n        for (var c = 0, len_2 = gObj.groupSettings.columns.length; c < len_2; c++) {\n          if (this.parent.enableColumnVirtualization && indexes.indexOf(c) === -1) {\n            continue;\n          }\n\n          rows[i].cells.push(this.generateCell({}, CellType.HeaderIndent));\n        }\n      }\n\n      if (gObj.detailTemplate || gObj.childGrid) {\n        var args = {};\n        this.parent.notify(events.detailIndentCellInfo, args);\n        rows[i].cells.push(this.generateCell(args, CellType.DetailHeader));\n      }\n\n      if (gObj.isRowDragable()) {\n        rows[i].cells.push(this.generateCell({}, CellType.RowDragHIcon));\n      }\n    }\n\n    return rows;\n  };\n\n  HeaderRender.prototype.getHeaderCells = function (rows) {\n    var column;\n    var thead = this.parent.getHeaderTable() && this.parent.getHeaderTable().querySelector('thead');\n    var cols = this.parent.enableColumnVirtualization ? this.parent.getColumns(this.parent.enablePersistence) : this.parent.columns;\n    var tableName;\n\n    if (this.parent.enableColumnVirtualization && this.parent.isFrozenGrid() && this.parent.contentModule.isXaxis()) {\n      tableName = 'movable';\n    } else {\n      tableName = getFrozenTableName(this.parent);\n    }\n\n    this.frzIdx = 0;\n    this.notfrzIdx = 0;\n\n    if (this.parent.lockcolPositionCount) {\n      for (var i = 0; i < cols.length; i++) {\n        this.lockColsRendered = false;\n        rows = this.appendCells(cols[i], rows, 0, i === 0, false, i === cols.length - 1, thead, tableName);\n      }\n    }\n\n    for (var i = 0, len = cols.length; i < len; i++) {\n      this.notfrzIdx = 0;\n      this.lockColsRendered = true;\n      rows = this.appendCells(cols[i], rows, 0, i === 0, false, i === len - 1, thead, tableName);\n    }\n\n    return rows;\n  };\n\n  HeaderRender.prototype.appendCells = function (cols, rows, index, isFirstObj, isFirstCol, isLastCol, isMovable, tableName) {\n    var lastCol = isLastCol ? 'e-lastcell' : '';\n    var isFrozen = this.parent.isFrozenGrid();\n    var isLockColumn = !this.parent.lockcolPositionCount || cols.lockColumn && !this.lockColsRendered || !cols.lockColumn && this.lockColsRendered;\n    var isFrozenLockColumn = !this.parent.lockcolPositionCount || cols.lockColumn && !this.lockColsRendered || !cols.lockColumn && this.lockColsRendered;\n    var scrollbar = this.parent.getContent().querySelector('.e-movablescrollbar');\n    var left;\n\n    if (isFrozen && scrollbar && this.parent.enableColumnVirtualization) {\n      left = scrollbar.scrollLeft;\n    }\n\n    if (!cols.columns) {\n      if (left && left > 0 && this.parent.contentModule.isXaxis() && this.parent.inViewIndexes[0] !== 0 && cols.getFreezeTableName() === 'movable') {\n        rows[index].cells.push(this.generateCell(cols, CellType.Header, this.colDepth - index, (isFirstObj ? '' : isFirstCol ? 'e-firstcell' : '') + lastCol, index, this.parent.getColumnIndexByUid(cols.uid)));\n      } else {\n        if (!isFrozen && isLockColumn || isFrozen && cols.getFreezeTableName() === tableName && isFrozenLockColumn) {\n          rows[index].cells.push(this.generateCell(cols, CellType.Header, this.colDepth - index, (isFirstObj ? '' : isFirstCol ? 'e-firstcell' : '') + lastCol, index, this.parent.getColumnIndexByUid(cols.uid)));\n        }\n      }\n\n      if (this.parent.lockcolPositionCount) {\n        if (this.frzIdx + this.notfrzIdx < this.parent.frozenColumns && (cols.lockColumn && !this.lockColsRendered || !cols.lockColumn && this.lockColsRendered)) {\n          this.frzIdx++;\n        } else {\n          this.notfrzIdx++;\n        }\n      } else {\n        this.frzIdx++;\n      }\n    } else {\n      this.isFirstCol = false;\n      var colSpan = this.getCellCnt(cols, 0);\n\n      if (colSpan) {\n        var stackedLockColsCount = this.getStackedLockColsCount(cols, 0);\n        var isStackedLockColumn = this.parent.lockcolPositionCount === 0 || !this.lockColsRendered && stackedLockColsCount !== 0 || this.lockColsRendered && colSpan - stackedLockColsCount !== 0;\n        var isFrozenStack = isFrozen && this.ensureStackedFrozen(cols.columns, tableName, false);\n\n        if (!isFrozen && isStackedLockColumn || isFrozenStack) {\n          rows[index].cells.push(new Cell({\n            cellType: CellType.StackedHeader,\n            column: cols,\n            colSpan: this.getColSpan(colSpan, stackedLockColsCount, cols.columns, tableName, isFrozen)\n          }));\n        }\n      }\n\n      if (this.parent.lockcolPositionCount && !this.lockColsRendered) {\n        for (var i = 0; i < cols.columns.length; i++) {\n          rows = this.appendCells(cols.columns[i], rows, index + 1, isFirstObj, i === 0, i === cols.columns.length - 1 && isLastCol, isMovable, tableName);\n        }\n      }\n\n      if (this.lockColsRendered) {\n        for (var i = 0, len = cols.columns.length; i < len; i++) {\n          var isFirstCol_1 = this.isFirstCol = cols.columns[i].visible && !this.isFirstCol && len !== 1;\n          var isLaststackedCol = i === len - 1;\n          rows = this.appendCells(cols.columns[i], rows, index + 1, isFirstObj, isFirstCol_1, isLaststackedCol && isLastCol, isMovable, tableName);\n        }\n      }\n    }\n\n    return rows;\n  };\n\n  HeaderRender.prototype.ensureStackedFrozen = function (columns, tableName, isTrue) {\n    var length = columns.length;\n\n    for (var i = 0; i < length; i++) {\n      if (columns[i].columns) {\n        isTrue = this.ensureStackedFrozen(columns[i].columns, tableName, isTrue);\n      } else if (columns[i].getFreezeTableName() === tableName) {\n        isTrue = true;\n        break;\n      }\n    }\n\n    return isTrue;\n  };\n\n  HeaderRender.prototype.getStackedLockColsCount = function (col, lockColsCount) {\n    if (col.columns) {\n      for (var i = 0; i < col.columns.length; i++) {\n        lockColsCount = this.getStackedLockColsCount(col.columns[i], lockColsCount);\n      }\n    } else if (col.lockColumn) {\n      lockColsCount++;\n    }\n\n    return lockColsCount;\n  };\n\n  HeaderRender.prototype.getColSpan = function (colSpan, stackedLockColsCount, columns, tableName, isFrozen) {\n    if (isFrozen) {\n      colSpan = this.getFrozenColSpan(columns, tableName, 0);\n    } else if (this.parent.lockcolPositionCount) {\n      colSpan = !this.lockColsRendered ? stackedLockColsCount : colSpan - stackedLockColsCount;\n    }\n\n    return colSpan;\n  };\n\n  HeaderRender.prototype.getFrozenColSpan = function (columns, tableName, count) {\n    var length = columns.length;\n\n    for (var i = 0; i < length; i++) {\n      if (columns[i].columns) {\n        count = this.getFrozenColSpan(columns[i].columns, tableName, count);\n      } else if (columns[i].getFreezeTableName() === tableName) {\n        count++;\n      }\n    }\n\n    return count;\n  };\n\n  HeaderRender.prototype.generateRow = function (index) {\n    return new Row({});\n  };\n\n  HeaderRender.prototype.generateCell = function (column, cellType, rowSpan, className, rowIndex, colIndex) {\n    var opt = {\n      'visible': column.visible,\n      'isDataCell': false,\n      'isTemplate': !isNullOrUndefined(column.headerTemplate),\n      'rowID': '',\n      'column': column,\n      'cellType': cellType,\n      'rowSpan': rowSpan,\n      'className': className,\n      'index': rowIndex,\n      'colIndex': colIndex\n    };\n\n    if (!opt.rowSpan || opt.rowSpan < 2) {\n      delete opt.rowSpan;\n    }\n\n    return new Cell(opt);\n  };\n  /**\n   * Function to hide header table column based on visible property\n   * @param  {Column[]} columns?\n   */\n\n\n  HeaderRender.prototype.setVisible = function (columns) {\n    var gObj = this.parent;\n    var rows = [].slice.call(this.getRows()); //NodeList -> Array        \n\n    var displayVal;\n    var idx;\n    var className;\n    var element;\n    var frzCols = gObj.getFrozenColumns();\n\n    for (var c = 0, clen = columns.length; c < clen; c++) {\n      var column = columns[c];\n      idx = gObj.getNormalizedColumnIndex(column.uid);\n      displayVal = column.visible ? '' : 'none';\n\n      if (frzCols) {\n        var normalizedfrzCols = this.parent.isRowDragable() ? frzCols + 1 : frzCols;\n\n        if (idx < normalizedfrzCols) {\n          if (isBlazor() && gObj.isServerRendered) {\n            setStyleAttribute(this.getTable().querySelector('colgroup').children[idx], {\n              'display': displayVal\n            });\n            setStyleAttribute(this.getTable().querySelectorAll('th')[idx], {\n              'display': displayVal\n            });\n          } else {\n            setStyleAttribute(this.getColGroup().children[idx], {\n              'display': displayVal\n            });\n          }\n        } else {\n          var mTblColGrp = gObj.getHeaderContent().querySelector('.e-movableheader').querySelector('colgroup');\n          var mTbl = gObj.getHeaderContent().querySelector('.e-movableheader').querySelector('table');\n          setStyleAttribute(mTblColGrp.children[idx - normalizedfrzCols], {\n            'display': displayVal\n          });\n\n          if (isBlazor() && gObj.isServerRendered) {\n            setStyleAttribute(mTbl.querySelectorAll('th')[idx - frzCols], {\n              'display': displayVal\n            });\n          }\n        }\n      } else {\n        setStyleAttribute(this.getColGroup().children[idx], {\n          'display': displayVal\n        });\n      }\n    }\n\n    this.refreshUI();\n  };\n\n  HeaderRender.prototype.colPosRefresh = function () {\n    if (isBlazor() && this.parent.isServerRendered && this.parent.frozenRows && this.parent.getFrozenColumns()) {\n      this.freezeReorder = true;\n    }\n\n    this.refreshUI();\n  };\n  /**\n   * Refresh the header of the Grid.\n   * @returns {void}\n   */\n\n\n  HeaderRender.prototype.refreshUI = function () {\n    var frzCols = this.parent.isFrozenGrid();\n    var isVFTable = this.parent.enableColumnVirtualization && frzCols;\n    var setFrozenTable = isBlazor() && this.parent.isServerRendered && this.parent.frozenRows !== 0 && frzCols;\n    var headerDiv = this.getPanel();\n    this.toggleStackClass(headerDiv);\n    var table = this.freezeReorder ? this.headerPanel.querySelector('.e-movableheader').querySelector('.e-table') : this.getTable();\n\n    if (isVFTable) {\n      table = this.parent.contentModule.getVirtualFreezeHeader();\n    }\n\n    if (setFrozenTable && !isVFTable) {\n      table = this.freezeReorder ? this.headerPanel.querySelector('.e-movableheader').querySelector('.e-table') : this.headerPanel.querySelector('.e-frozenheader').querySelector('.e-table');\n    }\n\n    if (table) {\n      if (isBlazor() && this.parent.isServerRendered) {\n        table.removeChild(table.querySelector('colgroup'));\n        table.removeChild(table.querySelector('thead'));\n      } else {\n        remove(table);\n        table.removeChild(table.firstChild);\n        table.removeChild(table.childNodes[0]);\n      }\n\n      var colGroup = this.parent.createElement('colgroup');\n      var findHeaderRow = this.createHeaderContent();\n      this.rows = findHeaderRow.rows;\n      table.insertBefore(findHeaderRow.thead, table.firstChild);\n      this.updateColGroup(colGroup);\n      table.insertBefore(this.setColGroup(colGroup), table.firstChild);\n\n      if (!isVFTable && !setFrozenTable) {\n        this.setTable(table);\n      }\n\n      if (!(isBlazor() && this.parent.isServerRendered)) {\n        this.appendContent(table);\n      }\n\n      this.parent.notify(events.colGroupRefresh, {});\n      this.widthService.setWidthToColumns();\n      this.parent.updateDefaultCursor();\n\n      if (!frzCols || this.parent.enableColumnVirtualization && frzCols) {\n        this.initializeHeaderDrag();\n      }\n\n      var rows = [].slice.call(headerDiv.querySelectorAll('tr.e-columnheader'));\n\n      for (var _i = 0, rows_1 = rows; _i < rows_1.length; _i++) {\n        var row = rows_1[_i];\n        var gCells = [].slice.call(row.querySelectorAll('.e-grouptopleftcell'));\n\n        if (gCells.length) {\n          gCells[gCells.length - 1].classList.add('e-lastgrouptopleftcell');\n        }\n      }\n\n      if (!frzCols) {\n        this.parent.notify(events.headerRefreshed, {\n          rows: this.rows,\n          args: {\n            isFrozen: frzCols\n          }\n        });\n      }\n\n      if (this.parent.enableColumnVirtualization && parentsUntil(table, 'e-movableheader')) {\n        this.parent.notify(events.headerRefreshed, {\n          rows: this.rows,\n          args: {\n            isFrozen: false,\n            isXaxis: true\n          }\n        });\n      }\n\n      if (this.parent.allowTextWrap && this.parent.textWrapSettings.wrapMode === 'Header') {\n        wrap(rows, true);\n      }\n    }\n  };\n\n  HeaderRender.prototype.toggleStackClass = function (div) {\n    var column = this.parent.columns;\n    var stackedHdr = column.some(function (column) {\n      return !isNullOrUndefined(column.columns);\n    });\n\n    if (stackedHdr) {\n      div.classList.add('e-stackedheader');\n    } else {\n      div.classList.remove('e-stackedheader');\n    }\n  };\n\n  HeaderRender.prototype.appendContent = function (table) {\n    this.getPanel().querySelector('.e-headercontent').appendChild(table);\n  };\n\n  HeaderRender.prototype.getCellCnt = function (col, cnt) {\n    if (col.columns) {\n      for (var i = 0, len = col.columns.length; i < len; i++) {\n        cnt = this.getCellCnt(col.columns[i], cnt);\n      }\n    } else {\n      if (col.visible) {\n        cnt++;\n      }\n    }\n\n    return cnt;\n  };\n\n  HeaderRender.prototype.initializeHeaderDrag = function () {\n    var gObj = this.parent;\n\n    if (!(this.parent.allowReordering || this.parent.allowGrouping && this.parent.groupSettings.showDropArea)) {\n      return;\n    }\n\n    this.draggable = new Draggable(gObj.getHeaderContent(), {\n      dragTarget: '.e-headercell',\n      distance: 5,\n      helper: this.helper,\n      dragStart: this.dragStart,\n      drag: this.drag,\n      dragStop: this.dragStop,\n      abort: '.e-rhandler',\n      isReplaceDragEle: this.isReplaceDragEle\n    });\n  };\n\n  HeaderRender.prototype.initializeHeaderDrop = function () {\n    var gObj = this.parent;\n    var drop = new Droppable(gObj.getHeaderContent(), {\n      accept: '.e-dragclone',\n      drop: this.drop\n    });\n  };\n\n  return HeaderRender;\n}();\n\nexport { HeaderRender };","map":{"version":3,"sources":["C:/Users/appsk/Documents/Projects/PredictiveMaintenance/React PDM/env/frontend/node_modules/@syncfusion/ej2-grids/src/grid/renderer/header-renderer.js"],"names":["isNullOrUndefined","extend","setStyleAttribute","closest","getClosest","remove","isBlazor","classList","CellType","RowRenderer","Cell","Row","events","Draggable","Droppable","parentsUntil","wrap","measureColumnDepth","appendChildren","getFrozenTableName","HeaderRender","parent","serviceLocator","_this","frzIdx","notfrzIdx","isFirstCol","isReplaceDragEle","helper","e","gObj","target","draggable","currentStateTarget","parentEle","allowReordering","allowGrouping","querySelectorAll","length","visualElement","createElement","className","element","contains","height","offsetHeight","headercelldiv","querySelector","col","getStackedHeaderColumnByHeaderText","innerText","trim","columns","getColumnByUid","getAttribute","column","lockColumn","setAttribute","uid","headerTemplate","result","colIndex","getColumnIndexByField","field","getHeaderTemplate","innerHTML","headerText","firstElementChild","style","width","offsetWidth","lineHeight","toString","appendChild","dragStart","display","notify","columnDragStart","event","bindEvents","dragElement","drag","cloneElement","groupSettings","columnDrag","dragStop","cancel","columnDragStop","drop","droppedElement","headerDrop","ariaService","getService","widthService","isDestroyed","enableColumnVirtualization","getFrozenLeftColumnsCount","getFrozenRightColumnsCount","on","columnVisibilityChanged","setVisible","columnPositionChanged","colPosRefresh","prototype","renderPanel","div","isRendered","innerDiv","toggleStackClass","setPanel","renderTable","headerDiv","getPanel","createHeaderTable","setTable","getFrozenColumns","initializeHeaderDrag","initializeHeaderDrop","headerRefreshed","rows","args","isFrozen","isFrozenGrid","headerPanel","panel","getTable","headerTable","table","getColGroup","colgroup","setColGroup","colGroup","getRows","tHead","skipDom","frozenRows","createTable","tableEle","isJsComponent","getColumns","attrs","cellspacing","role","findHeaderRow","createHeaderContent","thead","tbody","caption","id","rowBody","bodyCell","rowRenderer","Header","i","len","j","len_1","cells","cell","allowFiltering","allowSorting","add","updateColGroup","setOptions","colcount","frozenMode","getFrozenMode","colHeader","headerRow","colDepth","generateRow","ensureColumns","getHeaderCells","frzCols","isRowDragable","colFreezeMode","getFreezeTableName","pop","shift","freeze","render","rowHeight","cols","indexes","getColumnIndexesInView","contentModule","isXaxis","splice","indexOf","detailTemplate","childGrid","visible","c","len_2","push","generateCell","HeaderIndent","detailIndentCellInfo","DetailHeader","RowDragHIcon","getHeaderTable","enablePersistence","tableName","lockcolPositionCount","lockColsRendered","appendCells","index","isFirstObj","isLastCol","isMovable","lastCol","isLockColumn","isFrozenLockColumn","scrollbar","getContent","left","scrollLeft","inViewIndexes","getColumnIndexByUid","frozenColumns","colSpan","getCellCnt","stackedLockColsCount","getStackedLockColsCount","isStackedLockColumn","isFrozenStack","ensureStackedFrozen","cellType","StackedHeader","getColSpan","isFirstCol_1","isLaststackedCol","isTrue","lockColsCount","getFrozenColSpan","count","rowSpan","rowIndex","opt","slice","call","displayVal","idx","clen","getNormalizedColumnIndex","normalizedfrzCols","isServerRendered","children","mTblColGrp","getHeaderContent","mTbl","refreshUI","freezeReorder","isVFTable","setFrozenTable","getVirtualFreezeHeader","removeChild","firstChild","childNodes","insertBefore","appendContent","colGroupRefresh","setWidthToColumns","updateDefaultCursor","_i","rows_1","row","gCells","allowTextWrap","textWrapSettings","wrapMode","stackedHdr","some","cnt","showDropArea","dragTarget","distance","abort","accept"],"mappings":"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","sourcesContent":["import { isNullOrUndefined, extend } from '@syncfusion/ej2-base';\nimport { setStyleAttribute, closest as getClosest, remove, isBlazor } from '@syncfusion/ej2-base';\nimport { classList } from '@syncfusion/ej2-base';\nimport { CellType } from '../base/enum';\nimport { RowRenderer } from './row-renderer';\nimport { Cell } from '../models/cell';\nimport { Row } from '../models/row';\nimport * as events from '../base/constant';\nimport { Draggable, Droppable } from '@syncfusion/ej2-base';\nimport { parentsUntil, wrap, measureColumnDepth, appendChildren, getFrozenTableName } from '../base/util';\n/**\n * Content module is used to render grid content\n * @hidden\n */\nvar HeaderRender = /** @class */ (function () {\n    /**\n     * Constructor for header renderer module\n     */\n    function HeaderRender(parent, serviceLocator) {\n        var _this = this;\n        this.frzIdx = 0;\n        this.notfrzIdx = 0;\n        this.isFirstCol = false;\n        this.isReplaceDragEle = true;\n        this.helper = function (e) {\n            var gObj = _this.parent;\n            var target = _this.draggable.currentStateTarget;\n            var parentEle = parentsUntil(target, 'e-headercell');\n            if (!(gObj.allowReordering || gObj.allowGrouping) || (!isNullOrUndefined(parentEle)\n                && parentEle.querySelectorAll('.e-checkselectall').length > 0)) {\n                return false;\n            }\n            var visualElement = _this.parent.createElement('div', { className: 'e-cloneproperties e-dragclone e-headerclone' });\n            var element = target.classList.contains('e-headercell') ? target : parentEle;\n            if (!element || (!gObj.allowReordering && element.classList.contains('e-stackedheadercell'))) {\n                return false;\n            }\n            var height = element.offsetHeight;\n            var headercelldiv = element.querySelector('.e-headercelldiv') || element.querySelector('.e-stackedheadercelldiv');\n            var col;\n            if (headercelldiv) {\n                if (element.querySelector('.e-stackedheadercelldiv')) {\n                    col = gObj.getStackedHeaderColumnByHeaderText(headercelldiv.innerText.trim(), gObj.columns);\n                }\n                else {\n                    col = gObj.getColumnByUid(headercelldiv.getAttribute('e-mappinguid'));\n                }\n                _this.column = col;\n                if (_this.column.lockColumn) {\n                    return false;\n                }\n                visualElement.setAttribute('e-mappinguid', _this.column.uid);\n            }\n            if (col && !isNullOrUndefined(col.headerTemplate)) {\n                if (!isNullOrUndefined(col.headerTemplate)) {\n                    var result = void 0;\n                    var colIndex = gObj.getColumnIndexByField(col.field);\n                    result = col.getHeaderTemplate()(extend({ 'index': colIndex }, col), gObj, 'headerTemplate');\n                    appendChildren(visualElement, result);\n                }\n                else {\n                    visualElement.innerHTML = col.headerTemplate;\n                }\n            }\n            else {\n                visualElement.innerHTML = headercelldiv ?\n                    col.headerText : element.firstElementChild.innerHTML;\n            }\n            visualElement.style.width = element.offsetWidth + 'px';\n            visualElement.style.height = element.offsetHeight + 'px';\n            visualElement.style.lineHeight = (height - 6).toString() + 'px';\n            gObj.element.appendChild(visualElement);\n            return visualElement;\n        };\n        this.dragStart = function (e) {\n            var gObj = _this.parent;\n            gObj.element.querySelector('.e-gridpopup').style.display = 'none';\n            gObj.notify(events.columnDragStart, { target: _this.draggable.currentStateTarget, column: _this.column, event: e.event });\n            if (isBlazor()) {\n                e.bindEvents(e.dragElement);\n            }\n        };\n        this.drag = function (e) {\n            var gObj = _this.parent;\n            var target = e.target;\n            if (target) {\n                var closest = getClosest(target, '.e-grid');\n                var cloneElement = _this.parent.element.querySelector('.e-cloneproperties');\n                if (!closest || closest.getAttribute('id') !== gObj.element.getAttribute('id')) {\n                    classList(cloneElement, ['e-notallowedcur'], ['e-defaultcur']);\n                    if (gObj.allowReordering) {\n                        gObj.element.querySelector('.e-reorderuparrow').style.display = 'none';\n                        gObj.element.querySelector('.e-reorderdownarrow').style.display = 'none';\n                    }\n                    if (!gObj.groupSettings.allowReordering) {\n                        return;\n                    }\n                }\n                gObj.notify(events.columnDrag, { target: e.target, column: _this.column, event: e.event });\n            }\n        };\n        this.dragStop = function (e) {\n            var gObj = _this.parent;\n            var cancel;\n            gObj.element.querySelector('.e-gridpopup').style.display = 'none';\n            if ((!parentsUntil(e.target, 'e-headercell') && !parentsUntil(e.target, 'e-groupdroparea')) ||\n                (!gObj.allowReordering && parentsUntil(e.target, 'e-headercell')) ||\n                (!e.helper.getAttribute('e-mappinguid') && parentsUntil(e.target, 'e-groupdroparea'))) {\n                remove(e.helper);\n                cancel = true;\n            }\n            gObj.notify(events.columnDragStop, { target: e.target, event: e.event, column: _this.column, cancel: cancel });\n        };\n        this.drop = function (e) {\n            var gObj = _this.parent;\n            var uid = e.droppedElement.getAttribute('e-mappinguid');\n            var closest = getClosest(e.target, '.e-grid');\n            remove(e.droppedElement);\n            if (closest && closest.getAttribute('id') !== gObj.element.getAttribute('id') ||\n                !(gObj.allowReordering || gObj.allowGrouping)) {\n                return;\n            }\n            gObj.notify(events.headerDrop, { target: e.target, uid: uid, droppedElement: e.droppedElement });\n        };\n        this.parent = parent;\n        this.serviceLocator = serviceLocator;\n        this.ariaService = this.serviceLocator.getService('ariaService');\n        this.widthService = this.serviceLocator.getService('widthService');\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        if (!this.parent.enableColumnVirtualization\n            && !this.parent.getFrozenLeftColumnsCount() && !this.parent.getFrozenRightColumnsCount()) {\n            this.parent.on(events.columnVisibilityChanged, this.setVisible, this);\n        }\n        this.parent.on(events.columnPositionChanged, this.colPosRefresh, this);\n    }\n    /**\n     * The function is used to render grid header div\n     */\n    HeaderRender.prototype.renderPanel = function () {\n        var div = this.parent.element.querySelector('.e-gridheader');\n        var isRendered = (div != null);\n        div = isRendered ? div : this.parent.createElement('div', { className: 'e-gridheader' });\n        var innerDiv = isRendered ? div.querySelector('.e-headercontent') :\n            this.parent.createElement('div', { className: 'e-headercontent' });\n        this.toggleStackClass(div);\n        div.appendChild(innerDiv);\n        this.setPanel(div);\n        if (!isRendered) {\n            this.parent.element.appendChild(div);\n        }\n    };\n    /**\n     * The function is used to render grid header table\n     */\n    HeaderRender.prototype.renderTable = function () {\n        var headerDiv = this.getPanel();\n        headerDiv.appendChild(this.createHeaderTable());\n        this.setTable(headerDiv.querySelector('.e-table'));\n        if (!this.parent.getFrozenColumns() && !this.parent.getFrozenRightColumnsCount() && !this.parent.getFrozenLeftColumnsCount()) {\n            this.initializeHeaderDrag();\n            this.initializeHeaderDrop();\n        }\n        this.parent.notify(events.headerRefreshed, { rows: this.rows, args: { isFrozen: this.parent.isFrozenGrid() } });\n    };\n    /**\n     * Get the header content div element of grid\n     * @return {Element}\n     */\n    HeaderRender.prototype.getPanel = function () {\n        return this.headerPanel;\n    };\n    /**\n     * Set the header content div element of grid\n     * @param  {Element} panel\n     */\n    HeaderRender.prototype.setPanel = function (panel) {\n        this.headerPanel = panel;\n    };\n    /**\n     * Get the header table element of grid\n     * @return {Element}\n     */\n    HeaderRender.prototype.getTable = function () {\n        return this.headerTable;\n    };\n    /**\n     * Set the header table element of grid\n     * @param  {Element} table\n     */\n    HeaderRender.prototype.setTable = function (table) {\n        this.headerTable = table;\n    };\n    /**\n     * Get the header colgroup element\n     * @returns {Element}\n     */\n    HeaderRender.prototype.getColGroup = function () {\n        return this.colgroup;\n    };\n    /**\n     * Set the header colgroup element\n     * @param {Element} colgroup\n     * @returns {Element}\n     */\n    HeaderRender.prototype.setColGroup = function (colGroup) {\n        return this.colgroup = colGroup;\n    };\n    /**\n     * Get the header row element collection.\n     * @return {Element[]}\n     */\n    HeaderRender.prototype.getRows = function () {\n        var table = this.getTable();\n        return table.tHead.rows;\n    };\n    /**\n     * The function is used to create header table elements\n     * @return {Element}\n     * @hidden\n     */\n    HeaderRender.prototype.createHeaderTable = function () {\n        var skipDom = isBlazor() && this.parent.frozenRows !== 0;\n        var table = this.createTable();\n        var innerDiv = this.getPanel().querySelector('.e-headercontent');\n        if (!skipDom) {\n            innerDiv.appendChild(table);\n        }\n        return innerDiv;\n    };\n    /**\n     * @hidden\n     */\n    HeaderRender.prototype.createTable = function (tableEle) {\n        if (tableEle === void 0) { tableEle = null; }\n        var skipDom = isBlazor() && this.parent.frozenRows !== 0;\n        var gObj = this.parent;\n        var isFrozen = gObj.isFrozenGrid();\n        if (!(isBlazor() && !gObj.isJsComponent) && this.getTable() && !isFrozen) {\n            remove(this.getTable());\n        }\n        var columns = gObj.getColumns();\n        var innerDiv = this.getPanel().querySelector('.e-headercontent');\n        var table = skipDom ? tableEle || innerDiv.querySelector('.e-table') :\n            this.parent.createElement('table', { className: 'e-table', attrs: { cellspacing: '0.25px', role: 'grid' } });\n        var findHeaderRow = this.createHeaderContent();\n        var thead = findHeaderRow.thead;\n        var tbody = this.parent.createElement('tbody', { className: this.parent.frozenRows ? '' : 'e-hide' });\n        this.caption = this.parent.createElement('caption', { innerHTML: this.parent.element.id + '_header_table', className: 'e-hide' });\n        var colGroup = this.parent.createElement('colgroup');\n        var rowBody = this.parent.createElement('tr');\n        var bodyCell;\n        var rows = this.rows = findHeaderRow.rows;\n        var rowRenderer = new RowRenderer(this.serviceLocator, CellType.Header, this.parent);\n        for (var i = 0, len = rows.length; i < len; i++) {\n            for (var j = 0, len_1 = rows[i].cells.length; j < len_1; j++) {\n                var cell = rows[i].cells[j];\n                bodyCell = this.parent.createElement('td');\n                rowBody.appendChild(bodyCell);\n            }\n        }\n        if (gObj.allowFiltering || gObj.allowSorting || gObj.allowGrouping) {\n            table.classList.add('e-sortfilter');\n        }\n        this.updateColGroup(colGroup);\n        if (!skipDom) {\n            tbody.appendChild(rowBody);\n        }\n        table.appendChild(this.setColGroup(colGroup));\n        table.appendChild(thead);\n        if (!skipDom) {\n            table.appendChild(tbody);\n        }\n        table.appendChild(this.caption);\n        this.ariaService.setOptions(table, { colcount: gObj.getColumns().length.toString() });\n        return table;\n    };\n    HeaderRender.prototype.createHeaderContent = function () {\n        var gObj = this.parent;\n        var frozenMode = gObj.getFrozenMode();\n        var columns = gObj.getColumns();\n        var thead = this.parent.createElement('thead');\n        var colHeader = this.parent.createElement('tr', { className: 'e-columnheader' });\n        var rowRenderer = new RowRenderer(this.serviceLocator, CellType.Header, gObj);\n        rowRenderer.element = colHeader;\n        var rows = [];\n        var headerRow;\n        this.colDepth = measureColumnDepth(gObj.columns);\n        for (var i = 0, len = this.colDepth; i < len; i++) {\n            rows[i] = this.generateRow(i);\n            rows[i].cells = [];\n        }\n        if (frozenMode !== 'Right') {\n            rows = this.ensureColumns(rows);\n        }\n        rows = this.getHeaderCells(rows);\n        if (frozenMode === 'Right') {\n            rows = this.ensureColumns(rows);\n        }\n        var frzCols = this.parent.getFrozenColumns();\n        if (this.parent.isRowDragable() && this.parent.isFrozenGrid() && rows[0].cells[1]) {\n            var colFreezeMode = rows[0].cells[1].column.getFreezeTableName();\n            if (colFreezeMode === 'movable' || (frozenMode === 'Left-Right' && colFreezeMode === 'frozen-right')) {\n                if (frozenMode === 'Right') {\n                    rows[0].cells.pop();\n                }\n                else {\n                    rows[0].cells.shift();\n                }\n            }\n            else if (!frzCols && colFreezeMode === 'frozen-left') {\n                rows[0].cells[0].column.freeze = colFreezeMode === 'frozen-left' ? 'Left' : 'Right';\n            }\n            else if (frozenMode === 'Right' && colFreezeMode === 'frozen-right') {\n                rows[0].cells[rows[0].cells.length - 1].column.freeze = 'Right';\n            }\n        }\n        for (var i = 0, len = this.colDepth; i < len; i++) {\n            headerRow = rowRenderer.render(rows[i], columns);\n            if (this.parent.rowHeight && headerRow.querySelector('.e-headercell')) {\n                headerRow.style.height = this.parent.rowHeight + 'px';\n            }\n            thead.appendChild(headerRow);\n        }\n        var findHeaderRow = {\n            thead: thead,\n            rows: rows\n        };\n        return findHeaderRow;\n    };\n    HeaderRender.prototype.updateColGroup = function (colGroup) {\n        var cols = this.parent.getColumns();\n        var col;\n        var indexes = this.parent.getColumnIndexesInView();\n        if (this.parent.enableColumnVirtualization && this.parent.getFrozenColumns()\n            && this.parent.contentModule.isXaxis()) {\n            cols = extend([], this.parent.getColumns());\n            cols.splice(0, this.parent.getFrozenColumns());\n        }\n        colGroup.id = this.parent.element.id + 'colGroup';\n        if (this.parent.allowGrouping) {\n            for (var i = 0, len = this.parent.groupSettings.columns.length; i < len; i++) {\n                if (this.parent.enableColumnVirtualization && indexes.indexOf(i) === -1) {\n                    continue;\n                }\n                col = this.parent.createElement('col', { className: 'e-group-intent' });\n                colGroup.appendChild(col);\n            }\n        }\n        if (this.parent.detailTemplate || this.parent.childGrid) {\n            col = this.parent.createElement('col', { className: 'e-detail-intent' });\n            colGroup.appendChild(col);\n        }\n        if (this.parent.isRowDragable() && this.parent.getFrozenMode() !== 'Right') {\n            col = this.parent.createElement('col', { className: 'e-drag-intent' });\n            colGroup.appendChild(col);\n        }\n        for (var i = 0, len = cols.length; i < len; i++) {\n            col = this.parent.createElement('col');\n            if (cols[i].visible === false) {\n                setStyleAttribute(col, { 'display': 'none' });\n            }\n            colGroup.appendChild(col);\n        }\n        if (this.parent.isRowDragable() && this.parent.getFrozenMode() === 'Right') {\n            col = this.parent.createElement('col', { className: 'e-drag-intent' });\n            colGroup.appendChild(col);\n        }\n        return colGroup;\n    };\n    HeaderRender.prototype.ensureColumns = function (rows) {\n        //TODO: generate dummy column for group, detail, stacked row here; ensureColumns here\n        var gObj = this.parent;\n        var indexes = this.parent.getColumnIndexesInView();\n        for (var i = 0, len = rows.length; i < len; i++) {\n            if (gObj.allowGrouping) {\n                for (var c = 0, len_2 = gObj.groupSettings.columns.length; c < len_2; c++) {\n                    if (this.parent.enableColumnVirtualization && indexes.indexOf(c) === -1) {\n                        continue;\n                    }\n                    rows[i].cells.push(this.generateCell({}, CellType.HeaderIndent));\n                }\n            }\n            if (gObj.detailTemplate || gObj.childGrid) {\n                var args = {};\n                this.parent.notify(events.detailIndentCellInfo, args);\n                rows[i].cells.push(this.generateCell(args, CellType.DetailHeader));\n            }\n            if (gObj.isRowDragable()) {\n                rows[i].cells.push(this.generateCell({}, CellType.RowDragHIcon));\n            }\n        }\n        return rows;\n    };\n    HeaderRender.prototype.getHeaderCells = function (rows) {\n        var column;\n        var thead = this.parent.getHeaderTable() && this.parent.getHeaderTable().querySelector('thead');\n        var cols = this.parent.enableColumnVirtualization ?\n            this.parent.getColumns(this.parent.enablePersistence) : this.parent.columns;\n        var tableName;\n        if (this.parent.enableColumnVirtualization && this.parent.isFrozenGrid()\n            && this.parent.contentModule.isXaxis()) {\n            tableName = 'movable';\n        }\n        else {\n            tableName = getFrozenTableName(this.parent);\n        }\n        this.frzIdx = 0;\n        this.notfrzIdx = 0;\n        if (this.parent.lockcolPositionCount) {\n            for (var i = 0; i < cols.length; i++) {\n                this.lockColsRendered = false;\n                rows = this.appendCells(cols[i], rows, 0, i === 0, false, i === (cols.length - 1), thead, tableName);\n            }\n        }\n        for (var i = 0, len = cols.length; i < len; i++) {\n            this.notfrzIdx = 0;\n            this.lockColsRendered = true;\n            rows = this.appendCells(cols[i], rows, 0, i === 0, false, i === (len - 1), thead, tableName);\n        }\n        return rows;\n    };\n    HeaderRender.prototype.appendCells = function (cols, rows, index, isFirstObj, isFirstCol, isLastCol, isMovable, tableName) {\n        var lastCol = isLastCol ? 'e-lastcell' : '';\n        var isFrozen = this.parent.isFrozenGrid();\n        var isLockColumn = !this.parent.lockcolPositionCount\n            || (cols.lockColumn && !this.lockColsRendered) || (!cols.lockColumn && this.lockColsRendered);\n        var isFrozenLockColumn = !this.parent.lockcolPositionCount || (cols.lockColumn && !this.lockColsRendered)\n            || (!cols.lockColumn && this.lockColsRendered);\n        var scrollbar = this.parent.getContent().querySelector('.e-movablescrollbar');\n        var left;\n        if (isFrozen && scrollbar && this.parent.enableColumnVirtualization) {\n            left = scrollbar.scrollLeft;\n        }\n        if (!cols.columns) {\n            if (left && left > 0 && this.parent.contentModule.isXaxis()\n                && this.parent.inViewIndexes[0] !== 0 && cols.getFreezeTableName() === 'movable') {\n                rows[index].cells.push(this.generateCell(cols, CellType.Header, this.colDepth - index, (isFirstObj ? '' : (isFirstCol ? 'e-firstcell' : '')) + lastCol, index, this.parent.getColumnIndexByUid(cols.uid)));\n            }\n            else {\n                if ((!isFrozen && isLockColumn) || (isFrozen && cols.getFreezeTableName() === tableName && isFrozenLockColumn)) {\n                    rows[index].cells.push(this.generateCell(cols, CellType.Header, this.colDepth - index, (isFirstObj ? '' : (isFirstCol ? 'e-firstcell' : '')) + lastCol, index, this.parent.getColumnIndexByUid(cols.uid)));\n                }\n            }\n            if (this.parent.lockcolPositionCount) {\n                if ((this.frzIdx + this.notfrzIdx < this.parent.frozenColumns) &&\n                    ((cols.lockColumn && !this.lockColsRendered) || (!cols.lockColumn && this.lockColsRendered))) {\n                    this.frzIdx++;\n                }\n                else {\n                    this.notfrzIdx++;\n                }\n            }\n            else {\n                this.frzIdx++;\n            }\n        }\n        else {\n            this.isFirstCol = false;\n            var colSpan = this.getCellCnt(cols, 0);\n            if (colSpan) {\n                var stackedLockColsCount = this.getStackedLockColsCount(cols, 0);\n                var isStackedLockColumn = this.parent.lockcolPositionCount === 0\n                    || (!this.lockColsRendered && stackedLockColsCount !== 0)\n                    || (this.lockColsRendered && (colSpan - stackedLockColsCount) !== 0);\n                var isFrozenStack = isFrozen && this.ensureStackedFrozen(cols.columns, tableName, false);\n                if ((!isFrozen && isStackedLockColumn) || isFrozenStack) {\n                    rows[index].cells.push(new Cell({\n                        cellType: CellType.StackedHeader, column: cols,\n                        colSpan: this.getColSpan(colSpan, stackedLockColsCount, cols.columns, tableName, isFrozen)\n                    }));\n                }\n            }\n            if (this.parent.lockcolPositionCount && !this.lockColsRendered) {\n                for (var i = 0; i < cols.columns.length; i++) {\n                    rows = this.appendCells(cols.columns[i], rows, index + 1, isFirstObj, i === 0, i === (cols.columns.length - 1) && isLastCol, isMovable, tableName);\n                }\n            }\n            if (this.lockColsRendered) {\n                for (var i = 0, len = cols.columns.length; i < len; i++) {\n                    var isFirstCol_1 = this.isFirstCol = cols.columns[i].visible && !this.isFirstCol && len !== 1;\n                    var isLaststackedCol = i === (len - 1);\n                    rows = this.appendCells(cols.columns[i], rows, index + 1, isFirstObj, isFirstCol_1, isLaststackedCol && isLastCol, isMovable, tableName);\n                }\n            }\n        }\n        return rows;\n    };\n    HeaderRender.prototype.ensureStackedFrozen = function (columns, tableName, isTrue) {\n        var length = columns.length;\n        for (var i = 0; i < length; i++) {\n            if (columns[i].columns) {\n                isTrue = this.ensureStackedFrozen(columns[i].columns, tableName, isTrue);\n            }\n            else if (columns[i].getFreezeTableName() === tableName) {\n                isTrue = true;\n                break;\n            }\n        }\n        return isTrue;\n    };\n    HeaderRender.prototype.getStackedLockColsCount = function (col, lockColsCount) {\n        if (col.columns) {\n            for (var i = 0; i < col.columns.length; i++) {\n                lockColsCount = this.getStackedLockColsCount(col.columns[i], lockColsCount);\n            }\n        }\n        else if (col.lockColumn) {\n            lockColsCount++;\n        }\n        return lockColsCount;\n    };\n    HeaderRender.prototype.getColSpan = function (colSpan, stackedLockColsCount, columns, tableName, isFrozen) {\n        if (isFrozen) {\n            colSpan = this.getFrozenColSpan(columns, tableName, 0);\n        }\n        else if (this.parent.lockcolPositionCount) {\n            colSpan = !this.lockColsRendered ? stackedLockColsCount : colSpan - stackedLockColsCount;\n        }\n        return colSpan;\n    };\n    HeaderRender.prototype.getFrozenColSpan = function (columns, tableName, count) {\n        var length = columns.length;\n        for (var i = 0; i < length; i++) {\n            if (columns[i].columns) {\n                count = this.getFrozenColSpan(columns[i].columns, tableName, count);\n            }\n            else if (columns[i].getFreezeTableName() === tableName) {\n                count++;\n            }\n        }\n        return count;\n    };\n    HeaderRender.prototype.generateRow = function (index) {\n        return new Row({});\n    };\n    HeaderRender.prototype.generateCell = function (column, cellType, rowSpan, className, rowIndex, colIndex) {\n        var opt = {\n            'visible': column.visible,\n            'isDataCell': false,\n            'isTemplate': !isNullOrUndefined(column.headerTemplate),\n            'rowID': '',\n            'column': column,\n            'cellType': cellType,\n            'rowSpan': rowSpan,\n            'className': className,\n            'index': rowIndex,\n            'colIndex': colIndex\n        };\n        if (!opt.rowSpan || opt.rowSpan < 2) {\n            delete opt.rowSpan;\n        }\n        return new Cell(opt);\n    };\n    /**\n     * Function to hide header table column based on visible property\n     * @param  {Column[]} columns?\n     */\n    HeaderRender.prototype.setVisible = function (columns) {\n        var gObj = this.parent;\n        var rows = [].slice.call(this.getRows()); //NodeList -> Array        \n        var displayVal;\n        var idx;\n        var className;\n        var element;\n        var frzCols = gObj.getFrozenColumns();\n        for (var c = 0, clen = columns.length; c < clen; c++) {\n            var column = columns[c];\n            idx = gObj.getNormalizedColumnIndex(column.uid);\n            displayVal = column.visible ? '' : 'none';\n            if (frzCols) {\n                var normalizedfrzCols = this.parent.isRowDragable() ? frzCols + 1 : frzCols;\n                if (idx < normalizedfrzCols) {\n                    if (isBlazor() && gObj.isServerRendered) {\n                        setStyleAttribute(this.getTable().querySelector('colgroup').children[idx], { 'display': displayVal });\n                        setStyleAttribute(this.getTable().querySelectorAll('th')[idx], { 'display': displayVal });\n                    }\n                    else {\n                        setStyleAttribute(this.getColGroup().children[idx], { 'display': displayVal });\n                    }\n                }\n                else {\n                    var mTblColGrp = gObj.getHeaderContent().querySelector('.e-movableheader').querySelector('colgroup');\n                    var mTbl = gObj.getHeaderContent().querySelector('.e-movableheader').querySelector('table');\n                    setStyleAttribute(mTblColGrp.children[idx - normalizedfrzCols], { 'display': displayVal });\n                    if (isBlazor() && gObj.isServerRendered) {\n                        setStyleAttribute(mTbl.querySelectorAll('th')[idx - frzCols], { 'display': displayVal });\n                    }\n                }\n            }\n            else {\n                setStyleAttribute(this.getColGroup().children[idx], { 'display': displayVal });\n            }\n        }\n        this.refreshUI();\n    };\n    HeaderRender.prototype.colPosRefresh = function () {\n        if (isBlazor() && this.parent.isServerRendered && this.parent.frozenRows && this.parent.getFrozenColumns()) {\n            this.freezeReorder = true;\n        }\n        this.refreshUI();\n    };\n    /**\n     * Refresh the header of the Grid.\n     * @returns {void}\n     */\n    HeaderRender.prototype.refreshUI = function () {\n        var frzCols = this.parent.isFrozenGrid();\n        var isVFTable = this.parent.enableColumnVirtualization && frzCols;\n        var setFrozenTable = isBlazor() && this.parent.isServerRendered && this.parent.frozenRows !== 0 && frzCols;\n        var headerDiv = this.getPanel();\n        this.toggleStackClass(headerDiv);\n        var table = this.freezeReorder ? this.headerPanel.querySelector('.e-movableheader').querySelector('.e-table')\n            : this.getTable();\n        if (isVFTable) {\n            table = this.parent.contentModule.getVirtualFreezeHeader();\n        }\n        if (setFrozenTable && !isVFTable) {\n            table = this.freezeReorder ? this.headerPanel.querySelector('.e-movableheader').querySelector('.e-table') :\n                this.headerPanel.querySelector('.e-frozenheader').querySelector('.e-table');\n        }\n        if (table) {\n            if (isBlazor() && this.parent.isServerRendered) {\n                table.removeChild(table.querySelector('colgroup'));\n                table.removeChild(table.querySelector('thead'));\n            }\n            else {\n                remove(table);\n                table.removeChild(table.firstChild);\n                table.removeChild(table.childNodes[0]);\n            }\n            var colGroup = this.parent.createElement('colgroup');\n            var findHeaderRow = this.createHeaderContent();\n            this.rows = findHeaderRow.rows;\n            table.insertBefore(findHeaderRow.thead, table.firstChild);\n            this.updateColGroup(colGroup);\n            table.insertBefore(this.setColGroup(colGroup), table.firstChild);\n            if (!isVFTable && !setFrozenTable) {\n                this.setTable(table);\n            }\n            if (!(isBlazor() && this.parent.isServerRendered)) {\n                this.appendContent(table);\n            }\n            this.parent.notify(events.colGroupRefresh, {});\n            this.widthService.setWidthToColumns();\n            this.parent.updateDefaultCursor();\n            if (!frzCols || (this.parent.enableColumnVirtualization && frzCols)) {\n                this.initializeHeaderDrag();\n            }\n            var rows = [].slice.call(headerDiv.querySelectorAll('tr.e-columnheader'));\n            for (var _i = 0, rows_1 = rows; _i < rows_1.length; _i++) {\n                var row = rows_1[_i];\n                var gCells = [].slice.call(row.querySelectorAll('.e-grouptopleftcell'));\n                if (gCells.length) {\n                    gCells[gCells.length - 1].classList.add('e-lastgrouptopleftcell');\n                }\n            }\n            if (!frzCols) {\n                this.parent.notify(events.headerRefreshed, { rows: this.rows, args: { isFrozen: frzCols } });\n            }\n            if (this.parent.enableColumnVirtualization && parentsUntil(table, 'e-movableheader')) {\n                this.parent.notify(events.headerRefreshed, { rows: this.rows, args: { isFrozen: false, isXaxis: true } });\n            }\n            if (this.parent.allowTextWrap && this.parent.textWrapSettings.wrapMode === 'Header') {\n                wrap(rows, true);\n            }\n        }\n    };\n    HeaderRender.prototype.toggleStackClass = function (div) {\n        var column = this.parent.columns;\n        var stackedHdr = column.some(function (column) { return !isNullOrUndefined(column.columns); });\n        if (stackedHdr) {\n            div.classList.add('e-stackedheader');\n        }\n        else {\n            div.classList.remove('e-stackedheader');\n        }\n    };\n    HeaderRender.prototype.appendContent = function (table) {\n        this.getPanel().querySelector('.e-headercontent').appendChild(table);\n    };\n    HeaderRender.prototype.getCellCnt = function (col, cnt) {\n        if (col.columns) {\n            for (var i = 0, len = col.columns.length; i < len; i++) {\n                cnt = this.getCellCnt(col.columns[i], cnt);\n            }\n        }\n        else {\n            if (col.visible) {\n                cnt++;\n            }\n        }\n        return cnt;\n    };\n    HeaderRender.prototype.initializeHeaderDrag = function () {\n        var gObj = this.parent;\n        if (!(this.parent.allowReordering || (this.parent.allowGrouping && this.parent.groupSettings.showDropArea))) {\n            return;\n        }\n        this.draggable = new Draggable(gObj.getHeaderContent(), {\n            dragTarget: '.e-headercell',\n            distance: 5,\n            helper: this.helper,\n            dragStart: this.dragStart,\n            drag: this.drag,\n            dragStop: this.dragStop,\n            abort: '.e-rhandler',\n            isReplaceDragEle: this.isReplaceDragEle\n        });\n    };\n    HeaderRender.prototype.initializeHeaderDrop = function () {\n        var gObj = this.parent;\n        var drop = new Droppable(gObj.getHeaderContent(), {\n            accept: '.e-dragclone',\n            drop: this.drop\n        });\n    };\n    return HeaderRender;\n}());\nexport { HeaderRender };\n"]},"metadata":{},"sourceType":"module"}