{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport { extend, remove, isNullOrUndefined, setStyleAttribute, removeClass, addClass } from '@syncfusion/ej2-base';\nimport { ContentRender } from './content-renderer';\nimport * as events from '../base/constant';\nimport { isRowEnteredInGrid, parentsUntil } from '../base/util';\nimport { RowRenderer } from '../renderer/row-renderer';\nimport { CheckBoxFilterBase } from '../common/checkbox-filter-base';\nimport { GroupModelGenerator } from '../services/group-model-generator';\nimport { GroupSummaryModelGenerator, CaptionSummaryModelGenerator } from '../services/summary-model-generator';\n/**\n * GroupLazyLoadRenderer is used to perform lazy load grouping\n * @hidden\n */\n\nvar GroupLazyLoadRenderer =\n/** @class */\nfunction (_super) {\n  __extends(GroupLazyLoadRenderer, _super);\n\n  function GroupLazyLoadRenderer(parent, locator) {\n    var _this = _super.call(this, parent, locator) || this;\n\n    _this.childCount = 0;\n    _this.scrollData = [];\n    _this.isFirstChildRow = false;\n    _this.groupCache = {};\n    _this.startIndexes = {};\n    _this.captionCounts = {};\n    _this.rowsByUid = {};\n    _this.objIdxByUid = {};\n    _this.initialGroupCaptions = {};\n    _this.requestType = ['paging', 'columnstate', 'reorder', 'cancel', 'save', 'beginEdit', 'add', 'delete'];\n    /** @hidden */\n\n    _this.cacheMode = false;\n    /** @hidden */\n\n    _this.cacheBlockSize = 5;\n    /** @hidden */\n\n    _this.ignoreAccent = _this.parent.allowFiltering ? _this.parent.filterSettings.ignoreAccent : false;\n    /** @hidden */\n\n    _this.allowCaseSensitive = false;\n    _this.locator = locator;\n    _this.groupGenerator = new GroupModelGenerator(_this.parent);\n    _this.summaryModelGen = new GroupSummaryModelGenerator(_this.parent);\n    _this.captionModelGen = new CaptionSummaryModelGenerator(_this.parent);\n    _this.rowRenderer = new RowRenderer(_this.locator, null, _this.parent);\n\n    _this.eventListener();\n\n    return _this;\n  }\n\n  GroupLazyLoadRenderer.prototype.eventListener = function () {\n    this.parent.addEventListener(events.actionBegin, this.actionBegin.bind(this));\n    this.parent.addEventListener(events.actionComplete, this.actionComplete.bind(this));\n    this.parent.on(events.initialEnd, this.setLazyLoadPageSize, this);\n    this.parent.on(events.setGroupCache, this.setCache, this);\n    this.parent.on(events.lazyLoadScrollHandler, this.scrollHandler, this);\n    this.parent.on(events.columnVisibilityChanged, this.setVisible, this);\n    this.parent.on(events.groupCollapse, this.collapseShortcut, this);\n  };\n  /** @hidden */\n\n\n  GroupLazyLoadRenderer.prototype.captionExpand = function (tr) {\n    var _this = this;\n\n    var page = this.parent.pageSettings.currentPage;\n    var rowsObject = this.groupCache[page];\n    var uid = tr.getAttribute('data-uid');\n    var oriIndex = this.getRowObjectIndexByUid(uid);\n    var isRowExist = rowsObject[oriIndex + 1] ? rowsObject[oriIndex].indent < rowsObject[oriIndex + 1].indent : false;\n    var data = rowsObject[oriIndex];\n    var key = this.getGroupKeysAndFields(oriIndex, rowsObject);\n    var e = {\n      captionRowElement: tr,\n      groupInfo: data,\n      enableCaching: true,\n      cancel: false\n    };\n    this.parent.trigger(events.lazyLoadGroupExpand, e, function (args) {\n      if (args.cancel) {\n        return;\n      }\n\n      args.keys = key.keys;\n      args.fields = key.fields;\n      args.rowIndex = tr.rowIndex;\n      args.makeRequest = !args.enableCaching || !isRowExist;\n\n      if (!args.enableCaching && isRowExist) {\n        _this.clearCache([uid]);\n      }\n\n      args.skip = 0;\n      args.take = _this.pageSize;\n      data.isExpand = _this.rowsByUid[page][data.uid].isExpand = true;\n\n      _this.captionRowExpand(args);\n    });\n  };\n  /** @hidden */\n\n\n  GroupLazyLoadRenderer.prototype.captionCollapse = function (tr) {\n    var _this = this;\n\n    var cache = this.groupCache[this.parent.pageSettings.currentPage];\n    var rowIdx = tr.rowIndex;\n    var uid = tr.getAttribute('data-uid');\n    var captionIndex = this.getRowObjectIndexByUid(uid);\n    var e = {\n      captionRowElement: tr,\n      groupInfo: cache[captionIndex],\n      cancel: false\n    };\n    this.parent.trigger(events.lazyLoadGroupCollapse, e, function (args) {\n      if (args.cancel) {\n        return;\n      }\n\n      args.isExpand = false;\n\n      _this.removeRows(captionIndex, rowIdx);\n    });\n  };\n  /** @hidden */\n\n\n  GroupLazyLoadRenderer.prototype.setLazyLoadPageSize = function () {\n    var scrollEle = this.parent.getContent().firstElementChild;\n    var blockSize = Math.floor(scrollEle.offsetHeight / this.parent.getRowHeight()) - 1;\n    this.pageSize = this.pageSize ? this.pageSize : blockSize * 3;\n    this.blockSize = Math.ceil(this.pageSize / 2);\n  };\n  /** @hidden */\n\n\n  GroupLazyLoadRenderer.prototype.clearLazyGroupCache = function () {\n    this.clearCache();\n  };\n\n  GroupLazyLoadRenderer.prototype.clearCache = function (uids) {\n    uids = uids ? uids : this.getInitialCaptionIndexes();\n    var cache = this.groupCache[this.parent.pageSettings.currentPage];\n\n    if (uids.length) {\n      for (var i = 0; i < uids.length; i++) {\n        var capIdx = this.getRowObjectIndexByUid(uids[i]);\n        var capRow = cache[capIdx];\n\n        if (!capRow) {\n          continue;\n        }\n\n        if (this.captionCounts[this.parent.pageSettings.currentPage][capRow.uid]) {\n          for (var i_1 = capIdx + 1; i_1 < cache.length; i_1++) {\n            if (cache[i_1].indent === capRow.indent || cache[i_1].indent < capRow.indent) {\n              delete this.captionCounts[this.parent.pageSettings.currentPage][capRow.uid];\n              break;\n            }\n\n            if (cache[i_1].isCaptionRow) {\n              delete this.captionCounts[this.parent.pageSettings.currentPage][cache[i_1].uid];\n            }\n          }\n        }\n\n        if (capRow.isExpand) {\n          var tr = this.parent.getRowElementByUID(capRow.uid);\n\n          if (!tr) {\n            return;\n          }\n\n          this.parent.groupModule.expandCollapseRows(tr.querySelector('.e-recordplusexpand'));\n        }\n\n        var child = this.getNextChilds(capIdx);\n\n        if (!child.length) {\n          continue;\n        }\n\n        var subChild = [];\n\n        if (child[child.length - 1].isCaptionRow) {\n          subChild = this.getChildRowsByParentIndex(cache.indexOf(child[child.length - 1]), false, false, null, true, true);\n        }\n\n        var start = cache.indexOf(child[0]);\n        var end = subChild.length ? cache.indexOf(subChild[subChild.length - 1]) : cache.indexOf(child[child.length - 1]);\n        cache.splice(start, end - (start - 1));\n        this.refreshCaches();\n      }\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.refreshCaches = function () {\n    var page = this.parent.pageSettings.currentPage;\n    var cache = this.groupCache[page];\n    this.rowsByUid = {};\n    this.objIdxByUid = {};\n\n    for (var i = 0; i < cache.length; i++) {\n      this.maintainRows(cache[i], i);\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.getInitialCaptionIndexes = function () {\n    var page = this.parent.pageSettings.currentPage;\n    var uids = [];\n\n    for (var i = 0; i < this.initialGroupCaptions[page].length; i++) {\n      uids.push(this.initialGroupCaptions[page][i].uid);\n    }\n\n    return uids;\n  };\n  /** @hidden */\n\n\n  GroupLazyLoadRenderer.prototype.getRowObjectIndexByUid = function (uid) {\n    return this.objIdxByUid[this.parent.pageSettings.currentPage][uid];\n  };\n\n  GroupLazyLoadRenderer.prototype.collapseShortcut = function (args) {\n    if (this.parent.groupSettings.columns.length && args.target && parentsUntil(args.target, 'e-content') && args.target.parentElement.tagName === 'TR') {\n      if (!args.collapse && parentsUntil(args.target, 'e-row')) {\n        return;\n      }\n\n      var row = args.target.parentElement;\n      var uid = row.getAttribute('data-uid');\n\n      if (args.collapse) {\n        var rowObj = this.getRowByUid(uid);\n        var capRow = this.getRowByUid(rowObj.parentUid);\n\n        if (capRow.isCaptionRow && capRow.isExpand) {\n          var capEle = this.getRowElementByUid(rowObj.parentUid);\n          this.parent.groupModule.expandCollapseRows(capEle.cells[rowObj.indent - 1]);\n        }\n      } else {\n        var capRow = this.getRowByUid(uid);\n\n        if (capRow.isCaptionRow && !capRow.isExpand) {\n          var capEle = this.getRowElementByUid(uid);\n          this.parent.groupModule.expandCollapseRows(capEle.cells[capRow.indent]);\n        }\n      }\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.getRowByUid = function (uid) {\n    return this.rowsByUid[this.parent.pageSettings.currentPage][uid];\n  };\n\n  GroupLazyLoadRenderer.prototype.actionBegin = function (args) {\n    if (!args.cancel) {\n      if (!this.requestType.some(function (value) {\n        return value === args.requestType;\n      })) {\n        this.groupCache = {};\n        this.resetRowMaintenance();\n      }\n\n      if (args.requestType === 'reorder' && this.parent.groupSettings.columns.length) {\n        var keys = Object.keys(this.groupCache);\n\n        for (var j = 0; j < keys.length; j++) {\n          var cache = this.groupCache[keys[j]];\n\n          for (var i = 0; i < cache.length; i++) {\n            if (cache[i].isCaptionRow && !this.captionModelGen.isEmpty()) {\n              this.changeCaptionRow(cache[i], null, keys[j]);\n            }\n\n            if (cache[i].isDataRow) {\n              var from = args.fromIndex + cache[i].indent;\n              var to = args.toIndex + cache[i].indent;\n              this.moveCells(cache[i].cells, from, to);\n            }\n          }\n        }\n      }\n\n      if (args.requestType === 'delete' || args.action === 'add' && args.requestType === 'save') {\n        this.groupCache = {};\n        this.resetRowMaintenance();\n      }\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.actionComplete = function (args) {\n    if (!args.cancel && args.requestType !== 'columnstate' && args.requestType !== 'beginEdit' && args.requestType !== 'delete' && args.requestType !== 'save' && args.requestType !== 'reorder') {\n      this.scrollReset();\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.resetRowMaintenance = function () {\n    this.startIndexes = {};\n    this.captionCounts = {};\n    this.rowsByUid = {};\n    this.objIdxByUid = {};\n    this.initialGroupCaptions = {};\n  };\n\n  GroupLazyLoadRenderer.prototype.moveCells = function (arr, from, to) {\n    if (from >= arr.length) {\n      var k = from - arr.length;\n\n      while (k-- + 1) {\n        arr.push(undefined);\n      }\n    }\n\n    arr.splice(from, 0, arr.splice(to, 1)[0]);\n  };\n\n  GroupLazyLoadRenderer.prototype.removeRows = function (idx, trIdx) {\n    var page = this.parent.pageSettings.currentPage;\n    var rows = this.groupCache[page];\n    var trs = [].slice.call(this.parent.getContent().querySelectorAll('tr'));\n    var aggUid;\n\n    if (this.parent.aggregates.length) {\n      var agg = this.getAggregateByCaptionIndex(idx);\n      aggUid = agg.length ? agg[agg.length - 1].uid : undefined;\n    }\n\n    var indent = rows[idx].indent;\n    this.addClass(this.getNextChilds(idx));\n    rows[idx].isExpand = this.rowsByUid[page][rows[idx].uid].isExpand = false;\n    var capUid;\n\n    for (var i = idx + 1; i < rows.length; i++) {\n      if (rows[i].indent === indent || rows[i].indent < indent) {\n        capUid = rows[i].uid;\n        break;\n      }\n\n      if (rows[i].isCaptionRow && rows[i].isExpand) {\n        this.addClass(this.getNextChilds(i));\n      }\n    }\n\n    for (var i = trIdx + 1; i < trs.length; i++) {\n      if (trs[i].getAttribute('data-uid') === capUid) {\n        break;\n      } else if (trs[i].getAttribute('data-uid') === aggUid) {\n        remove(trs[i]);\n        break;\n      } else {\n        remove(trs[i]);\n      }\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.addClass = function (rows) {\n    var last = rows[this.blockSize];\n\n    if (last) {\n      last.lazyLoadCssClass = 'e-lazyload-middle-down';\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.getNextChilds = function (index, rowObjects) {\n    var group = this.groupCache[this.parent.pageSettings.currentPage];\n    var rows = rowObjects ? rowObjects : group;\n    var indent = group[index].indent + 1;\n    var childRows = [];\n\n    for (var i = rowObjects ? 0 : index + 1; i < rows.length; i++) {\n      if (rows[i].indent < indent) {\n        break;\n      }\n\n      if (rows[i].indent === indent) {\n        childRows.push(rows[i]);\n      }\n    }\n\n    return childRows;\n  };\n\n  GroupLazyLoadRenderer.prototype.lazyLoadHandler = function (args) {\n    this.setStartIndexes();\n    var tr = this.parent.getContent().querySelectorAll('tr')[args.index];\n    var uid = tr.getAttribute('data-uid');\n    var captionIndex = this.getRowObjectIndexByUid(uid);\n    var captionRow = this.groupCache[this.parent.pageSettings.currentPage][captionIndex];\n    var rows = args.isRowExist ? args.isScroll ? this.scrollData : this.getChildRowsByParentIndex(captionIndex, true, true, null, true) : [];\n    this.scrollData = [];\n\n    if (!args.isRowExist) {\n      this.setRowIndexes(captionIndex, captionRow);\n      this.refreshCaptionRowCount(this.groupCache[this.parent.pageSettings.currentPage][captionIndex], args.count);\n\n      if (Object.keys(args.data).indexOf('GroupGuid') !== -1) {\n        for (var i = 0; i < args.data.length; i++) {\n          var data = this.groupGenerator.generateCaptionRow(args.data[i], args.level, captionRow.parentGid, undefined, 0, captionRow.uid);\n          rows.push(data);\n\n          if (this.parent.aggregates.length) {\n            rows = rows.concat(this.summaryModelGen.generateRows(args.data[i], {\n              level: args.level + 1,\n              parentUid: data.uid\n            }));\n          }\n        }\n      } else {\n        this.groupGenerator.index = this.getStartIndex(captionIndex, args.isScroll);\n        rows = this.groupGenerator.generateDataRows(args.data, args.level, captionRow.parentGid, 0, captionRow.uid);\n      }\n    }\n\n    var trIdx = args.isScroll ? this.rowIndex : args.index;\n    var nxtChild = this.getNextChilds(captionIndex, rows);\n    var lastRow = !args.up ? this.hasLastChildRow(args.isScroll, args.count, nxtChild.length) : true;\n\n    if (!args.isRowExist && !lastRow) {\n      nxtChild[this.blockSize].lazyLoadCssClass = 'e-lazyload-middle-down';\n    }\n\n    if (!lastRow) {\n      nxtChild[nxtChild.length - 1].lazyLoadCssClass = 'e-not-lazyload-end';\n    }\n\n    var aggregates = !args.isScroll && !args.isRowExist ? this.getAggregateByCaptionIndex(captionIndex) : [];\n\n    if (!args.up) {\n      if (!args.isRowExist) {\n        this.refreshRowObjects(rows, args.isScroll ? this.rowObjectIndex : captionIndex);\n      }\n    }\n\n    this.render(trIdx, rows, lastRow, aggregates);\n\n    if (this.isFirstChildRow && !args.up) {\n      this.parent.getContent().firstElementChild.scrollTop = rows.length * this.parent.getRowHeight();\n    }\n\n    this.isFirstChildRow = false;\n    this.rowIndex = undefined;\n    this.rowObjectIndex = undefined;\n    this.childCount = 0;\n  };\n\n  GroupLazyLoadRenderer.prototype.setRowIndexes = function (capIdx, row) {\n    if (!this.captionCounts[this.parent.pageSettings.currentPage]) {\n      this.captionCounts[this.parent.pageSettings.currentPage] = {};\n    }\n\n    if (row.isCaptionRow) {\n      this.captionCounts[this.parent.pageSettings.currentPage][row.uid] = row.data.count;\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.getStartIndex = function (capIdx, isScroll) {\n    var page = this.parent.pageSettings.currentPage;\n    var cache = this.groupCache[page];\n\n    if (isScroll) {\n      return cache[this.rowObjectIndex].index + 1;\n    }\n\n    var count = 0;\n    var idx = 0;\n    var prevCapRow = this.getRowByUid(cache[capIdx].parentUid);\n\n    if (prevCapRow) {\n      idx = this.prevCaptionCount(prevCapRow);\n    }\n\n    if (cache[capIdx].indent > 0) {\n      for (var i = capIdx - 1; i >= 0; i--) {\n        if (cache[i].indent < cache[capIdx].indent) {\n          break;\n        }\n\n        if (cache[i].isCaptionRow && cache[i].indent === cache[capIdx].indent) {\n          count = count + cache[i].data.count;\n        }\n      }\n    }\n\n    var index = count + idx + this.startIndexes[page][cache[capIdx].parentGid];\n    return index;\n  };\n\n  GroupLazyLoadRenderer.prototype.prevCaptionCount = function (prevCapRow) {\n    var page = this.parent.pageSettings.currentPage;\n    var cache = this.groupCache[page];\n    var idx = 0;\n\n    for (var i = cache.indexOf(prevCapRow) - 1; i >= 0; i--) {\n      if (cache[i].indent === 0) {\n        break;\n      }\n\n      if (cache[i].indent < prevCapRow.indent) {\n        break;\n      }\n\n      if (cache[i].isCaptionRow && cache[i].indent === prevCapRow.indent) {\n        var count = this.captionCounts[page][cache[i].uid];\n        idx = idx + (count ? count : cache[i].data.count);\n      }\n    }\n\n    var capRow = this.getRowByUid(prevCapRow.parentUid);\n\n    if (capRow) {\n      idx = idx + this.prevCaptionCount(capRow);\n    }\n\n    return idx;\n  };\n\n  GroupLazyLoadRenderer.prototype.setStartIndexes = function () {\n    var cache = this.groupCache[this.parent.pageSettings.currentPage];\n\n    if (!this.startIndexes[this.parent.pageSettings.currentPage]) {\n      var indexes = [];\n      var idx = void 0;\n\n      for (var i = 0; i < cache.length; i++) {\n        if (cache[i].isCaptionRow) {\n          !indexes.length ? indexes.push(0) : indexes.push(cache[idx].data.count + indexes[indexes.length - 1]);\n          idx = i;\n        }\n      }\n\n      this.startIndexes[this.parent.pageSettings.currentPage] = indexes;\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.hasLastChildRow = function (isScroll, captionCount, rowCount) {\n    return isScroll ? captionCount === this.childCount + rowCount : captionCount === rowCount;\n  };\n\n  GroupLazyLoadRenderer.prototype.refreshCaptionRowCount = function (row, count) {\n    row.data.count = count;\n  };\n\n  GroupLazyLoadRenderer.prototype.render = function (trIdx, rows, hasLastChildRow, aggregates) {\n    var tr = this.parent.getContent().querySelectorAll('tr')[trIdx];\n    var isLastRow = true;\n\n    if (tr && aggregates.length) {\n      for (var i = aggregates.length - 1; i >= 0; i--) {\n        tr.insertAdjacentElement('afterend', this.rowRenderer.render(aggregates[i], this.parent.getColumns()));\n      }\n    }\n\n    if (tr && rows.length) {\n      for (var i = rows.length - 1; i >= 0; i--) {\n        if (this.confirmRowRendering(rows[i])) {\n          tr.insertAdjacentElement('afterend', this.rowRenderer.render(rows[i], this.parent.getColumns()));\n        }\n      }\n    }\n  };\n  /** @hidden */\n\n\n  GroupLazyLoadRenderer.prototype.maintainRows = function (row, index) {\n    var page = this.parent.pageSettings.currentPage;\n\n    if (!this.rowsByUid[page]) {\n      this.rowsByUid[page] = {};\n      this.objIdxByUid[page] = {};\n    }\n\n    if (row.uid) {\n      this.rowsByUid[page][row.uid] = row;\n    }\n\n    this.objIdxByUid[page][row.uid] = index;\n  };\n\n  GroupLazyLoadRenderer.prototype.confirmRowRendering = function (row) {\n    var check = true;\n\n    if (isNullOrUndefined(row.indent) && !row.isDataRow && !row.isCaptionRow) {\n      var cap = this.getRowByUid(row.parentUid);\n\n      if (cap.isCaptionRow && !cap.isExpand) {\n        check = false;\n      }\n    }\n\n    return check;\n  };\n\n  GroupLazyLoadRenderer.prototype.refreshRowObjects = function (newRows, index) {\n    var page = this.parent.pageSettings.currentPage;\n    var rowsObject = this.groupCache[page];\n    this.rowsByUid[page] = {};\n    this.objIdxByUid[page] = {};\n    var newRowsObject = [];\n    var k = 0;\n\n    for (var i = 0; i < rowsObject.length; i++) {\n      if (i === index) {\n        this.maintainRows(rowsObject[i], k);\n        newRowsObject.push(rowsObject[i]);\n        k++;\n\n        for (var j = 0; j < newRows.length; j++) {\n          this.maintainRows(newRows[j], k);\n          newRowsObject.push(newRows[j]);\n          k++;\n        }\n      } else {\n        this.maintainRows(rowsObject[i], k);\n        newRowsObject.push(rowsObject[i]);\n        k++;\n      }\n    }\n\n    this.groupCache[this.parent.pageSettings.currentPage] = extend([], newRowsObject);\n    this.updateCurrentViewData();\n  };\n\n  GroupLazyLoadRenderer.prototype.getAggregateByCaptionIndex = function (index) {\n    var cache = this.groupCache[this.parent.pageSettings.currentPage];\n    var parent = cache[index];\n    var indent = parent.indent;\n    var uid = parent.uid;\n    var agg = [];\n\n    for (var i = index + 1; i < cache.length; i++) {\n      if (cache[i].indent === indent) {\n        break;\n      }\n\n      if (isNullOrUndefined(cache[i].indent) && cache[i].parentUid === uid) {\n        agg.push(cache[i]);\n      }\n    }\n\n    return agg;\n  };\n\n  GroupLazyLoadRenderer.prototype.getChildRowsByParentIndex = function (index, deep, block, data, includeAgg, includeCollapseAgg) {\n    var cache = data ? data : this.groupCache[this.parent.pageSettings.currentPage];\n    var parentRow = cache[index];\n    var agg = [];\n\n    if (!parentRow.isCaptionRow || parentRow.isCaptionRow && !parentRow.isExpand && !includeCollapseAgg) {\n      return [];\n    }\n\n    if (includeAgg && this.parent.aggregates.length) {\n      agg = this.getAggregateByCaptionIndex(index);\n    }\n\n    var indent = parentRow.indent;\n    var uid = parentRow.uid;\n    var rows = [];\n    var count = 0;\n\n    for (var i = index + 1; i < cache.length; i++) {\n      if (cache[i].parentUid === uid) {\n        if (isNullOrUndefined(cache[i].indent)) {\n          continue;\n        }\n\n        count++;\n        rows.push(cache[i]);\n\n        if (deep && cache[i].isCaptionRow) {\n          rows = rows.concat(this.getChildRowsByParentIndex(i, deep, block, data, includeAgg));\n        }\n\n        if (block && count === this.pageSize) {\n          break;\n        }\n      }\n\n      if (cache[i].indent === indent) {\n        break;\n      }\n    }\n\n    return rows.concat(agg);\n  };\n  /** @hidden */\n\n\n  GroupLazyLoadRenderer.prototype.initialGroupRows = function (isReorder) {\n    var rows = [];\n    var cache = this.groupCache[this.parent.pageSettings.currentPage];\n\n    if (isReorder) {\n      return this.getRenderedRowsObject();\n    }\n\n    for (var i = 0; i < cache.length; i++) {\n      if (cache[i].indent === 0) {\n        rows.push(cache[i]);\n        rows = rows.concat(this.getChildRowsByParentIndex(i, true, true, cache, true));\n      }\n    }\n\n    return rows;\n  };\n  /** @hidden */\n\n\n  GroupLazyLoadRenderer.prototype.getRenderedRowsObject = function () {\n    var rows = [];\n    var trs = [].slice.call(this.parent.getContent().querySelectorAll('tr'));\n\n    for (var i = 0; i < trs.length; i++) {\n      rows.push(this.getRowByUid(trs[i].getAttribute('data-uid')));\n    }\n\n    return rows;\n  };\n\n  GroupLazyLoadRenderer.prototype.getCacheRowsOnDownScroll = function (index) {\n    var rows = [];\n    var rowsObject = this.groupCache[this.parent.pageSettings.currentPage];\n    var k = index;\n\n    for (var i = 0; i < this.pageSize; i++) {\n      if (!rowsObject[k] || rowsObject[k].indent < rowsObject[index].indent) {\n        break;\n      }\n\n      if (rowsObject[k].indent === rowsObject[index].indent) {\n        rows.push(rowsObject[k]);\n\n        if (rowsObject[k].isCaptionRow && rowsObject[k].isExpand) {\n          rows = rows.concat(this.getChildRowsByParentIndex(k, true, true, null, true));\n        }\n      }\n\n      if (rowsObject[k].indent > rowsObject[index].indent || isNullOrUndefined(rowsObject[k].indent)) {\n        i--;\n      }\n\n      k++;\n    }\n\n    return rows;\n  };\n\n  GroupLazyLoadRenderer.prototype.getCacheRowsOnUpScroll = function (start, end, index) {\n    var rows = [];\n    var rowsObject = this.groupCache[this.parent.pageSettings.currentPage];\n    var str = false;\n\n    for (var i = 0; i < rowsObject.length; i++) {\n      if (str && (!rowsObject[i] || rowsObject[i].indent < rowsObject[index].indent || rowsObject[i].uid === end)) {\n        break;\n      }\n\n      if (!str && rowsObject[i].uid === start) {\n        str = true;\n      }\n\n      if (str && rowsObject[i].indent === rowsObject[index].indent) {\n        rows.push(rowsObject[i]);\n\n        if (rowsObject[i].isCaptionRow && rowsObject[i].isExpand) {\n          rows = rows.concat(this.getChildRowsByParentIndex(i, true, true, null, true));\n        }\n      }\n    }\n\n    return rows;\n  };\n\n  GroupLazyLoadRenderer.prototype.scrollHandler = function (e) {\n    if (this.parent.isDestroyed || this.childCount) {\n      return;\n    }\n\n    var downTrs = [].slice.call(this.parent.getContent().querySelectorAll('.e-lazyload-middle-down'));\n    var upTrs = [].slice.call(this.parent.getContent().querySelectorAll('.e-lazyload-middle-up'));\n    var endTrs = [].slice.call(this.parent.getContent().querySelectorAll('.e-not-lazyload-end'));\n    var tr;\n    var lazyLoadDown = false;\n    var lazyLoadUp = false;\n    var lazyLoadEnd = false;\n\n    if (e.scrollDown && downTrs.length) {\n      var result = this.findRowElements(downTrs);\n      tr = result.tr;\n      lazyLoadDown = result.entered;\n    }\n\n    if (!e.scrollDown && endTrs) {\n      for (var i = 0; i < endTrs.length; i++) {\n        var top_1 = endTrs[i].getBoundingClientRect().top;\n        var scrollHeight = this.parent.getContent().scrollHeight;\n\n        if (top_1 > 0 && top_1 < scrollHeight) {\n          tr = endTrs[i];\n          lazyLoadEnd = true;\n          this.rowIndex = tr.rowIndex;\n          break;\n        }\n      }\n    }\n\n    if (!e.scrollDown && upTrs.length && !lazyLoadEnd) {\n      var result = this.findRowElements(upTrs);\n      tr = result.tr;\n      lazyLoadUp = result.entered;\n    }\n\n    if (tr) {\n      if (lazyLoadDown && e.scrollDown && lazyLoadDown && tr) {\n        this.scrollDownHandler(tr);\n      }\n\n      if (!e.scrollDown && lazyLoadEnd && tr) {\n        this.scrollUpEndRowHandler(tr);\n      }\n\n      if (this.cacheMode && !e.scrollDown && !lazyLoadEnd && lazyLoadUp && tr) {\n        this.scrollUpHandler(tr);\n      }\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.scrollUpEndRowHandler = function (tr) {\n    var page = this.parent.pageSettings.currentPage;\n    var rows = this.groupCache[page];\n    var uid = tr.getAttribute('data-uid');\n    var index = this.rowObjectIndex = this.getRowObjectIndexByUid(uid);\n    var idx = index;\n    var childRow = rows[index];\n    var parentCapRow = this.getRowByUid(childRow.parentUid);\n    var capRowObjIdx = this.getRowObjectIndexByUid(parentCapRow.uid);\n    var captionRowEle = this.parent.getContent().querySelector('tr[data-uid=' + parentCapRow.uid + ']');\n    var capRowEleIndex = captionRowEle.rowIndex;\n    var child = this.getChildRowsByParentIndex(capRowObjIdx);\n    var childIdx = child.indexOf(childRow);\n    var currentPage = Math.ceil(childIdx / this.pageSize);\n\n    if (currentPage === 1) {\n      return;\n    }\n\n    this.childCount = currentPage * this.pageSize;\n    index = this.getCurrentBlockEndIndex(childRow, index);\n\n    if (this.childCount < parentCapRow.data.count) {\n      tr.classList.remove('e-not-lazyload-end');\n      childRow.lazyLoadCssClass = '';\n      var isRowExist = rows[index + 1] ? childRow.indent === rows[index + 1].indent : false;\n      this.scrollData = isRowExist ? this.getCacheRowsOnDownScroll(index + 1) : [];\n      var key = this.getGroupKeysAndFields(capRowObjIdx, rows);\n      var args = {\n        rowIndex: capRowEleIndex,\n        makeRequest: !isRowExist,\n        groupInfo: parentCapRow,\n        fields: key.fields,\n        keys: key.keys,\n        skip: this.childCount,\n        take: this.pageSize,\n        isScroll: true\n      };\n\n      if (this.cacheMode && this.childCount >= this.pageSize * this.cacheBlockSize) {\n        var child_1 = this.getChildRowsByParentIndex(capRowObjIdx);\n        var currenBlock = Math.ceil(child_1.indexOf(rows[idx]) / this.pageSize);\n        var removeBlock = currenBlock - (this.cacheBlockSize - 1);\n        this.removeBlock(uid, isRowExist, removeBlock, child_1);\n        args.cachedRowIndex = removeBlock * this.pageSize;\n      }\n\n      this.captionRowExpand(args);\n    } else {\n      this.childCount = 0;\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.scrollDownHandler = function (tr) {\n    var page = this.parent.pageSettings.currentPage;\n    var rows = this.groupCache[page];\n    var uid = tr.getAttribute('data-uid');\n    var index = this.getRowObjectIndexByUid(uid);\n    var idx = index;\n    var childRow = rows[index];\n    var parentCapRow = this.getRowByUid(childRow.parentUid);\n    var capRowObjIdx = this.getRowObjectIndexByUid(parentCapRow.uid);\n    var captionRowEle = this.getRowElementByUid(parentCapRow.uid);\n    var capRowEleIndex = captionRowEle.rowIndex;\n    var child = this.getChildRowsByParentIndex(capRowObjIdx);\n    var childIdx = child.indexOf(childRow);\n    var currentPage = Math.ceil(childIdx / this.pageSize);\n    this.childCount = currentPage * this.pageSize;\n    index = this.rowObjectIndex = this.getRowObjectIndexByUid(child[this.childCount - 1].uid);\n    var lastchild = rows[index];\n    var lastRow = this.getRowElementByUid(lastchild.uid);\n    this.rowIndex = lastRow.rowIndex;\n    index = this.getCurrentBlockEndIndex(lastchild, index);\n\n    if (this.childCount < parentCapRow.data.count) {\n      var isRowExist = rows[index + 1] ? childRow.indent === rows[index + 1].indent : false;\n\n      if (isRowExist && !isNullOrUndefined(this.getRowElementByUid(rows[index + 1].uid))) {\n        this.childCount = 0;\n        return;\n      }\n\n      if (currentPage > 1 || !this.cacheMode) {\n        tr.classList.remove('e-lazyload-middle-down');\n        lastRow.classList.remove('e-not-lazyload-end');\n        lastchild.lazyLoadCssClass = '';\n      }\n\n      this.scrollData = isRowExist ? this.getCacheRowsOnDownScroll(this.rowObjectIndex + 1) : [];\n      var query = this.getGroupKeysAndFields(capRowObjIdx, rows);\n      var args = {\n        rowIndex: capRowEleIndex,\n        makeRequest: !isRowExist,\n        groupInfo: parentCapRow,\n        fields: query.fields,\n        keys: query.keys,\n        skip: this.childCount,\n        take: this.pageSize,\n        isScroll: true\n      };\n\n      if (this.cacheMode && this.childCount - this.pageSize >= this.pageSize * this.cacheBlockSize) {\n        var child_2 = this.getChildRowsByParentIndex(capRowObjIdx);\n        var currenBlock = Math.ceil(child_2.indexOf(rows[idx]) / this.pageSize) - 1;\n        var removeBlock = currenBlock - (this.cacheBlockSize - 1) + 1;\n        this.removeBlock(uid, isRowExist, removeBlock, child_2, lastchild);\n        args.cachedRowIndex = removeBlock * this.pageSize;\n      }\n\n      this.captionRowExpand(args);\n    } else {\n      this.childCount = 0;\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.getCurrentBlockEndIndex = function (row, index) {\n    var page = this.parent.pageSettings.currentPage;\n    var rows = this.groupCache[page];\n\n    if (row.isCaptionRow) {\n      if (row.isExpand) {\n        var childCount = this.getChildRowsByParentIndex(index, true).length;\n        this.rowIndex = this.rowIndex + childCount;\n      }\n\n      var agg = this.getAggregateByCaptionIndex(index);\n      this.rowObjectIndex = this.rowObjectIndex + agg.length;\n      var idx = index;\n\n      for (var i = idx + 1; i < rows.length; i++) {\n        if (rows[i].indent === rows[index].indent || rows[i].indent < rows[index].indent) {\n          index = idx;\n          break;\n        } else {\n          idx++;\n        }\n      }\n    }\n\n    return index;\n  };\n\n  GroupLazyLoadRenderer.prototype.removeBlock = function (uid, isRowExist, removeBlock, child, lastchild) {\n    var page = this.parent.pageSettings.currentPage;\n    var rows = this.groupCache[page];\n    var uid1 = child[(removeBlock + 1) * this.pageSize - 1 - this.blockSize].uid;\n    var uid2 = child[removeBlock * this.pageSize - this.pageSize].uid;\n    var uid3 = child[removeBlock * this.pageSize].uid;\n    var firstIdx = this.getRowObjectIndexByUid(uid1);\n    rows[firstIdx].lazyLoadCssClass = 'e-lazyload-middle-up';\n    this.getRowElementByUid(uid1).classList.add('e-lazyload-middle-up');\n\n    if (lastchild) {\n      this.getRowElementByUid(uid3).classList.add('e-not-lazyload-first');\n      this.getRowByUid(uid3).lazyLoadCssClass = 'e-not-lazyload-first';\n      this.getRowByUid(uid2).lazyLoadCssClass = '';\n    }\n\n    if (isRowExist) {\n      this.removeTopRows(lastchild ? lastchild.uid : uid, uid2, uid3);\n    } else {\n      this.uid1 = uid2;\n      this.uid2 = uid3;\n      this.uid3 = lastchild ? lastchild.uid : uid;\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.scrollUpHandler = function (tr) {\n    var page = this.parent.pageSettings.currentPage;\n    var rows = this.groupCache[page];\n    var uid = tr.getAttribute('data-uid');\n    var row = this.getRowByUid(uid);\n    var index = this.rowObjectIndex = this.getRowObjectIndexByUid(uid);\n    var parentCapRow = this.getRowByUid(row.parentUid);\n    var capRowObjIdx = this.rowIndex = this.getRowObjectIndexByUid(parentCapRow.uid);\n    var captionRowEle = this.parent.getRowElementByUID(parentCapRow.uid);\n    var capRowEleIndex = captionRowEle.rowIndex;\n    var child = this.getChildRowsByParentIndex(capRowObjIdx);\n    var childIdx = child.indexOf(rows[index]);\n    var currenBlock = Math.floor(childIdx / this.pageSize);\n    var idx = this.blockSize;\n\n    if (this.blockSize * 2 > this.pageSize) {\n      idx = this.blockSize * 2 - this.pageSize;\n      idx = this.blockSize - idx;\n    }\n\n    var start = child[childIdx - (idx - 1) - this.pageSize].uid;\n    var end = child[childIdx - (idx - 1)].uid;\n    this.scrollData = this.getCacheRowsOnUpScroll(start, end, index - (idx - 1));\n    this.isFirstChildRow = currenBlock > 1;\n\n    if (this.isFirstChildRow) {\n      this.scrollData[0].lazyLoadCssClass = 'e-not-lazyload-first';\n    }\n\n    this.getRowByUid(end).lazyLoadCssClass = '';\n    this.getRowElementByUid(end).classList.remove('e-not-lazyload-first');\n    var removeBlock = currenBlock + this.cacheBlockSize;\n\n    if (child.length !== parentCapRow.data.count && removeBlock * this.pageSize > child.length) {\n      this.isFirstChildRow = false;\n      this.scrollData[0].lazyLoadCssClass = '';\n      this.getRowElementByUid(end).classList.add('e-not-lazyload-first');\n      return;\n    }\n\n    var count = removeBlock * this.pageSize > parentCapRow.data.count ? parentCapRow.data.count : removeBlock * this.pageSize;\n    var size = removeBlock * this.pageSize > parentCapRow.data.count ? this.pageSize - (this.pageSize * removeBlock - parentCapRow.data.count) : this.pageSize;\n    var childRows = this.getChildRowsByParentIndex(rows.indexOf(child[count - 1]), true, false, null, true);\n    var uid1 = childRows.length ? childRows[childRows.length - 1].uid : child[count - 1].uid;\n    var uid2 = child[count - size].uid;\n    var uid3 = child[count - size - 1].uid;\n    var lastIdx = this.objIdxByUid[page][uid2] - idx;\n\n    if (rows[lastIdx].lazyLoadCssClass === 'e-lazyload-middle-down') {\n      var trEle = this.getRowElementByUid(rows[lastIdx].uid);\n\n      if (trEle) {\n        trEle.classList.add('e-lazyload-middle-down');\n      }\n    }\n\n    this.getRowByUid(uid1).lazyLoadCssClass = '';\n    this.getRowByUid(uid3).lazyLoadCssClass = 'e-not-lazyload-end';\n    this.getRowElementByUid(uid3).classList.add('e-not-lazyload-end');\n    this.removeBottomRows(uid1, uid2, uid3);\n    this.rowIndex = tr.rowIndex - idx;\n    tr.classList.length > 1 ? tr.classList.remove('e-lazyload-middle-up') : tr.removeAttribute('class');\n\n    if (!isNullOrUndefined(this.getRowElementByUid(start))) {\n      this.childCount = 0;\n      this.scrollData = [];\n      return;\n    }\n\n    var key = this.getGroupKeysAndFields(this.getRowObjectIndexByUid(parentCapRow.uid), rows);\n    var args = {\n      rowIndex: capRowEleIndex,\n      makeRequest: false,\n      groupInfo: parentCapRow,\n      fields: key.fields,\n      keys: key.keys,\n      skip: this.childCount,\n      take: this.pageSize,\n      isScroll: true,\n      scrollUp: true\n    };\n    this.captionRowExpand(args);\n  };\n\n  GroupLazyLoadRenderer.prototype.findRowElements = function (rows) {\n    var entered = false;\n    var tr;\n\n    for (var i = 0; i < rows.length; i++) {\n      var rowIdx = rows[i].rowIndex;\n\n      if (isRowEnteredInGrid(rowIdx, this.parent)) {\n        entered = true;\n        this.rowIndex = rowIdx;\n        tr = rows[i];\n        break;\n      }\n    }\n\n    return {\n      entered: entered,\n      tr: tr\n    };\n  };\n\n  GroupLazyLoadRenderer.prototype.getRowElementByUid = function (uid) {\n    return this.parent.getContent().querySelector('tr[data-uid=' + uid + ']');\n  };\n\n  GroupLazyLoadRenderer.prototype.removeTopRows = function (uid1, uid2, uid3) {\n    var trs = [].slice.call(this.parent.getContent().querySelectorAll('tr'));\n    var page = this.parent.pageSettings.currentPage;\n    var start = false;\n\n    for (var i = 0; i < trs.length; i++) {\n      if (trs[i].getAttribute('data-uid') === uid3) {\n        var tr = this.parent.getContent().querySelector('tr[data-uid=' + uid1 + ']');\n\n        if (tr) {\n          this.rowIndex = tr.rowIndex;\n        }\n\n        break;\n      }\n\n      if (trs[i].getAttribute('data-uid') === uid2) {\n        start = true;\n      }\n\n      if (start) {\n        remove(trs[i]);\n      }\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.removeBottomRows = function (uid1, uid2, uid3) {\n    var trs = [].slice.call(this.parent.getContent().querySelectorAll('tr'));\n    var start = false;\n\n    for (var i = 0; i < trs.length; i++) {\n      if (trs[i].getAttribute('data-uid') === uid2) {\n        start = true;\n      }\n\n      if (start) {\n        remove(trs[i]);\n\n        if (trs[i].getAttribute('data-uid') === uid1) {\n          break;\n        }\n      }\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.setCache = function (e) {\n    var page = this.parent.pageSettings.currentPage;\n    this.groupCache[page] = this.initialGroupCaptions[page] = extend([], e.data);\n  };\n\n  GroupLazyLoadRenderer.prototype.getGroupKeysAndFields = function (index, rowsObject) {\n    var fields = [];\n    var keys = [];\n\n    for (var i = index; i >= 0; i--) {\n      if (rowsObject[i].isCaptionRow && fields.indexOf(rowsObject[i].data.field) === -1 && (rowsObject[i].indent < rowsObject[index].indent || i === index)) {\n        fields.push(rowsObject[i].data.field);\n        keys.push(rowsObject[i].data.key);\n\n        if (rowsObject[i].indent === 0) {\n          break;\n        }\n      }\n    }\n\n    return {\n      fields: fields,\n      keys: keys\n    };\n  };\n\n  GroupLazyLoadRenderer.prototype.generateExpandPredicates = function (fields, values) {\n    var filterCols = [];\n\n    for (var i = 0; i < fields.length; i++) {\n      var column = this.parent.getColumnByField(fields[i]);\n      var value = values[i] === 'null' ? null : values[i];\n      var pred = {\n        field: fields[i],\n        predicate: 'or',\n        uid: column.uid,\n        operator: 'equal',\n        type: column.type,\n        matchCase: this.allowCaseSensitive,\n        ignoreAccent: this.ignoreAccent\n      };\n\n      if (value === '' || isNullOrUndefined(value)) {\n        filterCols = filterCols.concat(CheckBoxFilterBase.generateNullValuePredicates(pred));\n      } else {\n        filterCols.push(extend({}, {\n          value: value\n        }, pred));\n      }\n    }\n\n    return CheckBoxFilterBase.getPredicate(filterCols);\n  };\n\n  GroupLazyLoadRenderer.prototype.getPredicates = function (pred) {\n    var predicateList = [];\n\n    for (var _i = 0, _a = Object.keys(pred); _i < _a.length; _i++) {\n      var prop = _a[_i];\n      predicateList.push(pred[prop]);\n    }\n\n    return predicateList;\n  };\n\n  GroupLazyLoadRenderer.prototype.captionRowExpand = function (args) {\n    var _this = this;\n\n    var captionRow = args.groupInfo;\n    var level = this.parent.groupSettings.columns.indexOf(captionRow.data.field) + 1;\n    var pred = this.generateExpandPredicates(args.fields, args.keys);\n    var predicateList = this.getPredicates(pred);\n    var lazyLoad = {\n      level: level,\n      skip: args.skip,\n      take: args.take,\n      where: predicateList\n    };\n\n    if (args.makeRequest) {\n      var query = this.parent.renderModule.data.generateQuery(true);\n\n      if (!query.isCountRequired) {\n        query.isCountRequired = true;\n      }\n\n      query.lazyLoad.push({\n        key: 'onDemandGroupInfo',\n        value: lazyLoad\n      });\n      this.parent.showSpinner();\n      this.parent.renderModule.data.getData({}, query).then(function (e) {\n        _this.parent.hideSpinner();\n\n        if (e.result.length === 0) {\n          return;\n        }\n\n        if (_this.cacheMode && _this.uid1 && _this.uid2) {\n          _this.removeTopRows(_this.uid3, _this.uid1, _this.uid2);\n\n          _this.uid1 = _this.uid2 = _this.uid3 = undefined;\n        }\n\n        _this.lazyLoadHandler({\n          data: e.result,\n          count: e.count,\n          level: level,\n          index: args.rowIndex,\n          isRowExist: false,\n          isScroll: args.isScroll,\n          up: false,\n          rowIndex: args.cachedRowIndex\n        });\n      }).catch(function (e) {\n        return _this.parent.renderModule.dataManagerFailure(e, {\n          requestType: 'grouping'\n        });\n      });\n    } else {\n      this.lazyLoadHandler({\n        data: null,\n        count: args.groupInfo.data.count,\n        level: level,\n        index: args.rowIndex,\n        isRowExist: true,\n        isScroll: args.isScroll,\n        up: args.scrollUp,\n        rowIndex: args.cachedRowIndex\n      });\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.scrollReset = function (top) {\n    this.parent.getContent().firstElementChild.scrollTop = top ? this.parent.getContent().firstElementChild.scrollTop + top : 0;\n  };\n\n  GroupLazyLoadRenderer.prototype.updateCurrentViewData = function () {\n    var records = [];\n    this.getRows().filter(function (row) {\n      if (row.isDataRow) {\n        records[row.index] = row.data;\n      }\n    });\n    this.parent.currentViewData = records.length ? records : this.parent.currentViewData;\n  };\n  /** @hidden */\n\n\n  GroupLazyLoadRenderer.prototype.getGroupCache = function () {\n    return this.groupCache;\n  };\n  /** @hidden */\n\n\n  GroupLazyLoadRenderer.prototype.getRows = function () {\n    return this.groupCache[this.parent.pageSettings.currentPage] || [];\n  };\n  /** @hidden */\n\n\n  GroupLazyLoadRenderer.prototype.getRowElements = function () {\n    return [].slice.call(this.parent.getContent().querySelectorAll('.e-row'));\n  };\n  /** @hidden */\n\n\n  GroupLazyLoadRenderer.prototype.getRowByIndex = function (index) {\n    var tr = [].slice.call(this.parent.getContent().querySelectorAll('.e-row'));\n    var row;\n\n    for (var i = 0; !isNullOrUndefined(index) && i < tr.length; i++) {\n      if (tr[i].getAttribute('aria-rowindex') === index.toString()) {\n        row = tr[i];\n        break;\n      }\n    }\n\n    return row;\n  };\n  /** @hidden */\n\n\n  GroupLazyLoadRenderer.prototype.setVisible = function (columns) {\n    var gObj = this.parent;\n    var rows = this.getRows();\n    var testRow;\n    rows.some(function (r) {\n      if (r.isDataRow) {\n        testRow = r;\n      }\n\n      return r.isDataRow;\n    });\n    var contentrows = this.getRows().filter(function (row) {\n      return !row.isDetailRow;\n    });\n\n    for (var i = 0; i < columns.length; i++) {\n      var column = columns[i];\n      var idx = this.parent.getNormalizedColumnIndex(column.uid);\n      var colIdx = this.parent.getColumnIndexByUid(column.uid);\n      var displayVal = column.visible === true ? '' : 'none';\n\n      if (idx !== -1 && testRow && idx < testRow.cells.length) {\n        setStyleAttribute(this.getColGroup().childNodes[idx], {\n          'display': displayVal\n        });\n      }\n\n      this.setDisplayNone(gObj.getDataRows(), colIdx, displayVal, contentrows, idx);\n\n      if (!this.parent.invokedFromMedia && column.hideAtMedia) {\n        this.parent.updateMediaColumns(column);\n      }\n\n      this.parent.invokedFromMedia = false;\n    }\n  };\n  /** @hidden */\n\n\n  GroupLazyLoadRenderer.prototype.setDisplayNone = function (tr, idx, displayVal, rows, oriIdx) {\n    var trs = Object.keys(tr);\n\n    if (!this.parent.groupSettings.columns.length) {\n      for (var i = 0; i < trs.length; i++) {\n        var td = tr[trs[i]].querySelectorAll('td.e-rowcell')[idx];\n\n        if (tr[trs[i]].querySelectorAll('td.e-rowcell').length && td) {\n          setStyleAttribute(tr[trs[i]].querySelectorAll('td.e-rowcell')[idx], {\n            'display': displayVal\n          });\n\n          if (tr[trs[i]].querySelectorAll('td.e-rowcell')[idx].classList.contains('e-hide')) {\n            removeClass([tr[trs[i]].querySelectorAll('td.e-rowcell')[idx]], ['e-hide']);\n          }\n\n          rows[trs[i]].cells[idx].visible = displayVal === '' ? true : false;\n        }\n      }\n    } else {\n      var keys = Object.keys(this.groupCache);\n\n      for (var j = 0; j < keys.length; j++) {\n        var uids = this.rowsByUid[keys[j]];\n        var idxs = Object.keys(uids);\n\n        for (var i = 0; i < idxs.length; i++) {\n          var tr_1 = this.parent.getContent().querySelector('tr[data-uid=' + idxs[i] + ']');\n          var row = uids[idxs[i]];\n\n          if (row.isCaptionRow) {\n            if (!this.captionModelGen.isEmpty()) {\n              this.changeCaptionRow(row, tr_1, keys[j]);\n            } else {\n              row.cells[row.indent + 1].colSpan = displayVal === '' ? row.cells[row.indent + 1].colSpan + 1 : row.cells[row.indent + 1].colSpan - 1;\n\n              if (tr_1) {\n                tr_1.cells[row.indent + 1].colSpan = row.cells[row.indent + 1].colSpan;\n              }\n            }\n          }\n\n          if (row.isDataRow) {\n            this.showAndHideCells(tr_1, idx, displayVal, false);\n            row.cells[oriIdx].visible = displayVal === '' ? true : false;\n          }\n\n          if (!row.isCaptionRow && !row.isDataRow && isNullOrUndefined(row.indent)) {\n            row.cells[oriIdx].visible = displayVal === '' ? true : false;\n            row.visible = row.cells.some(function (cell) {\n              return cell.isDataCell && cell.visible;\n            });\n            this.showAndHideCells(tr_1, idx, displayVal, true, row);\n          }\n        }\n      }\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.changeCaptionRow = function (row, tr, index) {\n    var capRow = row;\n    var captionData = row.data;\n    var data = this.groupGenerator.generateCaptionRow(captionData, capRow.indent, capRow.parentGid, undefined, capRow.tIndex, capRow.parentUid);\n    data.uid = row.uid;\n    data.isExpand = row.isExpand;\n    data.lazyLoadCssClass = row.lazyLoadCssClass;\n    this.rowsByUid[index][row.uid] = data;\n    this.groupCache[index][this.objIdxByUid[index][row.uid]] = data;\n\n    if (tr) {\n      var tbody = this.parent.getContentTable().querySelector('tbody');\n      tbody.replaceChild(this.rowRenderer.render(data, this.parent.getColumns()), tr);\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.showAndHideCells = function (tr, idx, displayVal, isSummary, row) {\n    if (tr) {\n      var cls = isSummary ? 'td.e-summarycell' : 'td.e-rowcell';\n      setStyleAttribute(tr.querySelectorAll(cls)[idx], {\n        'display': displayVal\n      });\n\n      if (tr.querySelectorAll(cls)[idx].classList.contains('e-hide')) {\n        removeClass([tr.querySelectorAll(cls)[idx]], ['e-hide']);\n      }\n\n      if (isSummary) {\n        if (row.visible && tr.classList.contains('e-hide')) {\n          removeClass([tr], ['e-hide']);\n        } else if (!row.visible) {\n          addClass([tr], ['e-hide']);\n        }\n      }\n    }\n  };\n\n  return GroupLazyLoadRenderer;\n}(ContentRender);\n\nexport { GroupLazyLoadRenderer };","map":{"version":3,"sources":["C:/Users/appsk/Documents/Projects/PredictiveMaintenance/React PDM/env/frontend/node_modules/@syncfusion/ej2-grids/src/grid/renderer/group-lazy-load-renderer.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","extend","remove","isNullOrUndefined","setStyleAttribute","removeClass","addClass","ContentRender","events","isRowEnteredInGrid","parentsUntil","RowRenderer","CheckBoxFilterBase","GroupModelGenerator","GroupSummaryModelGenerator","CaptionSummaryModelGenerator","GroupLazyLoadRenderer","_super","parent","locator","_this","call","childCount","scrollData","isFirstChildRow","groupCache","startIndexes","captionCounts","rowsByUid","objIdxByUid","initialGroupCaptions","requestType","cacheMode","cacheBlockSize","ignoreAccent","allowFiltering","filterSettings","allowCaseSensitive","groupGenerator","summaryModelGen","captionModelGen","rowRenderer","eventListener","addEventListener","actionBegin","bind","actionComplete","on","initialEnd","setLazyLoadPageSize","setGroupCache","setCache","lazyLoadScrollHandler","scrollHandler","columnVisibilityChanged","setVisible","groupCollapse","collapseShortcut","captionExpand","tr","page","pageSettings","currentPage","rowsObject","uid","getAttribute","oriIndex","getRowObjectIndexByUid","isRowExist","indent","data","key","getGroupKeysAndFields","e","captionRowElement","groupInfo","enableCaching","cancel","trigger","lazyLoadGroupExpand","args","keys","fields","rowIndex","makeRequest","clearCache","skip","take","pageSize","isExpand","captionRowExpand","captionCollapse","cache","rowIdx","captionIndex","lazyLoadGroupCollapse","removeRows","scrollEle","getContent","firstElementChild","blockSize","Math","floor","offsetHeight","getRowHeight","ceil","clearLazyGroupCache","uids","getInitialCaptionIndexes","length","i","capIdx","capRow","i_1","isCaptionRow","getRowElementByUID","groupModule","expandCollapseRows","querySelector","child","getNextChilds","subChild","getChildRowsByParentIndex","indexOf","start","end","splice","refreshCaches","maintainRows","push","groupSettings","columns","target","parentElement","tagName","collapse","row","rowObj","getRowByUid","parentUid","capEle","getRowElementByUid","cells","some","value","resetRowMaintenance","j","isEmpty","changeCaptionRow","isDataRow","from","fromIndex","to","toIndex","moveCells","action","scrollReset","arr","k","undefined","idx","trIdx","rows","trs","slice","querySelectorAll","aggUid","aggregates","agg","getAggregateByCaptionIndex","capUid","last","lazyLoadCssClass","index","rowObjects","group","childRows","lazyLoadHandler","setStartIndexes","captionRow","isScroll","setRowIndexes","refreshCaptionRowCount","count","generateCaptionRow","level","parentGid","concat","generateRows","getStartIndex","generateDataRows","nxtChild","lastRow","up","hasLastChildRow","refreshRowObjects","rowObjectIndex","render","scrollTop","prevCapRow","prevCaptionCount","indexes","captionCount","rowCount","isLastRow","insertAdjacentElement","getColumns","confirmRowRendering","check","cap","newRows","newRowsObject","updateCurrentViewData","deep","block","includeAgg","includeCollapseAgg","parentRow","initialGroupRows","isReorder","getRenderedRowsObject","getCacheRowsOnDownScroll","getCacheRowsOnUpScroll","str","isDestroyed","downTrs","upTrs","endTrs","lazyLoadDown","lazyLoadUp","lazyLoadEnd","scrollDown","result","findRowElements","entered","top_1","getBoundingClientRect","top","scrollHeight","scrollDownHandler","scrollUpEndRowHandler","scrollUpHandler","childRow","parentCapRow","capRowObjIdx","captionRowEle","capRowEleIndex","childIdx","getCurrentBlockEndIndex","classList","child_1","currenBlock","removeBlock","cachedRowIndex","lastchild","query","child_2","uid1","uid2","uid3","firstIdx","add","removeTopRows","size","lastIdx","trEle","removeBottomRows","removeAttribute","scrollUp","field","generateExpandPredicates","values","filterCols","column","getColumnByField","pred","predicate","operator","type","matchCase","generateNullValuePredicates","getPredicate","getPredicates","predicateList","_i","_a","prop","lazyLoad","where","renderModule","generateQuery","isCountRequired","showSpinner","getData","then","hideSpinner","catch","dataManagerFailure","records","getRows","filter","currentViewData","getGroupCache","getRowElements","getRowByIndex","toString","gObj","testRow","r","contentrows","isDetailRow","getNormalizedColumnIndex","colIdx","getColumnIndexByUid","displayVal","visible","getColGroup","childNodes","setDisplayNone","getDataRows","invokedFromMedia","hideAtMedia","updateMediaColumns","oriIdx","td","contains","idxs","tr_1","colSpan","showAndHideCells","cell","isDataCell","captionData","tIndex","tbody","getContentTable","replaceChild","isSummary","cls"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { extend, remove, isNullOrUndefined, setStyleAttribute, removeClass, addClass } from '@syncfusion/ej2-base';\nimport { ContentRender } from './content-renderer';\nimport * as events from '../base/constant';\nimport { isRowEnteredInGrid, parentsUntil } from '../base/util';\nimport { RowRenderer } from '../renderer/row-renderer';\nimport { CheckBoxFilterBase } from '../common/checkbox-filter-base';\nimport { GroupModelGenerator } from '../services/group-model-generator';\nimport { GroupSummaryModelGenerator, CaptionSummaryModelGenerator } from '../services/summary-model-generator';\n/**\n * GroupLazyLoadRenderer is used to perform lazy load grouping\n * @hidden\n */\nvar GroupLazyLoadRenderer = /** @class */ (function (_super) {\n    __extends(GroupLazyLoadRenderer, _super);\n    function GroupLazyLoadRenderer(parent, locator) {\n        var _this = _super.call(this, parent, locator) || this;\n        _this.childCount = 0;\n        _this.scrollData = [];\n        _this.isFirstChildRow = false;\n        _this.groupCache = {};\n        _this.startIndexes = {};\n        _this.captionCounts = {};\n        _this.rowsByUid = {};\n        _this.objIdxByUid = {};\n        _this.initialGroupCaptions = {};\n        _this.requestType = ['paging', 'columnstate', 'reorder', 'cancel', 'save', 'beginEdit', 'add', 'delete'];\n        /** @hidden */\n        _this.cacheMode = false;\n        /** @hidden */\n        _this.cacheBlockSize = 5;\n        /** @hidden */\n        _this.ignoreAccent = _this.parent.allowFiltering ? _this.parent.filterSettings.ignoreAccent : false;\n        /** @hidden */\n        _this.allowCaseSensitive = false;\n        _this.locator = locator;\n        _this.groupGenerator = new GroupModelGenerator(_this.parent);\n        _this.summaryModelGen = new GroupSummaryModelGenerator(_this.parent);\n        _this.captionModelGen = new CaptionSummaryModelGenerator(_this.parent);\n        _this.rowRenderer = new RowRenderer(_this.locator, null, _this.parent);\n        _this.eventListener();\n        return _this;\n    }\n    GroupLazyLoadRenderer.prototype.eventListener = function () {\n        this.parent.addEventListener(events.actionBegin, this.actionBegin.bind(this));\n        this.parent.addEventListener(events.actionComplete, this.actionComplete.bind(this));\n        this.parent.on(events.initialEnd, this.setLazyLoadPageSize, this);\n        this.parent.on(events.setGroupCache, this.setCache, this);\n        this.parent.on(events.lazyLoadScrollHandler, this.scrollHandler, this);\n        this.parent.on(events.columnVisibilityChanged, this.setVisible, this);\n        this.parent.on(events.groupCollapse, this.collapseShortcut, this);\n    };\n    /** @hidden */\n    GroupLazyLoadRenderer.prototype.captionExpand = function (tr) {\n        var _this = this;\n        var page = this.parent.pageSettings.currentPage;\n        var rowsObject = this.groupCache[page];\n        var uid = tr.getAttribute('data-uid');\n        var oriIndex = this.getRowObjectIndexByUid(uid);\n        var isRowExist = rowsObject[oriIndex + 1] ? rowsObject[oriIndex].indent < rowsObject[oriIndex + 1].indent : false;\n        var data = rowsObject[oriIndex];\n        var key = this.getGroupKeysAndFields(oriIndex, rowsObject);\n        var e = { captionRowElement: tr, groupInfo: data, enableCaching: true, cancel: false };\n        this.parent.trigger(events.lazyLoadGroupExpand, e, function (args) {\n            if (args.cancel) {\n                return;\n            }\n            args.keys = key.keys;\n            args.fields = key.fields;\n            args.rowIndex = tr.rowIndex;\n            args.makeRequest = !args.enableCaching || !isRowExist;\n            if (!args.enableCaching && isRowExist) {\n                _this.clearCache([uid]);\n            }\n            args.skip = 0;\n            args.take = _this.pageSize;\n            data.isExpand = _this.rowsByUid[page][data.uid].isExpand = true;\n            _this.captionRowExpand(args);\n        });\n    };\n    /** @hidden */\n    GroupLazyLoadRenderer.prototype.captionCollapse = function (tr) {\n        var _this = this;\n        var cache = this.groupCache[this.parent.pageSettings.currentPage];\n        var rowIdx = tr.rowIndex;\n        var uid = tr.getAttribute('data-uid');\n        var captionIndex = this.getRowObjectIndexByUid(uid);\n        var e = {\n            captionRowElement: tr, groupInfo: cache[captionIndex], cancel: false\n        };\n        this.parent.trigger(events.lazyLoadGroupCollapse, e, function (args) {\n            if (args.cancel) {\n                return;\n            }\n            args.isExpand = false;\n            _this.removeRows(captionIndex, rowIdx);\n        });\n    };\n    /** @hidden */\n    GroupLazyLoadRenderer.prototype.setLazyLoadPageSize = function () {\n        var scrollEle = this.parent.getContent().firstElementChild;\n        var blockSize = Math.floor(scrollEle.offsetHeight / this.parent.getRowHeight()) - 1;\n        this.pageSize = this.pageSize ? this.pageSize : blockSize * 3;\n        this.blockSize = Math.ceil(this.pageSize / 2);\n    };\n    /** @hidden */\n    GroupLazyLoadRenderer.prototype.clearLazyGroupCache = function () {\n        this.clearCache();\n    };\n    GroupLazyLoadRenderer.prototype.clearCache = function (uids) {\n        uids = uids ? uids : this.getInitialCaptionIndexes();\n        var cache = this.groupCache[this.parent.pageSettings.currentPage];\n        if (uids.length) {\n            for (var i = 0; i < uids.length; i++) {\n                var capIdx = this.getRowObjectIndexByUid(uids[i]);\n                var capRow = cache[capIdx];\n                if (!capRow) {\n                    continue;\n                }\n                if (this.captionCounts[this.parent.pageSettings.currentPage][capRow.uid]) {\n                    for (var i_1 = capIdx + 1; i_1 < cache.length; i_1++) {\n                        if (cache[i_1].indent === capRow.indent || cache[i_1].indent < capRow.indent) {\n                            delete this.captionCounts[this.parent.pageSettings.currentPage][capRow.uid];\n                            break;\n                        }\n                        if (cache[i_1].isCaptionRow) {\n                            delete this.captionCounts[this.parent.pageSettings.currentPage][cache[i_1].uid];\n                        }\n                    }\n                }\n                if (capRow.isExpand) {\n                    var tr = this.parent.getRowElementByUID(capRow.uid);\n                    if (!tr) {\n                        return;\n                    }\n                    this.parent.groupModule.expandCollapseRows(tr.querySelector('.e-recordplusexpand'));\n                }\n                var child = this.getNextChilds(capIdx);\n                if (!child.length) {\n                    continue;\n                }\n                var subChild = [];\n                if (child[child.length - 1].isCaptionRow) {\n                    subChild = this.getChildRowsByParentIndex(cache.indexOf(child[child.length - 1]), false, false, null, true, true);\n                }\n                var start = cache.indexOf(child[0]);\n                var end = subChild.length ? cache.indexOf(subChild[subChild.length - 1]) : cache.indexOf(child[child.length - 1]);\n                cache.splice(start, end - (start - 1));\n                this.refreshCaches();\n            }\n        }\n    };\n    GroupLazyLoadRenderer.prototype.refreshCaches = function () {\n        var page = this.parent.pageSettings.currentPage;\n        var cache = this.groupCache[page];\n        this.rowsByUid = {};\n        this.objIdxByUid = {};\n        for (var i = 0; i < cache.length; i++) {\n            this.maintainRows(cache[i], i);\n        }\n    };\n    GroupLazyLoadRenderer.prototype.getInitialCaptionIndexes = function () {\n        var page = this.parent.pageSettings.currentPage;\n        var uids = [];\n        for (var i = 0; i < this.initialGroupCaptions[page].length; i++) {\n            uids.push(this.initialGroupCaptions[page][i].uid);\n        }\n        return uids;\n    };\n    /** @hidden */\n    GroupLazyLoadRenderer.prototype.getRowObjectIndexByUid = function (uid) {\n        return this.objIdxByUid[this.parent.pageSettings.currentPage][uid];\n    };\n    GroupLazyLoadRenderer.prototype.collapseShortcut = function (args) {\n        if (this.parent.groupSettings.columns.length &&\n            args.target && parentsUntil(args.target, 'e-content') && args.target.parentElement.tagName === 'TR') {\n            if (!args.collapse && parentsUntil(args.target, 'e-row')) {\n                return;\n            }\n            var row = args.target.parentElement;\n            var uid = row.getAttribute('data-uid');\n            if (args.collapse) {\n                var rowObj = this.getRowByUid(uid);\n                var capRow = this.getRowByUid(rowObj.parentUid);\n                if (capRow.isCaptionRow && capRow.isExpand) {\n                    var capEle = this.getRowElementByUid(rowObj.parentUid);\n                    this.parent.groupModule.expandCollapseRows(capEle.cells[rowObj.indent - 1]);\n                }\n            }\n            else {\n                var capRow = this.getRowByUid(uid);\n                if (capRow.isCaptionRow && !capRow.isExpand) {\n                    var capEle = this.getRowElementByUid(uid);\n                    this.parent.groupModule.expandCollapseRows(capEle.cells[capRow.indent]);\n                }\n            }\n        }\n    };\n    GroupLazyLoadRenderer.prototype.getRowByUid = function (uid) {\n        return this.rowsByUid[this.parent.pageSettings.currentPage][uid];\n    };\n    GroupLazyLoadRenderer.prototype.actionBegin = function (args) {\n        if (!args.cancel) {\n            if (!this.requestType.some(function (value) { return value === args.requestType; })) {\n                this.groupCache = {};\n                this.resetRowMaintenance();\n            }\n            if (args.requestType === 'reorder' && this.parent.groupSettings.columns.length) {\n                var keys = Object.keys(this.groupCache);\n                for (var j = 0; j < keys.length; j++) {\n                    var cache = this.groupCache[keys[j]];\n                    for (var i = 0; i < cache.length; i++) {\n                        if (cache[i].isCaptionRow && !this.captionModelGen.isEmpty()) {\n                            this.changeCaptionRow(cache[i], null, keys[j]);\n                        }\n                        if (cache[i].isDataRow) {\n                            var from = args.fromIndex + cache[i].indent;\n                            var to = args.toIndex + cache[i].indent;\n                            this.moveCells(cache[i].cells, from, to);\n                        }\n                    }\n                }\n            }\n            if (args.requestType === 'delete'\n                || (args.action === 'add' && args.requestType === 'save')) {\n                this.groupCache = {};\n                this.resetRowMaintenance();\n            }\n        }\n    };\n    GroupLazyLoadRenderer.prototype.actionComplete = function (args) {\n        if (!args.cancel && args.requestType !== 'columnstate' && args.requestType !== 'beginEdit'\n            && args.requestType !== 'delete' && args.requestType !== 'save' && args.requestType !== 'reorder') {\n            this.scrollReset();\n        }\n    };\n    GroupLazyLoadRenderer.prototype.resetRowMaintenance = function () {\n        this.startIndexes = {};\n        this.captionCounts = {};\n        this.rowsByUid = {};\n        this.objIdxByUid = {};\n        this.initialGroupCaptions = {};\n    };\n    GroupLazyLoadRenderer.prototype.moveCells = function (arr, from, to) {\n        if (from >= arr.length) {\n            var k = from - arr.length;\n            while ((k--) + 1) {\n                arr.push(undefined);\n            }\n        }\n        arr.splice(from, 0, arr.splice(to, 1)[0]);\n    };\n    GroupLazyLoadRenderer.prototype.removeRows = function (idx, trIdx) {\n        var page = this.parent.pageSettings.currentPage;\n        var rows = this.groupCache[page];\n        var trs = [].slice.call(this.parent.getContent().querySelectorAll('tr'));\n        var aggUid;\n        if (this.parent.aggregates.length) {\n            var agg = this.getAggregateByCaptionIndex(idx);\n            aggUid = agg.length ? agg[agg.length - 1].uid : undefined;\n        }\n        var indent = rows[idx].indent;\n        this.addClass(this.getNextChilds(idx));\n        rows[idx].isExpand = this.rowsByUid[page][rows[idx].uid].isExpand = false;\n        var capUid;\n        for (var i = idx + 1; i < rows.length; i++) {\n            if (rows[i].indent === indent || rows[i].indent < indent) {\n                capUid = rows[i].uid;\n                break;\n            }\n            if (rows[i].isCaptionRow && rows[i].isExpand) {\n                this.addClass(this.getNextChilds(i));\n            }\n        }\n        for (var i = trIdx + 1; i < trs.length; i++) {\n            if (trs[i].getAttribute('data-uid') === capUid) {\n                break;\n            }\n            else if (trs[i].getAttribute('data-uid') === aggUid) {\n                remove(trs[i]);\n                break;\n            }\n            else {\n                remove(trs[i]);\n            }\n        }\n    };\n    GroupLazyLoadRenderer.prototype.addClass = function (rows) {\n        var last = rows[this.blockSize];\n        if (last) {\n            last.lazyLoadCssClass = 'e-lazyload-middle-down';\n        }\n    };\n    GroupLazyLoadRenderer.prototype.getNextChilds = function (index, rowObjects) {\n        var group = this.groupCache[this.parent.pageSettings.currentPage];\n        var rows = rowObjects ? rowObjects : group;\n        var indent = group[index].indent + 1;\n        var childRows = [];\n        for (var i = rowObjects ? 0 : index + 1; i < rows.length; i++) {\n            if (rows[i].indent < indent) {\n                break;\n            }\n            if (rows[i].indent === indent) {\n                childRows.push(rows[i]);\n            }\n        }\n        return childRows;\n    };\n    GroupLazyLoadRenderer.prototype.lazyLoadHandler = function (args) {\n        this.setStartIndexes();\n        var tr = this.parent.getContent().querySelectorAll('tr')[args.index];\n        var uid = tr.getAttribute('data-uid');\n        var captionIndex = this.getRowObjectIndexByUid(uid);\n        var captionRow = this.groupCache[this.parent.pageSettings.currentPage][captionIndex];\n        var rows = args.isRowExist ? args.isScroll ? this.scrollData\n            : this.getChildRowsByParentIndex(captionIndex, true, true, null, true) : [];\n        this.scrollData = [];\n        if (!args.isRowExist) {\n            this.setRowIndexes(captionIndex, captionRow);\n            this.refreshCaptionRowCount(this.groupCache[this.parent.pageSettings.currentPage][captionIndex], args.count);\n            if (Object.keys(args.data).indexOf('GroupGuid') !== -1) {\n                for (var i = 0; i < args.data.length; i++) {\n                    var data = this.groupGenerator.generateCaptionRow(args.data[i], args.level, captionRow.parentGid, undefined, 0, captionRow.uid);\n                    rows.push(data);\n                    if (this.parent.aggregates.length) {\n                        rows = rows.concat((this.summaryModelGen.generateRows(args.data[i], { level: args.level + 1, parentUid: data.uid })));\n                    }\n                }\n            }\n            else {\n                this.groupGenerator.index = this.getStartIndex(captionIndex, args.isScroll);\n                rows = this.groupGenerator.generateDataRows(args.data, args.level, captionRow.parentGid, 0, captionRow.uid);\n            }\n        }\n        var trIdx = args.isScroll ? this.rowIndex : args.index;\n        var nxtChild = this.getNextChilds(captionIndex, rows);\n        var lastRow = !args.up ? this.hasLastChildRow(args.isScroll, args.count, nxtChild.length) : true;\n        if (!args.isRowExist && !lastRow) {\n            nxtChild[this.blockSize].lazyLoadCssClass = 'e-lazyload-middle-down';\n        }\n        if (!lastRow) {\n            nxtChild[nxtChild.length - 1].lazyLoadCssClass = 'e-not-lazyload-end';\n        }\n        var aggregates = !args.isScroll && !args.isRowExist ? this.getAggregateByCaptionIndex(captionIndex) : [];\n        if (!args.up) {\n            if (!args.isRowExist) {\n                this.refreshRowObjects(rows, args.isScroll ? this.rowObjectIndex : captionIndex);\n            }\n        }\n        this.render(trIdx, rows, lastRow, aggregates);\n        if (this.isFirstChildRow && !args.up) {\n            this.parent.getContent().firstElementChild.scrollTop = rows.length * this.parent.getRowHeight();\n        }\n        this.isFirstChildRow = false;\n        this.rowIndex = undefined;\n        this.rowObjectIndex = undefined;\n        this.childCount = 0;\n    };\n    GroupLazyLoadRenderer.prototype.setRowIndexes = function (capIdx, row) {\n        if (!this.captionCounts[this.parent.pageSettings.currentPage]) {\n            this.captionCounts[this.parent.pageSettings.currentPage] = {};\n        }\n        if (row.isCaptionRow) {\n            this.captionCounts[this.parent.pageSettings.currentPage][row.uid] = row.data.count;\n        }\n    };\n    GroupLazyLoadRenderer.prototype.getStartIndex = function (capIdx, isScroll) {\n        var page = this.parent.pageSettings.currentPage;\n        var cache = this.groupCache[page];\n        if (isScroll) {\n            return cache[this.rowObjectIndex].index + 1;\n        }\n        var count = 0;\n        var idx = 0;\n        var prevCapRow = this.getRowByUid(cache[capIdx].parentUid);\n        if (prevCapRow) {\n            idx = this.prevCaptionCount(prevCapRow);\n        }\n        if (cache[capIdx].indent > 0) {\n            for (var i = capIdx - 1; i >= 0; i--) {\n                if (cache[i].indent < cache[capIdx].indent) {\n                    break;\n                }\n                if (cache[i].isCaptionRow && cache[i].indent === cache[capIdx].indent) {\n                    count = count + cache[i].data.count;\n                }\n            }\n        }\n        var index = count + idx + this.startIndexes[page][cache[capIdx].parentGid];\n        return index;\n    };\n    GroupLazyLoadRenderer.prototype.prevCaptionCount = function (prevCapRow) {\n        var page = this.parent.pageSettings.currentPage;\n        var cache = this.groupCache[page];\n        var idx = 0;\n        for (var i = cache.indexOf(prevCapRow) - 1; i >= 0; i--) {\n            if (cache[i].indent === 0) {\n                break;\n            }\n            if (cache[i].indent < prevCapRow.indent) {\n                break;\n            }\n            if (cache[i].isCaptionRow && cache[i].indent === prevCapRow.indent) {\n                var count = this.captionCounts[page][cache[i].uid];\n                idx = idx + (count ? count : cache[i].data.count);\n            }\n        }\n        var capRow = this.getRowByUid(prevCapRow.parentUid);\n        if (capRow) {\n            idx = idx + this.prevCaptionCount(capRow);\n        }\n        return idx;\n    };\n    GroupLazyLoadRenderer.prototype.setStartIndexes = function () {\n        var cache = this.groupCache[this.parent.pageSettings.currentPage];\n        if (!this.startIndexes[this.parent.pageSettings.currentPage]) {\n            var indexes = [];\n            var idx = void 0;\n            for (var i = 0; i < cache.length; i++) {\n                if (cache[i].isCaptionRow) {\n                    !indexes.length ? indexes.push(0)\n                        : indexes.push(cache[idx].data.count + indexes[indexes.length - 1]);\n                    idx = i;\n                }\n            }\n            this.startIndexes[this.parent.pageSettings.currentPage] = indexes;\n        }\n    };\n    GroupLazyLoadRenderer.prototype.hasLastChildRow = function (isScroll, captionCount, rowCount) {\n        return isScroll ? captionCount === this.childCount + rowCount : captionCount === rowCount;\n    };\n    GroupLazyLoadRenderer.prototype.refreshCaptionRowCount = function (row, count) {\n        row.data.count = count;\n    };\n    GroupLazyLoadRenderer.prototype.render = function (trIdx, rows, hasLastChildRow, aggregates) {\n        var tr = this.parent.getContent().querySelectorAll('tr')[trIdx];\n        var isLastRow = true;\n        if (tr && aggregates.length) {\n            for (var i = aggregates.length - 1; i >= 0; i--) {\n                tr.insertAdjacentElement('afterend', this.rowRenderer.render(aggregates[i], this.parent.getColumns()));\n            }\n        }\n        if (tr && rows.length) {\n            for (var i = rows.length - 1; i >= 0; i--) {\n                if (this.confirmRowRendering(rows[i])) {\n                    tr.insertAdjacentElement('afterend', this.rowRenderer.render(rows[i], this.parent.getColumns()));\n                }\n            }\n        }\n    };\n    /** @hidden */\n    GroupLazyLoadRenderer.prototype.maintainRows = function (row, index) {\n        var page = this.parent.pageSettings.currentPage;\n        if (!this.rowsByUid[page]) {\n            this.rowsByUid[page] = {};\n            this.objIdxByUid[page] = {};\n        }\n        if (row.uid) {\n            this.rowsByUid[page][row.uid] = row;\n        }\n        this.objIdxByUid[page][row.uid] = index;\n    };\n    GroupLazyLoadRenderer.prototype.confirmRowRendering = function (row) {\n        var check = true;\n        if (isNullOrUndefined(row.indent) && !row.isDataRow && !row.isCaptionRow) {\n            var cap = this.getRowByUid(row.parentUid);\n            if (cap.isCaptionRow && !cap.isExpand) {\n                check = false;\n            }\n        }\n        return check;\n    };\n    GroupLazyLoadRenderer.prototype.refreshRowObjects = function (newRows, index) {\n        var page = this.parent.pageSettings.currentPage;\n        var rowsObject = this.groupCache[page];\n        this.rowsByUid[page] = {};\n        this.objIdxByUid[page] = {};\n        var newRowsObject = [];\n        var k = 0;\n        for (var i = 0; i < rowsObject.length; i++) {\n            if (i === index) {\n                this.maintainRows(rowsObject[i], k);\n                newRowsObject.push(rowsObject[i]);\n                k++;\n                for (var j = 0; j < newRows.length; j++) {\n                    this.maintainRows(newRows[j], k);\n                    newRowsObject.push(newRows[j]);\n                    k++;\n                }\n            }\n            else {\n                this.maintainRows(rowsObject[i], k);\n                newRowsObject.push(rowsObject[i]);\n                k++;\n            }\n        }\n        this.groupCache[this.parent.pageSettings.currentPage] = extend([], newRowsObject);\n        this.updateCurrentViewData();\n    };\n    GroupLazyLoadRenderer.prototype.getAggregateByCaptionIndex = function (index) {\n        var cache = this.groupCache[this.parent.pageSettings.currentPage];\n        var parent = cache[index];\n        var indent = parent.indent;\n        var uid = parent.uid;\n        var agg = [];\n        for (var i = index + 1; i < cache.length; i++) {\n            if (cache[i].indent === indent) {\n                break;\n            }\n            if (isNullOrUndefined(cache[i].indent) && cache[i].parentUid === uid) {\n                agg.push(cache[i]);\n            }\n        }\n        return agg;\n    };\n    GroupLazyLoadRenderer.prototype.getChildRowsByParentIndex = function (index, deep, block, data, includeAgg, includeCollapseAgg) {\n        var cache = data ? data : this.groupCache[this.parent.pageSettings.currentPage];\n        var parentRow = cache[index];\n        var agg = [];\n        if (!parentRow.isCaptionRow || (parentRow.isCaptionRow && !parentRow.isExpand && !includeCollapseAgg)) {\n            return [];\n        }\n        if (includeAgg && this.parent.aggregates.length) {\n            agg = this.getAggregateByCaptionIndex(index);\n        }\n        var indent = parentRow.indent;\n        var uid = parentRow.uid;\n        var rows = [];\n        var count = 0;\n        for (var i = index + 1; i < cache.length; i++) {\n            if (cache[i].parentUid === uid) {\n                if (isNullOrUndefined(cache[i].indent)) {\n                    continue;\n                }\n                count++;\n                rows.push(cache[i]);\n                if (deep && cache[i].isCaptionRow) {\n                    rows = rows.concat(this.getChildRowsByParentIndex(i, deep, block, data, includeAgg));\n                }\n                if (block && count === this.pageSize) {\n                    break;\n                }\n            }\n            if (cache[i].indent === indent) {\n                break;\n            }\n        }\n        return rows.concat(agg);\n    };\n    /** @hidden */\n    GroupLazyLoadRenderer.prototype.initialGroupRows = function (isReorder) {\n        var rows = [];\n        var cache = this.groupCache[this.parent.pageSettings.currentPage];\n        if (isReorder) {\n            return this.getRenderedRowsObject();\n        }\n        for (var i = 0; i < cache.length; i++) {\n            if (cache[i].indent === 0) {\n                rows.push(cache[i]);\n                rows = rows.concat(this.getChildRowsByParentIndex(i, true, true, cache, true));\n            }\n        }\n        return rows;\n    };\n    /** @hidden */\n    GroupLazyLoadRenderer.prototype.getRenderedRowsObject = function () {\n        var rows = [];\n        var trs = [].slice.call(this.parent.getContent().querySelectorAll('tr'));\n        for (var i = 0; i < trs.length; i++) {\n            rows.push(this.getRowByUid(trs[i].getAttribute('data-uid')));\n        }\n        return rows;\n    };\n    GroupLazyLoadRenderer.prototype.getCacheRowsOnDownScroll = function (index) {\n        var rows = [];\n        var rowsObject = this.groupCache[this.parent.pageSettings.currentPage];\n        var k = index;\n        for (var i = 0; i < this.pageSize; i++) {\n            if (!rowsObject[k] || rowsObject[k].indent < rowsObject[index].indent) {\n                break;\n            }\n            if (rowsObject[k].indent === rowsObject[index].indent) {\n                rows.push(rowsObject[k]);\n                if (rowsObject[k].isCaptionRow && rowsObject[k].isExpand) {\n                    rows = rows.concat(this.getChildRowsByParentIndex(k, true, true, null, true));\n                }\n            }\n            if (rowsObject[k].indent > rowsObject[index].indent || isNullOrUndefined(rowsObject[k].indent)) {\n                i--;\n            }\n            k++;\n        }\n        return rows;\n    };\n    GroupLazyLoadRenderer.prototype.getCacheRowsOnUpScroll = function (start, end, index) {\n        var rows = [];\n        var rowsObject = this.groupCache[this.parent.pageSettings.currentPage];\n        var str = false;\n        for (var i = 0; i < rowsObject.length; i++) {\n            if (str && (!rowsObject[i] || rowsObject[i].indent < rowsObject[index].indent || rowsObject[i].uid === end)) {\n                break;\n            }\n            if (!str && rowsObject[i].uid === start) {\n                str = true;\n            }\n            if (str && rowsObject[i].indent === rowsObject[index].indent) {\n                rows.push(rowsObject[i]);\n                if (rowsObject[i].isCaptionRow && rowsObject[i].isExpand) {\n                    rows = rows.concat(this.getChildRowsByParentIndex(i, true, true, null, true));\n                }\n            }\n        }\n        return rows;\n    };\n    GroupLazyLoadRenderer.prototype.scrollHandler = function (e) {\n        if (this.parent.isDestroyed || this.childCount) {\n            return;\n        }\n        var downTrs = [].slice.call(this.parent.getContent().querySelectorAll('.e-lazyload-middle-down'));\n        var upTrs = [].slice.call(this.parent.getContent().querySelectorAll('.e-lazyload-middle-up'));\n        var endTrs = [].slice.call(this.parent.getContent().querySelectorAll('.e-not-lazyload-end'));\n        var tr;\n        var lazyLoadDown = false;\n        var lazyLoadUp = false;\n        var lazyLoadEnd = false;\n        if (e.scrollDown && downTrs.length) {\n            var result = this.findRowElements(downTrs);\n            tr = result.tr;\n            lazyLoadDown = result.entered;\n        }\n        if (!e.scrollDown && endTrs) {\n            for (var i = 0; i < endTrs.length; i++) {\n                var top_1 = endTrs[i].getBoundingClientRect().top;\n                var scrollHeight = this.parent.getContent().scrollHeight;\n                if (top_1 > 0 && top_1 < scrollHeight) {\n                    tr = endTrs[i];\n                    lazyLoadEnd = true;\n                    this.rowIndex = tr.rowIndex;\n                    break;\n                }\n            }\n        }\n        if (!e.scrollDown && upTrs.length && !lazyLoadEnd) {\n            var result = this.findRowElements(upTrs);\n            tr = result.tr;\n            lazyLoadUp = result.entered;\n        }\n        if (tr) {\n            if (lazyLoadDown && e.scrollDown && lazyLoadDown && tr) {\n                this.scrollDownHandler(tr);\n            }\n            if (!e.scrollDown && lazyLoadEnd && tr) {\n                this.scrollUpEndRowHandler(tr);\n            }\n            if (this.cacheMode && !e.scrollDown && !lazyLoadEnd && lazyLoadUp && tr) {\n                this.scrollUpHandler(tr);\n            }\n        }\n    };\n    GroupLazyLoadRenderer.prototype.scrollUpEndRowHandler = function (tr) {\n        var page = this.parent.pageSettings.currentPage;\n        var rows = this.groupCache[page];\n        var uid = tr.getAttribute('data-uid');\n        var index = this.rowObjectIndex = this.getRowObjectIndexByUid(uid);\n        var idx = index;\n        var childRow = rows[index];\n        var parentCapRow = this.getRowByUid(childRow.parentUid);\n        var capRowObjIdx = this.getRowObjectIndexByUid(parentCapRow.uid);\n        var captionRowEle = this.parent.getContent().querySelector('tr[data-uid=' + parentCapRow.uid + ']');\n        var capRowEleIndex = captionRowEle.rowIndex;\n        var child = this.getChildRowsByParentIndex(capRowObjIdx);\n        var childIdx = child.indexOf(childRow);\n        var currentPage = Math.ceil(childIdx / this.pageSize);\n        if (currentPage === 1) {\n            return;\n        }\n        this.childCount = currentPage * this.pageSize;\n        index = this.getCurrentBlockEndIndex(childRow, index);\n        if (this.childCount < parentCapRow.data.count) {\n            tr.classList.remove('e-not-lazyload-end');\n            childRow.lazyLoadCssClass = '';\n            var isRowExist = rows[index + 1] ? childRow.indent === rows[index + 1].indent : false;\n            this.scrollData = isRowExist ? this.getCacheRowsOnDownScroll(index + 1) : [];\n            var key = this.getGroupKeysAndFields(capRowObjIdx, rows);\n            var args = {\n                rowIndex: capRowEleIndex, makeRequest: !isRowExist, groupInfo: parentCapRow, fields: key.fields,\n                keys: key.keys, skip: this.childCount, take: this.pageSize, isScroll: true\n            };\n            if (this.cacheMode && this.childCount >= (this.pageSize * this.cacheBlockSize)) {\n                var child_1 = this.getChildRowsByParentIndex(capRowObjIdx);\n                var currenBlock = Math.ceil((child_1.indexOf(rows[idx]) / this.pageSize));\n                var removeBlock = currenBlock - (this.cacheBlockSize - 1);\n                this.removeBlock(uid, isRowExist, removeBlock, child_1);\n                args.cachedRowIndex = (removeBlock * this.pageSize);\n            }\n            this.captionRowExpand(args);\n        }\n        else {\n            this.childCount = 0;\n        }\n    };\n    GroupLazyLoadRenderer.prototype.scrollDownHandler = function (tr) {\n        var page = this.parent.pageSettings.currentPage;\n        var rows = this.groupCache[page];\n        var uid = tr.getAttribute('data-uid');\n        var index = this.getRowObjectIndexByUid(uid);\n        var idx = index;\n        var childRow = rows[index];\n        var parentCapRow = this.getRowByUid(childRow.parentUid);\n        var capRowObjIdx = this.getRowObjectIndexByUid(parentCapRow.uid);\n        var captionRowEle = this.getRowElementByUid(parentCapRow.uid);\n        var capRowEleIndex = captionRowEle.rowIndex;\n        var child = this.getChildRowsByParentIndex(capRowObjIdx);\n        var childIdx = child.indexOf(childRow);\n        var currentPage = Math.ceil(childIdx / this.pageSize);\n        this.childCount = currentPage * this.pageSize;\n        index = this.rowObjectIndex = this.getRowObjectIndexByUid(child[this.childCount - 1].uid);\n        var lastchild = rows[index];\n        var lastRow = this.getRowElementByUid(lastchild.uid);\n        this.rowIndex = lastRow.rowIndex;\n        index = this.getCurrentBlockEndIndex(lastchild, index);\n        if (this.childCount < parentCapRow.data.count) {\n            var isRowExist = rows[index + 1] ? childRow.indent === rows[index + 1].indent : false;\n            if (isRowExist && !isNullOrUndefined(this.getRowElementByUid(rows[index + 1].uid))) {\n                this.childCount = 0;\n                return;\n            }\n            if (currentPage > 1 || !this.cacheMode) {\n                tr.classList.remove('e-lazyload-middle-down');\n                lastRow.classList.remove('e-not-lazyload-end');\n                lastchild.lazyLoadCssClass = '';\n            }\n            this.scrollData = isRowExist ? this.getCacheRowsOnDownScroll(this.rowObjectIndex + 1) : [];\n            var query = this.getGroupKeysAndFields(capRowObjIdx, rows);\n            var args = {\n                rowIndex: capRowEleIndex, makeRequest: !isRowExist, groupInfo: parentCapRow, fields: query.fields,\n                keys: query.keys, skip: this.childCount, take: this.pageSize, isScroll: true\n            };\n            if (this.cacheMode && (this.childCount - this.pageSize) >= (this.pageSize * this.cacheBlockSize)) {\n                var child_2 = this.getChildRowsByParentIndex(capRowObjIdx);\n                var currenBlock = Math.ceil((child_2.indexOf(rows[idx]) / this.pageSize)) - 1;\n                var removeBlock = (currenBlock - (this.cacheBlockSize - 1)) + 1;\n                this.removeBlock(uid, isRowExist, removeBlock, child_2, lastchild);\n                args.cachedRowIndex = (removeBlock * this.pageSize);\n            }\n            this.captionRowExpand(args);\n        }\n        else {\n            this.childCount = 0;\n        }\n    };\n    GroupLazyLoadRenderer.prototype.getCurrentBlockEndIndex = function (row, index) {\n        var page = this.parent.pageSettings.currentPage;\n        var rows = this.groupCache[page];\n        if (row.isCaptionRow) {\n            if (row.isExpand) {\n                var childCount = this.getChildRowsByParentIndex(index, true).length;\n                this.rowIndex = this.rowIndex + childCount;\n            }\n            var agg = this.getAggregateByCaptionIndex(index);\n            this.rowObjectIndex = this.rowObjectIndex + agg.length;\n            var idx = index;\n            for (var i = idx + 1; i < rows.length; i++) {\n                if (rows[i].indent === rows[index].indent || rows[i].indent < rows[index].indent) {\n                    index = idx;\n                    break;\n                }\n                else {\n                    idx++;\n                }\n            }\n        }\n        return index;\n    };\n    GroupLazyLoadRenderer.prototype.removeBlock = function (uid, isRowExist, removeBlock, child, lastchild) {\n        var page = this.parent.pageSettings.currentPage;\n        var rows = this.groupCache[page];\n        var uid1 = child[(((removeBlock + 1) * this.pageSize) - 1) - this.blockSize].uid;\n        var uid2 = child[(removeBlock * this.pageSize) - this.pageSize].uid;\n        var uid3 = child[(removeBlock * this.pageSize)].uid;\n        var firstIdx = this.getRowObjectIndexByUid(uid1);\n        rows[firstIdx].lazyLoadCssClass = 'e-lazyload-middle-up';\n        this.getRowElementByUid(uid1).classList.add('e-lazyload-middle-up');\n        if (lastchild) {\n            this.getRowElementByUid(uid3).classList.add('e-not-lazyload-first');\n            this.getRowByUid(uid3).lazyLoadCssClass = 'e-not-lazyload-first';\n            this.getRowByUid(uid2).lazyLoadCssClass = '';\n        }\n        if (isRowExist) {\n            this.removeTopRows(lastchild ? lastchild.uid : uid, uid2, uid3);\n        }\n        else {\n            this.uid1 = uid2;\n            this.uid2 = uid3;\n            this.uid3 = lastchild ? lastchild.uid : uid;\n        }\n    };\n    GroupLazyLoadRenderer.prototype.scrollUpHandler = function (tr) {\n        var page = this.parent.pageSettings.currentPage;\n        var rows = this.groupCache[page];\n        var uid = tr.getAttribute('data-uid');\n        var row = this.getRowByUid(uid);\n        var index = this.rowObjectIndex = this.getRowObjectIndexByUid(uid);\n        var parentCapRow = this.getRowByUid(row.parentUid);\n        var capRowObjIdx = this.rowIndex = this.getRowObjectIndexByUid(parentCapRow.uid);\n        var captionRowEle = this.parent.getRowElementByUID(parentCapRow.uid);\n        var capRowEleIndex = captionRowEle.rowIndex;\n        var child = this.getChildRowsByParentIndex(capRowObjIdx);\n        var childIdx = child.indexOf(rows[index]);\n        var currenBlock = Math.floor((childIdx / this.pageSize));\n        var idx = this.blockSize;\n        if ((this.blockSize * 2) > this.pageSize) {\n            idx = (this.blockSize * 2) - this.pageSize;\n            idx = this.blockSize - idx;\n        }\n        var start = child[(childIdx - (idx - 1)) - this.pageSize].uid;\n        var end = child[childIdx - (idx - 1)].uid;\n        this.scrollData = this.getCacheRowsOnUpScroll(start, end, index - (idx - 1));\n        this.isFirstChildRow = currenBlock > 1;\n        if (this.isFirstChildRow) {\n            this.scrollData[0].lazyLoadCssClass = 'e-not-lazyload-first';\n        }\n        this.getRowByUid(end).lazyLoadCssClass = '';\n        this.getRowElementByUid(end).classList.remove('e-not-lazyload-first');\n        var removeBlock = currenBlock + this.cacheBlockSize;\n        if (child.length !== parentCapRow.data.count && (removeBlock * this.pageSize > child.length)) {\n            this.isFirstChildRow = false;\n            this.scrollData[0].lazyLoadCssClass = '';\n            this.getRowElementByUid(end).classList.add('e-not-lazyload-first');\n            return;\n        }\n        var count = removeBlock * this.pageSize > parentCapRow.data.count\n            ? parentCapRow.data.count : removeBlock * this.pageSize;\n        var size = removeBlock * this.pageSize > parentCapRow.data.count\n            ? (this.pageSize - ((this.pageSize * removeBlock) - parentCapRow.data.count)) : this.pageSize;\n        var childRows = this.getChildRowsByParentIndex(rows.indexOf(child[count - 1]), true, false, null, true);\n        var uid1 = childRows.length ? childRows[childRows.length - 1].uid : child[(count - 1)].uid;\n        var uid2 = child[count - size].uid;\n        var uid3 = child[(count - size) - 1].uid;\n        var lastIdx = this.objIdxByUid[page][uid2] - idx;\n        if (rows[lastIdx].lazyLoadCssClass === 'e-lazyload-middle-down') {\n            var trEle = this.getRowElementByUid(rows[lastIdx].uid);\n            if (trEle) {\n                trEle.classList.add('e-lazyload-middle-down');\n            }\n        }\n        this.getRowByUid(uid1).lazyLoadCssClass = '';\n        this.getRowByUid(uid3).lazyLoadCssClass = 'e-not-lazyload-end';\n        this.getRowElementByUid(uid3).classList.add('e-not-lazyload-end');\n        this.removeBottomRows(uid1, uid2, uid3);\n        this.rowIndex = tr.rowIndex - idx;\n        tr.classList.length > 1 ? tr.classList.remove('e-lazyload-middle-up') : tr.removeAttribute('class');\n        if (!isNullOrUndefined(this.getRowElementByUid(start))) {\n            this.childCount = 0;\n            this.scrollData = [];\n            return;\n        }\n        var key = this.getGroupKeysAndFields(this.getRowObjectIndexByUid(parentCapRow.uid), rows);\n        var args = {\n            rowIndex: capRowEleIndex, makeRequest: false, groupInfo: parentCapRow, fields: key.fields,\n            keys: key.keys, skip: this.childCount, take: this.pageSize, isScroll: true, scrollUp: true\n        };\n        this.captionRowExpand(args);\n    };\n    GroupLazyLoadRenderer.prototype.findRowElements = function (rows) {\n        var entered = false;\n        var tr;\n        for (var i = 0; i < rows.length; i++) {\n            var rowIdx = rows[i].rowIndex;\n            if (isRowEnteredInGrid(rowIdx, this.parent)) {\n                entered = true;\n                this.rowIndex = rowIdx;\n                tr = rows[i];\n                break;\n            }\n        }\n        return { entered: entered, tr: tr };\n    };\n    GroupLazyLoadRenderer.prototype.getRowElementByUid = function (uid) {\n        return this.parent.getContent().querySelector('tr[data-uid=' + uid + ']');\n    };\n    GroupLazyLoadRenderer.prototype.removeTopRows = function (uid1, uid2, uid3) {\n        var trs = [].slice.call(this.parent.getContent().querySelectorAll('tr'));\n        var page = this.parent.pageSettings.currentPage;\n        var start = false;\n        for (var i = 0; i < trs.length; i++) {\n            if (trs[i].getAttribute('data-uid') === uid3) {\n                var tr = this.parent.getContent().querySelector('tr[data-uid=' + uid1 + ']');\n                if (tr) {\n                    this.rowIndex = tr.rowIndex;\n                }\n                break;\n            }\n            if (trs[i].getAttribute('data-uid') === uid2) {\n                start = true;\n            }\n            if (start) {\n                remove(trs[i]);\n            }\n        }\n    };\n    GroupLazyLoadRenderer.prototype.removeBottomRows = function (uid1, uid2, uid3) {\n        var trs = [].slice.call(this.parent.getContent().querySelectorAll('tr'));\n        var start = false;\n        for (var i = 0; i < trs.length; i++) {\n            if (trs[i].getAttribute('data-uid') === uid2) {\n                start = true;\n            }\n            if (start) {\n                remove(trs[i]);\n                if (trs[i].getAttribute('data-uid') === uid1) {\n                    break;\n                }\n            }\n        }\n    };\n    GroupLazyLoadRenderer.prototype.setCache = function (e) {\n        var page = this.parent.pageSettings.currentPage;\n        this.groupCache[page] = this.initialGroupCaptions[page] = extend([], e.data);\n    };\n    GroupLazyLoadRenderer.prototype.getGroupKeysAndFields = function (index, rowsObject) {\n        var fields = [];\n        var keys = [];\n        for (var i = index; i >= 0; i--) {\n            if (rowsObject[i].isCaptionRow && fields.indexOf(rowsObject[i].data.field) === -1\n                && (rowsObject[i].indent < rowsObject[index].indent || i === index)) {\n                fields.push(rowsObject[i].data.field);\n                keys.push(rowsObject[i].data.key);\n                if (rowsObject[i].indent === 0) {\n                    break;\n                }\n            }\n        }\n        return { fields: fields, keys: keys };\n    };\n    GroupLazyLoadRenderer.prototype.generateExpandPredicates = function (fields, values) {\n        var filterCols = [];\n        for (var i = 0; i < fields.length; i++) {\n            var column = this.parent.getColumnByField(fields[i]);\n            var value = values[i] === 'null' ? null : values[i];\n            var pred = {\n                field: fields[i], predicate: 'or', uid: column.uid, operator: 'equal', type: column.type,\n                matchCase: this.allowCaseSensitive, ignoreAccent: this.ignoreAccent\n            };\n            if (value === '' || isNullOrUndefined(value)) {\n                filterCols = filterCols.concat(CheckBoxFilterBase.generateNullValuePredicates(pred));\n            }\n            else {\n                filterCols.push(extend({}, { value: value }, pred));\n            }\n        }\n        return CheckBoxFilterBase.getPredicate(filterCols);\n    };\n    GroupLazyLoadRenderer.prototype.getPredicates = function (pred) {\n        var predicateList = [];\n        for (var _i = 0, _a = Object.keys(pred); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            predicateList.push(pred[prop]);\n        }\n        return predicateList;\n    };\n    GroupLazyLoadRenderer.prototype.captionRowExpand = function (args) {\n        var _this = this;\n        var captionRow = args.groupInfo;\n        var level = this.parent.groupSettings.columns.indexOf(captionRow.data.field) + 1;\n        var pred = this.generateExpandPredicates(args.fields, args.keys);\n        var predicateList = this.getPredicates(pred);\n        var lazyLoad = { level: level, skip: args.skip, take: args.take, where: predicateList };\n        if (args.makeRequest) {\n            var query = this.parent.renderModule.data.generateQuery(true);\n            if (!query.isCountRequired) {\n                query.isCountRequired = true;\n            }\n            query.lazyLoad.push({ key: 'onDemandGroupInfo', value: lazyLoad });\n            this.parent.showSpinner();\n            this.parent.renderModule.data.getData({}, query).then(function (e) {\n                _this.parent.hideSpinner();\n                if (e.result.length === 0) {\n                    return;\n                }\n                if (_this.cacheMode && _this.uid1 && _this.uid2) {\n                    _this.removeTopRows(_this.uid3, _this.uid1, _this.uid2);\n                    _this.uid1 = _this.uid2 = _this.uid3 = undefined;\n                }\n                _this.lazyLoadHandler({\n                    data: e.result, count: e.count, level: level, index: args.rowIndex,\n                    isRowExist: false, isScroll: args.isScroll, up: false, rowIndex: args.cachedRowIndex\n                });\n            })\n                .catch(function (e) { return _this.parent.renderModule.dataManagerFailure(e, { requestType: 'grouping' }); });\n        }\n        else {\n            this.lazyLoadHandler({\n                data: null, count: args.groupInfo.data.count, level: level, index: args.rowIndex,\n                isRowExist: true, isScroll: args.isScroll, up: args.scrollUp, rowIndex: args.cachedRowIndex\n            });\n        }\n    };\n    GroupLazyLoadRenderer.prototype.scrollReset = function (top) {\n        this.parent.getContent().firstElementChild.scrollTop = top ? this.parent.getContent().firstElementChild.scrollTop + top : 0;\n    };\n    GroupLazyLoadRenderer.prototype.updateCurrentViewData = function () {\n        var records = [];\n        this.getRows().filter(function (row) {\n            if (row.isDataRow) {\n                records[row.index] = row.data;\n            }\n        });\n        this.parent.currentViewData = records.length ? records : this.parent.currentViewData;\n    };\n    /** @hidden */\n    GroupLazyLoadRenderer.prototype.getGroupCache = function () {\n        return this.groupCache;\n    };\n    /** @hidden */\n    GroupLazyLoadRenderer.prototype.getRows = function () {\n        return this.groupCache[this.parent.pageSettings.currentPage] || [];\n    };\n    /** @hidden */\n    GroupLazyLoadRenderer.prototype.getRowElements = function () {\n        return [].slice.call(this.parent.getContent().querySelectorAll('.e-row'));\n    };\n    /** @hidden */\n    GroupLazyLoadRenderer.prototype.getRowByIndex = function (index) {\n        var tr = [].slice.call(this.parent.getContent().querySelectorAll('.e-row'));\n        var row;\n        for (var i = 0; !isNullOrUndefined(index) && i < tr.length; i++) {\n            if (tr[i].getAttribute('aria-rowindex') === index.toString()) {\n                row = tr[i];\n                break;\n            }\n        }\n        return row;\n    };\n    /** @hidden */\n    GroupLazyLoadRenderer.prototype.setVisible = function (columns) {\n        var gObj = this.parent;\n        var rows = this.getRows();\n        var testRow;\n        rows.some(function (r) { if (r.isDataRow) {\n            testRow = r;\n        } return r.isDataRow; });\n        var contentrows = this.getRows().filter(function (row) { return !row.isDetailRow; });\n        for (var i = 0; i < columns.length; i++) {\n            var column = columns[i];\n            var idx = this.parent.getNormalizedColumnIndex(column.uid);\n            var colIdx = this.parent.getColumnIndexByUid(column.uid);\n            var displayVal = column.visible === true ? '' : 'none';\n            if (idx !== -1 && testRow && idx < testRow.cells.length) {\n                setStyleAttribute(this.getColGroup().childNodes[idx], { 'display': displayVal });\n            }\n            this.setDisplayNone(gObj.getDataRows(), colIdx, displayVal, contentrows, idx);\n            if (!this.parent.invokedFromMedia && column.hideAtMedia) {\n                this.parent.updateMediaColumns(column);\n            }\n            this.parent.invokedFromMedia = false;\n        }\n    };\n    /** @hidden */\n    GroupLazyLoadRenderer.prototype.setDisplayNone = function (tr, idx, displayVal, rows, oriIdx) {\n        var trs = Object.keys(tr);\n        if (!this.parent.groupSettings.columns.length) {\n            for (var i = 0; i < trs.length; i++) {\n                var td = tr[trs[i]].querySelectorAll('td.e-rowcell')[idx];\n                if (tr[trs[i]].querySelectorAll('td.e-rowcell').length && td) {\n                    setStyleAttribute(tr[trs[i]].querySelectorAll('td.e-rowcell')[idx], { 'display': displayVal });\n                    if (tr[trs[i]].querySelectorAll('td.e-rowcell')[idx].classList.contains('e-hide')) {\n                        removeClass([tr[trs[i]].querySelectorAll('td.e-rowcell')[idx]], ['e-hide']);\n                    }\n                    rows[trs[i]].cells[idx].visible = displayVal === '' ? true : false;\n                }\n            }\n        }\n        else {\n            var keys = Object.keys(this.groupCache);\n            for (var j = 0; j < keys.length; j++) {\n                var uids = this.rowsByUid[keys[j]];\n                var idxs = Object.keys(uids);\n                for (var i = 0; i < idxs.length; i++) {\n                    var tr_1 = this.parent.getContent().querySelector('tr[data-uid=' + idxs[i] + ']');\n                    var row = uids[idxs[i]];\n                    if (row.isCaptionRow) {\n                        if (!this.captionModelGen.isEmpty()) {\n                            this.changeCaptionRow(row, tr_1, keys[j]);\n                        }\n                        else {\n                            row.cells[row.indent + 1].colSpan = displayVal === '' ? row.cells[row.indent + 1].colSpan + 1\n                                : row.cells[row.indent + 1].colSpan - 1;\n                            if (tr_1) {\n                                tr_1.cells[row.indent + 1].colSpan = row.cells[row.indent + 1].colSpan;\n                            }\n                        }\n                    }\n                    if (row.isDataRow) {\n                        this.showAndHideCells(tr_1, idx, displayVal, false);\n                        row.cells[oriIdx].visible = displayVal === '' ? true : false;\n                    }\n                    if (!row.isCaptionRow && !row.isDataRow && isNullOrUndefined(row.indent)) {\n                        row.cells[oriIdx].visible = displayVal === '' ? true : false;\n                        row.visible = row.cells.some(function (cell) { return cell.isDataCell && cell.visible; });\n                        this.showAndHideCells(tr_1, idx, displayVal, true, row);\n                    }\n                }\n            }\n        }\n    };\n    GroupLazyLoadRenderer.prototype.changeCaptionRow = function (row, tr, index) {\n        var capRow = row;\n        var captionData = row.data;\n        var data = this.groupGenerator.generateCaptionRow(captionData, capRow.indent, capRow.parentGid, undefined, capRow.tIndex, capRow.parentUid);\n        data.uid = row.uid;\n        data.isExpand = row.isExpand;\n        data.lazyLoadCssClass = row.lazyLoadCssClass;\n        this.rowsByUid[index][row.uid] = data;\n        this.groupCache[index][this.objIdxByUid[index][row.uid]] = data;\n        if (tr) {\n            var tbody = this.parent.getContentTable().querySelector('tbody');\n            tbody.replaceChild(this.rowRenderer.render(data, this.parent.getColumns()), tr);\n        }\n    };\n    GroupLazyLoadRenderer.prototype.showAndHideCells = function (tr, idx, displayVal, isSummary, row) {\n        if (tr) {\n            var cls = isSummary ? 'td.e-summarycell' : 'td.e-rowcell';\n            setStyleAttribute(tr.querySelectorAll(cls)[idx], { 'display': displayVal });\n            if (tr.querySelectorAll(cls)[idx].classList.contains('e-hide')) {\n                removeClass([tr.querySelectorAll(cls)[idx]], ['e-hide']);\n            }\n            if (isSummary) {\n                if (row.visible && tr.classList.contains('e-hide')) {\n                    removeClass([tr], ['e-hide']);\n                }\n                else if (!row.visible) {\n                    addClass([tr], ['e-hide']);\n                }\n            }\n        }\n    };\n    return GroupLazyLoadRenderer;\n}(ContentRender));\nexport { GroupLazyLoadRenderer };\n"]},"metadata":{},"sourceType":"module"}