{"ast":null,"code":"import { Draggable, Droppable, isBlazor } from '@syncfusion/ej2-base';\nimport { createElement, closest, remove, classList, addClass, removeClass } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, extend } from '@syncfusion/ej2-base';\nimport { parentsUntil, isActionPrevent, isGroupAdaptive, updatecloneRow } from '../base/util';\nimport * as events from '../base/constant';\nimport { AriaService } from '../services/aria-service';\nimport { GroupModelGenerator } from '../services/group-model-generator';\nimport { DataUtil } from '@syncfusion/ej2-data';\n/**\n *\n * The `Group` module is used to handle group action.\n */\n\nvar Group =\n/** @class */\nfunction () {\n  /**\n   * Constructor for Grid group module\n   * @hidden\n   */\n  function Group(parent, groupSettings, sortedColumns, serviceLocator) {\n    var _this = this; //Internal variables\n\n\n    this.sortRequired = true;\n    this.isAppliedGroup = false;\n    this.isAppliedUnGroup = false;\n    this.reorderingColumns = [];\n    this.visualElement = createElement('div', {\n      className: 'e-cloneproperties e-dragclone e-gdclone',\n      styles: 'line-height:23px',\n      attrs: {\n        action: 'grouping'\n      }\n    });\n\n    this.helper = function (e) {\n      var gObj = _this.parent;\n      var target = e.sender.target;\n      var element = target.classList.contains('e-groupheadercell') ? target : parentsUntil(target, 'e-groupheadercell');\n\n      if (!element || !target.classList.contains('e-drag') && _this.groupSettings.allowReordering) {\n        return false;\n      }\n\n      _this.column = gObj.getColumnByField(element.firstElementChild.getAttribute('ej-mappingname'));\n      _this.visualElement.textContent = element.textContent;\n      _this.visualElement.style.width = element.offsetWidth + 2 + 'px';\n      _this.visualElement.style.height = element.offsetHeight + 2 + 'px';\n\n      _this.visualElement.setAttribute('e-mappinguid', _this.column.uid);\n\n      gObj.element.appendChild(_this.visualElement);\n      return _this.visualElement;\n    };\n\n    this.dragStart = function (e) {\n      _this.parent.element.classList.add('e-ungroupdrag');\n\n      if (isBlazor()) {\n        e.bindEvents(e.dragElement);\n      }\n    };\n\n    this.drag = function (e) {\n      if (_this.groupSettings.allowReordering) {\n        _this.animateDropper(e);\n      }\n\n      var target = e.target;\n\n      var cloneElement = _this.parent.element.querySelector('.e-cloneproperties');\n\n      _this.parent.trigger(events.columnDrag, {\n        target: target,\n        draggableType: 'headercell',\n        column: _this.column\n      });\n\n      if (!_this.groupSettings.allowReordering) {\n        classList(cloneElement, ['e-defaultcur'], ['e-notallowedcur']);\n\n        if (!(parentsUntil(target, 'e-gridcontent') || parentsUntil(target, 'e-headercell'))) {\n          classList(cloneElement, ['e-notallowedcur'], ['e-defaultcur']);\n        }\n      }\n    };\n\n    this.dragStop = function (e) {\n      _this.parent.element.classList.remove('e-ungroupdrag');\n\n      var preventDrop = !(parentsUntil(e.target, 'e-gridcontent') || parentsUntil(e.target, 'e-gridheader'));\n\n      if (_this.groupSettings.allowReordering && preventDrop) {\n        remove(e.helper);\n\n        if (parentsUntil(e.target, 'e-groupdroparea')) {\n          _this.rearrangeGroup(e);\n        } else if (!parentsUntil(e.target, 'e-grid')) {\n          var field = _this.parent.getColumnByUid(e.helper.getAttribute('e-mappinguid')).field;\n\n          if (_this.groupSettings.columns.indexOf(field) !== -1) {\n            _this.ungroupColumn(field);\n          }\n        }\n\n        return;\n      } else if (preventDrop) {\n        remove(e.helper);\n        return;\n      }\n    };\n\n    this.animateDropper = function (e) {\n      var uid = _this.parent.element.querySelector('.e-cloneproperties').getAttribute('e-mappinguid');\n\n      var dragField = _this.parent.getColumnByUid(uid).field;\n\n      var parent = parentsUntil(e.target, 'e-groupdroparea');\n      var dropTarget = parentsUntil(e.target, 'e-group-animator'); // tslint:disable-next-line\n\n      var grouped = [].slice.call(_this.element.querySelectorAll('.e-groupheadercell')).map(function (e) {\n        return e.querySelector('div').getAttribute('ej-mappingname');\n      });\n      var cols = JSON.parse(JSON.stringify(grouped));\n\n      if (dropTarget || parent) {\n        if (dropTarget) {\n          var dropField = dropTarget.querySelector('div[ej-mappingname]').getAttribute('ej-mappingname');\n          var dropIndex = +dropTarget.getAttribute('index');\n\n          if (dropField !== dragField) {\n            var dragIndex = cols.indexOf(dragField);\n\n            if (dragIndex !== -1) {\n              cols.splice(dragIndex, 1);\n            }\n\n            var flag = dropIndex !== -1 && dragIndex === dropIndex;\n            cols.splice(dropIndex + (flag ? 1 : 0), 0, dragField);\n          }\n        } else if (parent && cols.indexOf(dragField) === -1) {\n          cols.push(dragField);\n        }\n\n        _this.element.innerHTML = '';\n\n        if (cols.length && !_this.element.classList.contains('e-grouped')) {\n          _this.element.classList.add('e-grouped');\n        }\n\n        _this.reorderingColumns = cols;\n\n        for (var c = 0; c < cols.length; c++) {\n          _this.addColToGroupDrop(cols[c]);\n        }\n      } else {\n        _this.addLabel();\n\n        _this.removeColFromGroupDrop(dragField);\n      }\n    };\n\n    this.drop = function (e) {\n      var gObj = _this.parent;\n      var column = gObj.getColumnByUid(e.droppedElement.getAttribute('e-mappinguid'));\n\n      _this.element.classList.remove('e-hover');\n\n      remove(e.droppedElement);\n\n      _this.aria.setDropTarget(_this.parent.element.querySelector('.e-groupdroparea'), false);\n\n      _this.aria.setGrabbed(_this.parent.getHeaderTable().querySelector('[aria-grabbed=true]'), false);\n\n      if (isNullOrUndefined(column) || column.allowGrouping === false || parentsUntil(gObj.getColumnHeaderByUid(column.uid), 'e-grid').getAttribute('id') !== gObj.element.getAttribute('id')) {\n        _this.parent.log('action_disabled_column', {\n          moduleName: _this.getModuleName(),\n          columnName: column.headerText\n        });\n\n        return;\n      }\n\n      _this.groupColumn(column.field);\n    };\n\n    this.contentRefresh = true;\n    this.aria = new AriaService();\n    this.parent = parent;\n    this.groupSettings = groupSettings;\n    this.serviceLocator = serviceLocator;\n    this.sortedColumns = sortedColumns;\n    this.focus = serviceLocator.getService('focus');\n    this.addEventListener();\n    this.groupGenerator = new GroupModelGenerator(this.parent);\n  }\n\n  Group.prototype.addLabel = function () {\n    if (!this.element.querySelectorAll('.e-group-animator').length) {\n      var dragLabel = this.l10n.getConstant('GroupDropArea');\n      this.element.innerHTML = dragLabel;\n      this.element.classList.remove('e-grouped');\n    }\n  };\n\n  Group.prototype.rearrangeGroup = function (e) {\n    this.sortRequired = false;\n    this.updateModel();\n  };\n\n  Group.prototype.columnDrag = function (e) {\n    if (this.groupSettings.allowReordering) {\n      this.animateDropper(e);\n    }\n\n    var gObj = this.parent;\n    var cloneElement = this.parent.element.querySelector('.e-cloneproperties');\n    classList(cloneElement, ['e-defaultcur'], ['e-notallowedcur']);\n\n    if (!parentsUntil(e.target, 'e-groupdroparea') && !(this.parent.allowReordering && parentsUntil(e.target, 'e-headercell'))) {\n      classList(cloneElement, ['e-notallowedcur'], ['e-defaultcur']);\n    }\n\n    e.target.classList.contains('e-groupdroparea') ? this.element.classList.add('e-hover') : this.element.classList.remove('e-hover');\n  };\n\n  Group.prototype.columnDragStart = function (e) {\n    if (e.target.classList.contains('e-stackedheadercell')) {\n      return;\n    }\n\n    var gObj = this.parent;\n    var dropArea = this.parent.element.querySelector('.e-groupdroparea');\n    this.aria.setDropTarget(dropArea, e.column.allowGrouping);\n    var element = e.target.classList.contains('e-headercell') ? e.target : parentsUntil(e.target, 'e-headercell');\n    this.aria.setGrabbed(element, true, !e.column.allowGrouping);\n  };\n\n  Group.prototype.columnDrop = function (e) {\n    var gObj = this.parent;\n\n    if (e.droppedElement.getAttribute('action') === 'grouping') {\n      var column = gObj.getColumnByUid(e.droppedElement.getAttribute('e-mappinguid'));\n\n      if (isNullOrUndefined(column) || column.allowGrouping === false || parentsUntil(gObj.getColumnHeaderByUid(column.uid), 'e-grid').getAttribute('id') !== gObj.element.getAttribute('id')) {\n        return;\n      }\n\n      this.ungroupColumn(column.field);\n    }\n  };\n  /**\n   * @hidden\n   */\n\n\n  Group.prototype.addEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.on(events.uiUpdate, this.enableAfterRender, this);\n    this.parent.on(events.groupComplete, this.onActionComplete, this);\n    this.parent.on(events.ungroupComplete, this.onActionComplete, this);\n    this.parent.on(events.inBoundModelChanged, this.onPropertyChanged, this);\n    this.parent.on(events.click, this.clickHandler, this);\n    this.parent.on(events.columnDrag, this.columnDrag, this);\n    this.parent.on(events.columnDragStart, this.columnDragStart, this);\n    this.parent.on(events.headerDrop, this.columnDrop, this);\n    this.parent.on(events.columnDrop, this.columnDrop, this);\n    this.parent.on(events.headerRefreshed, this.refreshSortIcons, this);\n    this.parent.on(events.sortComplete, this.refreshSortIcons, this);\n    this.parent.on(events.keyPressed, this.keyPressHandler, this);\n    this.parent.on(events.contentReady, this.initialEnd, this);\n    this.parent.on(events.onEmpty, this.initialEnd, this);\n    this.parent.on(events.initialEnd, this.render, this);\n    this.parent.on(events.groupAggregates, this.onGroupAggregates, this);\n    this.parent.on('blazor-action-begin', this.blazorActionBegin, this);\n    this.parent.on('group-expand-collapse', this.updateExpand, this);\n    this.parent.on('persist-data-changed', this.initialEnd, this);\n  };\n  /**\n   * @hidden\n   */\n\n\n  Group.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.off(events.initialEnd, this.render);\n    this.parent.off(events.uiUpdate, this.enableAfterRender);\n    this.parent.off(events.groupComplete, this.onActionComplete);\n    this.parent.off(events.ungroupComplete, this.onActionComplete);\n    this.parent.off(events.inBoundModelChanged, this.onPropertyChanged);\n    this.parent.off(events.click, this.clickHandler);\n    this.parent.off(events.columnDrag, this.columnDrag);\n    this.parent.off(events.columnDragStart, this.columnDragStart);\n    this.parent.off(events.columnDrop, this.columnDrop);\n    this.parent.off(events.headerDrop, this.columnDrop);\n    this.parent.off(events.headerRefreshed, this.refreshSortIcons);\n    this.parent.off(events.sortComplete, this.refreshSortIcons);\n    this.parent.off(events.keyPressed, this.keyPressHandler);\n    this.parent.off(events.groupAggregates, this.onGroupAggregates);\n    this.parent.off('blazor-action-begin', this.blazorActionBegin);\n    this.parent.off('group-expand-collapse', this.updateExpand);\n  };\n\n  Group.prototype.blazorActionBegin = function () {\n    if (this.parent.allowGrouping && !this.parent.isCollapseStateEnabled()) {\n      this.expandAll();\n    }\n  };\n\n  Group.prototype.initialEnd = function () {\n    var gObj = this.parent;\n    this.parent.off(events.contentReady, this.initialEnd);\n    this.parent.off(events.onEmpty, this.initialEnd);\n\n    if (isBlazor() && gObj.isServerRendered) {\n      for (var i = 0; i < gObj.columns.length; i++) {\n        this.removeColFromGroupDrop(gObj.columns[i].field);\n      }\n\n      this.updateGroupDropArea();\n    }\n\n    if (this.parent.getColumns().length && this.groupSettings.columns.length) {\n      this.contentRefresh = false;\n\n      for (var _i = 0, _a = gObj.groupSettings.columns; _i < _a.length; _i++) {\n        var col = _a[_i];\n        this.groupColumn(col);\n      }\n\n      this.contentRefresh = true;\n    }\n  };\n\n  Group.prototype.keyPressHandler = function (e) {\n    var gObj = this.parent;\n\n    if (e.action !== 'ctrlSpace' && (!this.groupSettings.columns.length || ['altDownArrow', 'altUpArrow', 'ctrlDownArrow', 'ctrlUpArrow', 'enter'].indexOf(e.action) === -1)) {\n      return;\n    }\n\n    e.preventDefault();\n\n    switch (e.action) {\n      case 'altDownArrow':\n      case 'altUpArrow':\n        var selected = gObj.allowSelection ? gObj.getSelectedRowIndexes() : [];\n\n        if (selected.length) {\n          var rows = gObj.getContentTable().querySelector('tbody').children;\n          var dataRow = gObj.getDataRows()[selected[selected.length - 1]];\n          var grpRow = void 0;\n\n          for (var i = dataRow.rowIndex; i >= 0; i--) {\n            if (!rows[i].classList.contains('e-row') && !rows[i].classList.contains('e-detailrow')) {\n              grpRow = rows[i];\n              break;\n            }\n          }\n\n          this.expandCollapseRows(grpRow.querySelector(e.action === 'altUpArrow' ? '.e-recordplusexpand' : '.e-recordpluscollapse'));\n        }\n\n        break;\n\n      case 'ctrlDownArrow':\n        this.expandAll();\n        break;\n\n      case 'ctrlUpArrow':\n        this.collapseAll();\n        break;\n\n      case 'enter':\n        if (this.parent.isEdit || closest(e.target, '#' + this.parent.element.id + '_searchbar') !== null) {\n          return;\n        }\n\n        var element = this.focus.getFocusedElement();\n        var row = element ? element.parentElement.querySelector('[class^=\"e-record\"]') : null;\n\n        if (!row) {\n          break;\n        }\n\n        this.expandCollapseRows(row);\n        break;\n\n      case 'ctrlSpace':\n        var elem = gObj.focusModule.currentInfo.element;\n\n        if (elem && elem.classList.contains('e-headercell')) {\n          var column = gObj.getColumnByUid(elem.firstElementChild.getAttribute('e-mappinguid'));\n          column.field && gObj.groupSettings.columns.indexOf(column.field) < 0 ? this.groupColumn(column.field) : this.ungroupColumn(column.field);\n        }\n\n        break;\n    }\n  };\n\n  Group.prototype.clickHandler = function (e) {\n    this.expandCollapseRows(e.target);\n    this.applySortFromTarget(e.target);\n    this.unGroupFromTarget(e.target);\n    this.toogleGroupFromHeader(e.target);\n  };\n\n  Group.prototype.unGroupFromTarget = function (target) {\n    if (target.classList.contains('e-ungroupbutton')) {\n      this.ungroupColumn(target.parentElement.getAttribute('ej-mappingname'));\n    }\n  };\n\n  Group.prototype.toogleGroupFromHeader = function (target) {\n    if (this.groupSettings.showToggleButton) {\n      if (target.classList.contains('e-grptogglebtn')) {\n        if (target.classList.contains('e-toggleungroup')) {\n          this.ungroupColumn(this.parent.getColumnByUid(target.parentElement.getAttribute('e-mappinguid')).field);\n        } else {\n          this.groupColumn(this.parent.getColumnByUid(target.parentElement.getAttribute('e-mappinguid')).field);\n        }\n      } else {\n        if (target.classList.contains('e-toggleungroup')) {\n          this.ungroupColumn(target.parentElement.getAttribute('ej-mappingname'));\n        }\n      }\n    }\n  };\n\n  Group.prototype.applySortFromTarget = function (target) {\n    var gObj = this.parent;\n    var gHeader = closest(target, '.e-groupheadercell');\n\n    if (gObj.allowSorting && gHeader && !target.classList.contains('e-ungroupbutton') && !target.classList.contains('e-toggleungroup')) {\n      var field = gHeader.firstElementChild.getAttribute('ej-mappingname');\n\n      if (gObj.getColumnHeaderByField(field).querySelectorAll('.e-ascending').length) {\n        gObj.sortColumn(field, 'Descending', true);\n      } else {\n        gObj.sortColumn(field, 'Ascending', true);\n      }\n    }\n  };\n  /**\n   * Expands or collapses grouped rows by target element.\n   * @param  {Element} target - Defines the target element of the grouped row.\n   * @return {void}\n   */\n\n\n  Group.prototype.expandCollapseRows = function (target) {\n    var trgt = parentsUntil(target, 'e-recordplusexpand') || parentsUntil(target, 'e-recordpluscollapse');\n\n    if (trgt) {\n      var cellIdx = trgt.cellIndex;\n      var rowIdx = trgt.parentElement.rowIndex;\n      var rowNodes = this.parent.getContentTable().querySelector('tbody').children;\n      var rows = [].slice.call(rowNodes).slice(rowIdx + 1, rowNodes.length);\n      var isHide = void 0;\n      var expandElem = void 0;\n      var dataManager = void 0;\n      var query = void 0;\n      var toExpand = [];\n      var gObj = this.parent;\n      var indent = trgt.parentElement.querySelectorAll('.e-indentcell').length;\n      var expand = false;\n\n      if (isBlazor() && this.parent.isCollapseStateEnabled()) {\n        this.parent.notify('group-expand-collapse', {\n          uid: trgt.parentElement.getAttribute('data-uid'),\n          isExpand: trgt.classList.contains('e-recordpluscollapse')\n        });\n        return;\n      }\n\n      if (trgt.classList.contains('e-recordpluscollapse')) {\n        addClass([trgt], 'e-recordplusexpand');\n        removeClass([trgt], 'e-recordpluscollapse');\n        trgt.firstElementChild.className = 'e-icons e-gdiagonaldown e-icon-gdownarrow';\n        expand = true;\n\n        if (isGroupAdaptive(gObj)) {\n          this.updateVirtualRows(gObj, target, expand, query, dataManager);\n        }\n\n        if (this.parent.groupSettings.enableLazyLoading) {\n          this.parent.contentModule.captionExpand(trgt.parentElement);\n        }\n      } else {\n        isHide = true;\n        removeClass([trgt], 'e-recordplusexpand');\n        addClass([trgt], 'e-recordpluscollapse');\n        trgt.firstElementChild.className = 'e-icons e-gnextforward e-icon-grightarrow';\n\n        if (isGroupAdaptive(gObj)) {\n          this.updateVirtualRows(gObj, target, !isHide, query, dataManager);\n        }\n\n        if (this.parent.groupSettings.enableLazyLoading) {\n          this.parent.contentModule.captionCollapse(trgt.parentElement);\n        }\n      }\n\n      this.aria.setExpand(trgt, expand);\n\n      if (!isGroupAdaptive(gObj) && !this.parent.groupSettings.enableLazyLoading) {\n        for (var i = 0, len = rows.length; i < len; i++) {\n          if (rows[i].querySelectorAll('td')[cellIdx] && rows[i].querySelectorAll('td')[cellIdx].classList.contains('e-indentcell') && rows) {\n            if (isHide) {\n              rows[i].style.display = 'none';\n            } else {\n              if (rows[i].querySelectorAll('.e-indentcell').length === indent + 1) {\n                rows[i].style.display = '';\n                expandElem = rows[i].querySelector('.e-recordplusexpand');\n\n                if (expandElem) {\n                  toExpand.push(expandElem);\n                }\n\n                if (rows[i].classList.contains('e-detailrow')) {\n                  if (rows[i - 1].querySelectorAll('.e-detailrowcollapse').length) {\n                    rows[i].style.display = 'none';\n                  }\n                }\n              }\n            }\n          } else {\n            break;\n          }\n        }\n      }\n\n      for (var i = 0, len = toExpand.length; i < len; i++) {\n        removeClass([toExpand[i]], 'e-recordplusexpand');\n        addClass([toExpand[i]], 'e-recordpluscollapse');\n        toExpand[i].firstElementChild.className = 'e-icons e-gnextforward e-icon-grightarrow';\n        this.expandCollapseRows(toExpand[i]);\n      }\n    }\n  };\n\n  Group.prototype.updateVirtualRows = function (gObj, target, isExpand, query, dataManager) {\n    var rObj = gObj.getRowObjectFromUID(target.closest('tr').getAttribute('data-uid'));\n    rObj.isExpand = isExpand;\n    updatecloneRow(gObj);\n    query = gObj.getDataModule().generateQuery(false);\n    query.queries = gObj.getDataModule().aggregateQuery(gObj.getQuery().clone()).queries;\n    var args = {\n      requestType: 'virtualscroll',\n      rowObject: rObj\n    };\n    dataManager = gObj.getDataModule().getData(args, query.requiresCount());\n    dataManager.then(function (e) {\n      return gObj.renderModule.dataManagerSuccess(e, args);\n    });\n  };\n\n  Group.prototype.expandCollapse = function (isExpand) {\n    if (isBlazor() && this.parent.isCollapseStateEnabled()) {\n      this.parent.notify('group-expand-collapse', {\n        isExpand: isExpand\n      });\n      return;\n    }\n\n    if (!isExpand) {\n      this.parent.notify(events.initialCollapse, isExpand);\n    }\n\n    var rowNodes = this.parent.getContentTable().querySelector('tbody').children;\n    var row;\n\n    for (var i = 0, len = rowNodes.length; i < len; i++) {\n      if (rowNodes[i].querySelectorAll('.e-recordplusexpand, .e-recordpluscollapse').length) {\n        row = rowNodes[i].querySelector(isExpand ? '.e-recordpluscollapse' : '.e-recordplusexpand');\n\n        if (row) {\n          row.className = isExpand ? 'e-recordplusexpand' : 'e-recordpluscollapse';\n          row.firstElementChild.className = isExpand ? 'e-icons e-gdiagonaldown e-icon-gdownarrow' : 'e-icons e-gnextforward e-icon-grightarrow';\n        }\n\n        if (!(rowNodes[i].firstElementChild.classList.contains('e-recordplusexpand') || rowNodes[i].firstElementChild.classList.contains('e-recordpluscollapse'))) {\n          rowNodes[i].style.display = isExpand ? '' : 'none';\n        }\n      } else {\n        rowNodes[i].style.display = isExpand ? '' : 'none';\n      }\n    }\n  };\n  /**\n   * Expands all the grouped rows of the Grid.\n   * @return {void}\n   */\n\n\n  Group.prototype.expandAll = function () {\n    this.expandCollapse(true);\n  };\n  /**\n   * Collapses all the grouped rows of the Grid.\n   * @return {void}\n   */\n\n\n  Group.prototype.collapseAll = function () {\n    this.expandCollapse(false);\n  };\n  /**\n   * The function is used to render grouping\n   * @return {Element}\n   * @hidden\n   */\n\n\n  Group.prototype.render = function () {\n    this.l10n = this.serviceLocator.getService('localization');\n    this.renderGroupDropArea();\n    this.initDragAndDrop();\n    this.refreshToggleBtn();\n  };\n\n  Group.prototype.renderGroupDropArea = function () {\n    var groupElem = this.parent.element.querySelector('.e-groupdroparea');\n\n    if (groupElem) {\n      remove(groupElem);\n    }\n\n    this.element = this.parent.createElement('div', {\n      className: 'e-groupdroparea',\n      attrs: {\n        'tabindex': '-1'\n      }\n    });\n\n    if (this.groupSettings.allowReordering) {\n      this.element.classList.add('e-group-animate');\n    }\n\n    this.updateGroupDropArea();\n    this.parent.element.insertBefore(this.element, this.parent.element.firstChild);\n\n    if (!this.groupSettings.showDropArea) {\n      this.element.style.display = 'none';\n    }\n  };\n\n  Group.prototype.updateGroupDropArea = function (clear) {\n    if (this.groupSettings.showDropArea && !this.groupSettings.columns.length) {\n      var dragLabel = this.l10n.getConstant('GroupDropArea');\n      this.element.innerHTML = dragLabel;\n      this.element.classList.remove('e-grouped');\n    } else {\n      if (this.element.innerHTML === this.l10n.getConstant('GroupDropArea') && (this.groupSettings.columns.length === 1 || !this.isAppliedGroup && !this.isAppliedUnGroup) || clear) {\n        this.element.innerHTML = '';\n      }\n\n      this.element.classList.add('e-grouped');\n    }\n  };\n\n  Group.prototype.initDragAndDrop = function () {\n    this.initializeGHeaderDrop();\n    this.initializeGHeaderDrag();\n  };\n\n  Group.prototype.initializeGHeaderDrag = function () {\n    var drag = new Draggable(this.element, {\n      dragTarget: this.groupSettings.allowReordering ? '.e-drag' : '.e-groupheadercell',\n      distance: this.groupSettings.allowReordering ? -10 : 5,\n      helper: this.helper,\n      dragStart: this.dragStart,\n      drag: this.drag,\n      dragStop: this.dragStop\n    });\n  };\n\n  Group.prototype.initializeGHeaderDrop = function () {\n    var gObj = this.parent;\n    var drop = new Droppable(this.element, {\n      accept: '.e-dragclone',\n      drop: this.drop\n    });\n  };\n  /**\n   * Groups a column by column name.\n   * @param  {string} columnName - Defines the column name to group.\n   * @return {void}\n   */\n\n\n  Group.prototype.groupColumn = function (columnName) {\n    var gObj = this.parent;\n    var column = gObj.getColumnByField(columnName);\n\n    if (isNullOrUndefined(column) || column.allowGrouping === false || this.contentRefresh && this.groupSettings.columns.indexOf(columnName) > -1) {\n      this.parent.log('action_disabled_column', {\n        moduleName: this.getModuleName(),\n        columnName: column.headerText\n      });\n      return;\n    }\n\n    if (isActionPrevent(gObj)) {\n      gObj.notify(events.preventBatch, {\n        instance: this,\n        handler: this.groupColumn,\n        arg1: columnName\n      });\n      return;\n    }\n\n    column.visible = gObj.groupSettings.showGroupedColumn;\n    this.colName = columnName;\n    this.isAppliedGroup = true;\n\n    if (this.contentRefresh) {\n      this.updateModel();\n    } else {\n      this.addColToGroupDrop(columnName);\n    }\n\n    this.updateGroupDropArea();\n    this.isAppliedGroup = false;\n  };\n  /**\n   * Ungroups a column by column name.\n   * @param  {string} columnName - Defines the column name to ungroup.\n   * @return {void}\n   */\n\n\n  Group.prototype.ungroupColumn = function (columnName) {\n    var gObj = this.parent;\n    var column = this.parent.enableColumnVirtualization ? this.parent.columns.filter(function (c) {\n      return c.field === columnName;\n    })[0] : gObj.getColumnByField(columnName);\n\n    if (isNullOrUndefined(column) || column.allowGrouping === false || this.groupSettings.columns.indexOf(columnName) < 0) {\n      return;\n    }\n\n    if (isActionPrevent(gObj)) {\n      gObj.notify(events.preventBatch, {\n        instance: this,\n        handler: this.ungroupColumn,\n        arg1: columnName\n      });\n      return;\n    }\n\n    column.visible = true;\n\n    if (isBlazor() && gObj.isServerRendered) {\n      var setVisible = [];\n      setVisible[0] = column;\n      this.parent.notify('setvisibility', setVisible);\n    }\n\n    this.colName = column.field;\n    var columns = JSON.parse(JSON.stringify(this.groupSettings.columns));\n    columns.splice(columns.indexOf(this.colName), 1);\n\n    if (this.sortedColumns.indexOf(columnName) < 0) {\n      for (var i = 0, len = gObj.sortSettings.columns.length; i < len; i++) {\n        if (columnName === gObj.sortSettings.columns[i].field) {\n          gObj.sortSettings.columns.splice(i, 1);\n          break;\n        }\n      }\n    }\n\n    var isServerRendered = 'isServerRendered';\n\n    if (isBlazor() && this.parent[isServerRendered]) {\n      gObj.sortSettings.columns = gObj.sortSettings.columns;\n    }\n\n    if (this.groupSettings.allowReordering) {\n      this.reorderingColumns = columns;\n    }\n\n    this.groupSettings.columns = columns;\n\n    if (gObj.allowGrouping) {\n      this.isAppliedUnGroup = true;\n      this.parent.dataBind();\n    }\n  };\n  /**\n   * The function used to update groupSettings\n   * @return {void}\n   * @hidden\n   */\n\n\n  Group.prototype.updateModel = function () {\n    var gObj = this.parent;\n    var i = 0;\n    var columns = JSON.parse(JSON.stringify(this.groupSettings.columns));\n    columns = this.reorderingColumns.length ? JSON.parse(JSON.stringify(this.reorderingColumns)) : columns;\n\n    if (this.sortRequired) {\n      if (columns.indexOf(this.colName) === -1) {\n        columns.push(this.colName);\n      }\n\n      this.groupAddSortingQuery(this.colName);\n    }\n\n    this.sortRequired = true;\n    this.parent.groupSettings.columns = columns;\n    this.parent.dataBind();\n  };\n  /**\n   * The function used to trigger onActionComplete\n   * @return {void}\n   * @hidden\n   */\n\n\n  Group.prototype.onActionComplete = function (e) {\n    if (isBlazor() && !this.parent.isJsComponent) {\n      e.rows = null;\n    }\n\n    var gObj = this.parent;\n\n    if (e.requestType === 'grouping') {\n      this.addColToGroupDrop(this.colName);\n    } else {\n      this.removeColFromGroupDrop(this.colName);\n    }\n\n    var args = this.groupSettings.columns.indexOf(this.colName) > -1 ? {\n      columnName: this.colName,\n      requestType: 'grouping',\n      type: events.actionComplete\n    } : {\n      requestType: 'ungrouping',\n      type: events.actionComplete\n    };\n    this.parent.trigger(events.actionComplete, extend(e, args));\n    this.colName = null;\n  };\n\n  Group.prototype.groupAddSortingQuery = function (colName) {\n    var i = 0;\n\n    while (i < this.parent.sortSettings.columns.length) {\n      if (this.parent.sortSettings.columns[i].field === colName) {\n        break;\n      }\n\n      i++;\n    }\n\n    if (this.parent.sortSettings.columns.length === i) {\n      this.parent.sortSettings.columns.push({\n        field: colName,\n        direction: 'Ascending',\n        isFromGroup: true\n      });\n      var isServerRendered = 'isServerRendered';\n\n      if (isBlazor() && this.parent[isServerRendered]) {\n        this.parent.sortSettings.columns = this.parent.sortSettings.columns;\n      }\n    } else if (!this.parent.allowSorting) {\n      this.parent.sortSettings.columns[i].direction = 'Ascending';\n    }\n  };\n\n  Group.prototype.createElement = function (field) {\n    var gObj = this.parent;\n    var direction = 'Ascending';\n    var animator = this.parent.createElement('div', {\n      className: 'e-grid-icon e-group-animator'\n    });\n    var groupedColumn = this.parent.createElement('div', {\n      className: 'e-grid-icon e-groupheadercell'\n    });\n    var childDiv = this.parent.createElement('div', {\n      attrs: {\n        'ej-mappingname': field\n      }\n    });\n    var column = this.parent.getColumnByField(field); //Todo headerTemplateID for grouped column, disableHtmlEncode                          \n\n    var headerCell = gObj.getColumnHeaderByUid(column.uid); // if (!isNullOrUndefined(column.headerTemplate)) {\n    //     if (column.headerTemplate.indexOf('#') !== -1) {\n    //         childDiv.innerHTML = document.querySelector(column.headerTemplate).innerHTML.trim();\n    //     } else {\n    //         childDiv.innerHTML = column.headerTemplate;\n    //     }\n    //     childDiv.firstElementChild.classList.add('e-grouptext');\n    // } else {\n\n    if (this.groupSettings.allowReordering) {\n      childDiv.appendChild(this.parent.createElement('span', {\n        className: 'e-drag e-icons e-icon-drag',\n        innerHTML: '&nbsp;',\n        attrs: {\n          title: 'Drag',\n          tabindex: '-1',\n          'aria-label': 'Drag the grouped column'\n        }\n      }));\n    }\n\n    childDiv.appendChild(this.parent.createElement('span', {\n      className: 'e-grouptext',\n      innerHTML: column.headerText,\n      attrs: {\n        tabindex: '-1',\n        'aria-label': 'sort the grouped column'\n      }\n    })); // }\n\n    if (this.groupSettings.showToggleButton) {\n      childDiv.appendChild(this.parent.createElement('span', {\n        className: 'e-togglegroupbutton e-icons e-icon-ungroup e-toggleungroup',\n        innerHTML: '&nbsp;',\n        attrs: {\n          tabindex: '-1',\n          'aria-label': 'ungroup button'\n        }\n      }));\n    }\n\n    if (headerCell.querySelectorAll('.e-ascending,.e-descending').length) {\n      direction = headerCell.querySelector('.e-ascending') ? 'Ascending' : 'Descending';\n    }\n\n    childDiv.appendChild(this.parent.createElement('span', {\n      className: 'e-groupsort e-icons ' + ('e-' + direction.toLowerCase() + ' e-icon-' + direction.toLowerCase()),\n      innerHTML: '&nbsp;',\n      attrs: {\n        tabindex: '-1',\n        'aria-label': 'sort the grouped column'\n      }\n    }));\n    childDiv.appendChild(this.parent.createElement('span', {\n      className: 'e-ungroupbutton e-icons e-icon-hide',\n      innerHTML: '&nbsp;',\n      attrs: {\n        title: isBlazor() ? this.l10n.getConstant('UnGroupButton') : this.l10n.getConstant('UnGroup'),\n        tabindex: '-1',\n        'aria-label': 'ungroup the grouped column'\n      },\n      styles: this.groupSettings.showUngroupButton ? '' : 'display:none'\n    }));\n    groupedColumn.appendChild(childDiv);\n    var index = this.groupSettings.columns.indexOf(field);\n\n    if (this.groupSettings.allowReordering) {\n      animator.appendChild(groupedColumn);\n      animator.appendChild(this.createSeparator());\n      groupedColumn = animator;\n    }\n\n    return groupedColumn;\n  };\n\n  Group.prototype.addColToGroupDrop = function (field) {\n    if (this.groupSettings.allowReordering && this.parent.element.querySelector('.e-groupdroparea div[ej-mappingname=' + field + ']')) {\n      return;\n    }\n\n    var column = this.parent.getColumnByField(field);\n\n    if (isNullOrUndefined(column)) {\n      return;\n    }\n\n    var groupedColumn = this.createElement(field);\n\n    if (this.groupSettings.allowReordering) {\n      var index = this.element.querySelectorAll('.e-group-animator').length;\n      groupedColumn.setAttribute('index', index.toString());\n    }\n\n    this.element.appendChild(groupedColumn); //Todo:  rtl \n  };\n\n  Group.prototype.createSeparator = function () {\n    return this.parent.createElement('span', {\n      className: 'e-nextgroup e-icons e-icon-next',\n      innerHTML: '&nbsp;',\n      attrs: {\n        tabindex: '-1',\n        'aria-label': 'Separator for the grouped columns'\n      },\n      styles: this.groupSettings.showUngroupButton ? '' : 'display:none'\n    });\n  };\n\n  Group.prototype.refreshToggleBtn = function (isRemove) {\n    if (this.groupSettings.showToggleButton) {\n      var headers = [].slice.call(this.parent.getHeaderTable().getElementsByClassName('e-headercelldiv'));\n\n      for (var i = 0, len = headers.length; i < len; i++) {\n        if (!(headers[i].classList.contains('e-emptycell') || headers[i].classList.contains('e-headerchkcelldiv'))) {\n          var column = this.parent.getColumnByUid(headers[i].getAttribute('e-mappinguid'));\n\n          if (!this.parent.showColumnMenu || this.parent.showColumnMenu && !column.showColumnMenu) {\n            if (headers[i].querySelectorAll('.e-grptogglebtn').length) {\n              remove(headers[i].querySelectorAll('.e-grptogglebtn')[0]);\n            }\n\n            if (!isRemove) {\n              headers[i].appendChild(this.parent.createElement('span', {\n                className: 'e-grptogglebtn e-icons ' + (this.groupSettings.columns.indexOf(column.field) > -1 ? 'e-toggleungroup e-icon-ungroup' : 'e-togglegroup e-icon-group'),\n                attrs: {\n                  tabindex: '-1',\n                  'aria-label': 'Group button'\n                }\n              }));\n            }\n          }\n        }\n      }\n    }\n  };\n\n  Group.prototype.removeColFromGroupDrop = function (field) {\n    if (!isNullOrUndefined(this.getGHeaderCell(field))) {\n      var elem = this.getGHeaderCell(field);\n\n      if (this.groupSettings.allowReordering) {\n        var parent_1 = parentsUntil(elem, 'e-group-animator');\n        remove(parent_1);\n      } else {\n        remove(elem);\n      }\n\n      this.updateGroupDropArea();\n    }\n\n    this.isAppliedUnGroup = false;\n  };\n\n  Group.prototype.onPropertyChanged = function (e) {\n    if (e.module !== this.getModuleName()) {\n      return;\n    }\n\n    for (var _i = 0, _a = Object.keys(e.properties); _i < _a.length; _i++) {\n      var prop = _a[_i];\n\n      switch (prop) {\n        case 'columns':\n          var args = void 0;\n\n          if (this.contentRefresh) {\n            if (!this.isAppliedUnGroup) {\n              if (!this.isAppliedGroup) {\n                this.updateGroupDropArea(true);\n\n                for (var j = 0; j < this.parent.sortSettings.columns.length; j++) {\n                  if (this.parent.sortSettings.columns[j].isFromGroup) {\n                    this.parent.sortSettings.columns.splice(j, 1);\n                    j--;\n                  }\n                }\n\n                for (var i = 0; i < this.groupSettings.columns.length; i++) {\n                  this.colName = this.groupSettings.columns[i];\n                  var col = this.parent.getColumnByField(this.colName);\n                  col.visible = this.parent.groupSettings.showGroupedColumn;\n                  this.groupAddSortingQuery(this.colName);\n\n                  if (i < this.groupSettings.columns.length - 1) {\n                    this.addColToGroupDrop(this.groupSettings.columns[i]);\n                  }\n                }\n              }\n\n              args = {\n                columnName: this.colName,\n                requestType: e.properties[prop].length ? 'grouping' : 'ungrouping',\n                type: events.actionBegin\n              };\n            } else {\n              args = {\n                columnName: this.colName,\n                requestType: 'ungrouping',\n                type: events.actionBegin\n              };\n            }\n\n            if (!this.groupSettings.showGroupedColumn) {\n              var columns = e.oldProperties[prop];\n\n              for (var i = 0; i < columns.length; i++) {\n                if (e.properties[prop].indexOf(columns[i]) === -1) {\n                  this.parent.getColumnByField(columns[i]).visible = true;\n                }\n              }\n            }\n\n            var requestType = 'requestType';\n\n            if (isBlazor() && this.parent.isServerRendered && this.parent.isCollapseStateEnabled() && args[requestType] === 'grouping') {\n              this.parent.refreshHeader();\n            }\n\n            this.parent.notify(events.modelChanged, args);\n          }\n\n          break;\n\n        case 'showDropArea':\n          this.updateGroupDropArea();\n          this.groupSettings.showDropArea ? this.element.style.display = '' : this.element.style.display = 'none';\n          break;\n\n        case 'showGroupedColumn':\n          this.updateGroupedColumn(this.groupSettings.showGroupedColumn);\n          this.parent.notify(events.modelChanged, {\n            requestType: 'refresh'\n          });\n          break;\n\n        case 'showUngroupButton':\n          this.updateButtonVisibility(this.groupSettings.showUngroupButton, 'e-ungroupbutton');\n          break;\n\n        case 'showToggleButton':\n          this.updateButtonVisibility(this.groupSettings.showToggleButton, 'e-togglegroupbutton ');\n          this.parent.refreshHeader();\n          break;\n\n        case 'enableLazyLoading':\n          this.parent.freezeRefresh();\n          break;\n      }\n    }\n  };\n\n  Group.prototype.updateGroupedColumn = function (isVisible) {\n    for (var i = 0; i < this.groupSettings.columns.length; i++) {\n      this.parent.getColumnByField(this.groupSettings.columns[i]).visible = isVisible;\n    }\n  };\n\n  Group.prototype.updateButtonVisibility = function (isVisible, className) {\n    var gHeader = [].slice.call(this.element.querySelectorAll('.' + className));\n\n    for (var i = 0; i < gHeader.length; i++) {\n      gHeader[i].style.display = isVisible ? '' : 'none';\n    }\n  };\n\n  Group.prototype.enableAfterRender = function (e) {\n    if (e.module === this.getModuleName() && e.enable) {\n      this.render();\n    }\n  };\n  /**\n   * To destroy the reorder\n   * @return {void}\n   * @hidden\n   */\n\n\n  Group.prototype.destroy = function () {\n    var gridElement = this.parent.element;\n\n    if (!gridElement || !gridElement.querySelector('.e-gridheader') && !gridElement.querySelector('.e-gridcontent')) {\n      return;\n    } // tslint:disable-next-line:no-any\n\n\n    if (!this.parent.isDestroyed && !this.parent.refreshing) {\n      this.clearGrouping();\n    }\n\n    this.removeEventListener();\n    this.refreshToggleBtn(true);\n    remove(this.element); //call ejdrag and drop destroy\n  };\n  /**\n   * Clears all the grouped columns of the Grid.\n   * @return {void}\n   */\n\n\n  Group.prototype.clearGrouping = function () {\n    var cols = JSON.parse(JSON.stringify(this.groupSettings.columns));\n    this.contentRefresh = false;\n\n    for (var i = 0, len = cols.length; i < len; i++) {\n      if (i === len - 1) {\n        this.contentRefresh = true;\n      }\n\n      this.ungroupColumn(cols[i]);\n    }\n\n    this.contentRefresh = true;\n  };\n  /**\n   * For internal use only - Get the module name.\n   * @private\n   */\n\n\n  Group.prototype.getModuleName = function () {\n    return 'group';\n  };\n\n  Group.prototype.refreshSortIcons = function (e) {\n    var gObj = this.parent;\n    var header;\n    var cols = gObj.sortSettings.columns;\n    var gCols = gObj.groupSettings.columns;\n    var fieldNames = this.parent.getColumns().map(function (c) {\n      return c.field;\n    });\n    this.refreshToggleBtn();\n\n    for (var i = 0, len = cols.length; i < len; i++) {\n      if (fieldNames.indexOf(cols[i].field) === -1) {\n        continue;\n      }\n\n      header = gObj.getColumnHeaderByField(cols[i].field);\n\n      if (!gObj.allowSorting && (this.sortedColumns.indexOf(cols[i].field) > -1 || this.groupSettings.columns.indexOf(cols[i].field) > -1)) {\n        classList(header.querySelector('.e-sortfilterdiv'), ['e-ascending', 'e-icon-ascending'], []);\n\n        if (cols.length > 1) {\n          header.querySelector('.e-headercelldiv').appendChild(this.parent.createElement('span', {\n            className: 'e-sortnumber',\n            innerHTML: (i + 1).toString()\n          }));\n        }\n      } else if (this.getGHeaderCell(cols[i].field) && this.getGHeaderCell(cols[i].field).querySelectorAll('.e-groupsort').length) {\n        if (cols[i].direction === 'Ascending') {\n          classList(this.getGHeaderCell(cols[i].field).querySelector('.e-groupsort'), ['e-ascending', 'e-icon-ascending'], ['e-descending', 'e-icon-descending']);\n        } else {\n          classList(this.getGHeaderCell(cols[i].field).querySelector('.e-groupsort'), ['e-descending', 'e-icon-descending'], ['e-ascending', 'e-icon-ascending']);\n        }\n      }\n    }\n\n    for (var i = 0, len = gCols.length; i < len; i++) {\n      if (fieldNames.indexOf(gCols[i]) === -1) {\n        continue;\n      }\n\n      gObj.getColumnHeaderByField(gCols[i]).setAttribute('aria-grouped', 'true');\n    }\n  };\n\n  Group.prototype.getGHeaderCell = function (field) {\n    if (this.element && this.element.querySelector('[ej-mappingname=\"' + field + '\"]')) {\n      return this.element.querySelector('[ej-mappingname=\"' + field + '\"]').parentElement;\n    }\n\n    return null;\n  };\n\n  Group.prototype.onGroupAggregates = function (editedData) {\n    var aggregates = this.iterateGroupAggregates(editedData);\n    var rowData = this.groupGenerator.generateRows(aggregates, {});\n    var summaryRows = this.parent.getRowsObject().filter(function (row) {\n      return !row.isDataRow;\n    });\n    var updateSummaryRows = rowData.filter(function (data) {\n      return !data.isDataRow;\n    });\n\n    if (this.parent.isReact) {\n      this.parent.destroyTemplate(['groupFooterTemplate', 'groupCaptionTemplate', 'footerTemplate']);\n    }\n\n    for (var i = 0; i < updateSummaryRows.length; i++) {\n      var row = updateSummaryRows[i];\n      var cells = row.cells.filter(function (cell) {\n        return cell.isDataCell;\n      });\n      var args = {\n        cells: cells,\n        data: row.data,\n        dataUid: summaryRows[i] ? summaryRows[i].uid : ''\n      };\n      this.parent.notify(events.refreshAggregateCell, args);\n    }\n  };\n\n  Group.prototype.iterateGroupAggregates = function (editedData) {\n    var updatedData = editedData instanceof Array ? editedData : [];\n    var rows = this.parent.getRowsObject();\n    var initData = this.parent.getCurrentViewRecords();\n    var deletedCols = [];\n    var changeds = rows.map(function (row) {\n      if (row.edit === 'delete') {\n        deletedCols.push(row.data);\n      }\n\n      return row.changes instanceof Object ? row.changes : row.data;\n    });\n    var field = this.parent.getPrimaryKeyFieldNames()[0];\n    changeds = updatedData.length === 0 ? changeds : updatedData;\n    var mergeData = initData.map(function (item) {\n      var pKeyVal = DataUtil.getObject(field, item);\n      var value;\n      var hasVal = changeds.some(function (cItem) {\n        value = cItem;\n        return pKeyVal === DataUtil.getObject(field, cItem);\n      });\n      return hasVal ? value : item;\n    });\n    var eData = editedData;\n\n    if (!(eData.type && eData.type === 'cancel') && deletedCols.length > 0) {\n      for (var i = 0; i < deletedCols.length; i++) {\n        var index = mergeData.indexOf(deletedCols[i]);\n        mergeData.splice(index, 1);\n      }\n    }\n\n    var aggregates = [];\n    var aggregateRows = this.parent.aggregates;\n\n    for (var j = 0; j < aggregateRows.length; j++) {\n      var row = aggregateRows[j];\n\n      for (var k = 0; k < row.columns.length; k++) {\n        var aggr = {};\n        var type = row.columns[k].type.toString();\n        aggr = {\n          type: type.toLowerCase(),\n          field: row.columns[k].field\n        };\n        aggregates.push(aggr);\n      }\n    }\n\n    var result;\n    var aggrds;\n    var groupedCols = this.parent.groupSettings.columns;\n\n    for (var l = 0; l < groupedCols.length; l++) {\n      aggrds = result ? result : mergeData;\n      result = DataUtil.group(aggrds, groupedCols[l], aggregates, null, null);\n    }\n\n    return result;\n  };\n\n  Group.prototype.updateExpand = function (args) {\n    var uid = args.uid;\n    var isExpand = args.isExpand;\n    var rows = this.parent.getRowsObject();\n\n    for (var i = 0; i < rows.length; i++) {\n      var row = rows[i];\n\n      if (row.uid === uid || isNullOrUndefined(uid)) {\n        row.isExpand = isExpand;\n\n        var _loop_1 = function (j) {\n          var childRow = rows[j];\n          var closestParent = void 0;\n\n          if (childRow.parentUid !== row.uid) {\n            closestParent = rows.filter(function (x) {\n              return x.uid === childRow.parentUid;\n            })[0];\n          }\n\n          if (childRow.parentUid === row.uid) {\n            childRow.visible = row.isExpand;\n          } else if (!isNullOrUndefined(closestParent) && childRow.parentUid === closestParent.uid) {\n            if (closestParent.isExpand && closestParent.visible === true) {\n              childRow.visible = true;\n            } else if (closestParent.isExpand && closestParent.visible === false) {\n              childRow.visible = false;\n            }\n          }\n\n          if (isNullOrUndefined(uid)) {\n            return \"break\";\n          }\n        };\n\n        for (var j = i + 1; j < rows.length; j++) {\n          var state_1 = _loop_1(j);\n\n          if (state_1 === \"break\") break;\n        }\n      }\n    }\n\n    this.parent.notify(events.contentReady, {\n      rows: rows,\n      args: {\n        isFrozen: false,\n        rows: rows\n      }\n    });\n  };\n\n  return Group;\n}();\n\nexport { Group };","map":{"version":3,"sources":["C:/Users/appsk/Documents/Projects/PredictiveMaintenance/React PDM/env/frontend/node_modules/@syncfusion/ej2-grids/src/grid/actions/group.js"],"names":["Draggable","Droppable","isBlazor","createElement","closest","remove","classList","addClass","removeClass","isNullOrUndefined","extend","parentsUntil","isActionPrevent","isGroupAdaptive","updatecloneRow","events","AriaService","GroupModelGenerator","DataUtil","Group","parent","groupSettings","sortedColumns","serviceLocator","_this","sortRequired","isAppliedGroup","isAppliedUnGroup","reorderingColumns","visualElement","className","styles","attrs","action","helper","e","gObj","target","sender","element","contains","allowReordering","column","getColumnByField","firstElementChild","getAttribute","textContent","style","width","offsetWidth","height","offsetHeight","setAttribute","uid","appendChild","dragStart","add","bindEvents","dragElement","drag","animateDropper","cloneElement","querySelector","trigger","columnDrag","draggableType","dragStop","preventDrop","rearrangeGroup","field","getColumnByUid","columns","indexOf","ungroupColumn","dragField","dropTarget","grouped","slice","call","querySelectorAll","map","cols","JSON","parse","stringify","dropField","dropIndex","dragIndex","splice","flag","push","innerHTML","length","c","addColToGroupDrop","addLabel","removeColFromGroupDrop","drop","droppedElement","aria","setDropTarget","setGrabbed","getHeaderTable","allowGrouping","getColumnHeaderByUid","log","moduleName","getModuleName","columnName","headerText","groupColumn","contentRefresh","focus","getService","addEventListener","groupGenerator","prototype","dragLabel","l10n","getConstant","updateModel","columnDragStart","dropArea","columnDrop","isDestroyed","on","uiUpdate","enableAfterRender","groupComplete","onActionComplete","ungroupComplete","inBoundModelChanged","onPropertyChanged","click","clickHandler","headerDrop","headerRefreshed","refreshSortIcons","sortComplete","keyPressed","keyPressHandler","contentReady","initialEnd","onEmpty","render","groupAggregates","onGroupAggregates","blazorActionBegin","updateExpand","removeEventListener","off","isCollapseStateEnabled","expandAll","isServerRendered","i","updateGroupDropArea","getColumns","_i","_a","col","preventDefault","selected","allowSelection","getSelectedRowIndexes","rows","getContentTable","children","dataRow","getDataRows","grpRow","rowIndex","expandCollapseRows","collapseAll","isEdit","id","getFocusedElement","row","parentElement","elem","focusModule","currentInfo","applySortFromTarget","unGroupFromTarget","toogleGroupFromHeader","showToggleButton","gHeader","allowSorting","getColumnHeaderByField","sortColumn","trgt","cellIdx","cellIndex","rowIdx","rowNodes","isHide","expandElem","dataManager","query","toExpand","indent","expand","notify","isExpand","updateVirtualRows","enableLazyLoading","contentModule","captionExpand","captionCollapse","setExpand","len","display","rObj","getRowObjectFromUID","getDataModule","generateQuery","queries","aggregateQuery","getQuery","clone","args","requestType","rowObject","getData","requiresCount","then","renderModule","dataManagerSuccess","expandCollapse","initialCollapse","renderGroupDropArea","initDragAndDrop","refreshToggleBtn","groupElem","insertBefore","firstChild","showDropArea","clear","initializeGHeaderDrop","initializeGHeaderDrag","dragTarget","distance","accept","preventBatch","instance","handler","arg1","visible","showGroupedColumn","colName","enableColumnVirtualization","filter","setVisible","sortSettings","dataBind","groupAddSortingQuery","isJsComponent","type","actionComplete","direction","isFromGroup","animator","groupedColumn","childDiv","headerCell","title","tabindex","toLowerCase","showUngroupButton","index","createSeparator","toString","isRemove","headers","getElementsByClassName","showColumnMenu","getGHeaderCell","parent_1","module","Object","keys","properties","prop","j","actionBegin","oldProperties","refreshHeader","modelChanged","updateGroupedColumn","updateButtonVisibility","freezeRefresh","isVisible","enable","destroy","gridElement","refreshing","clearGrouping","header","gCols","fieldNames","editedData","aggregates","iterateGroupAggregates","rowData","generateRows","summaryRows","getRowsObject","isDataRow","updateSummaryRows","data","isReact","destroyTemplate","cells","cell","isDataCell","dataUid","refreshAggregateCell","updatedData","Array","initData","getCurrentViewRecords","deletedCols","changeds","edit","changes","getPrimaryKeyFieldNames","mergeData","item","pKeyVal","getObject","value","hasVal","some","cItem","eData","aggregateRows","k","aggr","result","aggrds","groupedCols","l","group","_loop_1","childRow","closestParent","parentUid","x","state_1","isFrozen"],"mappings":"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","sourcesContent":["import { Draggable, Droppable, isBlazor } from '@syncfusion/ej2-base';\nimport { createElement, closest, remove, classList, addClass, removeClass } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, extend } from '@syncfusion/ej2-base';\nimport { parentsUntil, isActionPrevent, isGroupAdaptive, updatecloneRow } from '../base/util';\nimport * as events from '../base/constant';\nimport { AriaService } from '../services/aria-service';\nimport { GroupModelGenerator } from '../services/group-model-generator';\nimport { DataUtil } from '@syncfusion/ej2-data';\n/**\n *\n * The `Group` module is used to handle group action.\n */\nvar Group = /** @class */ (function () {\n    /**\n     * Constructor for Grid group module\n     * @hidden\n     */\n    function Group(parent, groupSettings, sortedColumns, serviceLocator) {\n        var _this = this;\n        //Internal variables\n        this.sortRequired = true;\n        this.isAppliedGroup = false;\n        this.isAppliedUnGroup = false;\n        this.reorderingColumns = [];\n        this.visualElement = createElement('div', {\n            className: 'e-cloneproperties e-dragclone e-gdclone',\n            styles: 'line-height:23px', attrs: { action: 'grouping' }\n        });\n        this.helper = function (e) {\n            var gObj = _this.parent;\n            var target = e.sender.target;\n            var element = target.classList.contains('e-groupheadercell') ? target :\n                parentsUntil(target, 'e-groupheadercell');\n            if (!element || (!target.classList.contains('e-drag') && _this.groupSettings.allowReordering)) {\n                return false;\n            }\n            _this.column = gObj.getColumnByField(element.firstElementChild.getAttribute('ej-mappingname'));\n            _this.visualElement.textContent = element.textContent;\n            _this.visualElement.style.width = element.offsetWidth + 2 + 'px';\n            _this.visualElement.style.height = element.offsetHeight + 2 + 'px';\n            _this.visualElement.setAttribute('e-mappinguid', _this.column.uid);\n            gObj.element.appendChild(_this.visualElement);\n            return _this.visualElement;\n        };\n        this.dragStart = function (e) {\n            _this.parent.element.classList.add('e-ungroupdrag');\n            if (isBlazor()) {\n                e.bindEvents(e.dragElement);\n            }\n        };\n        this.drag = function (e) {\n            if (_this.groupSettings.allowReordering) {\n                _this.animateDropper(e);\n            }\n            var target = e.target;\n            var cloneElement = _this.parent.element.querySelector('.e-cloneproperties');\n            _this.parent.trigger(events.columnDrag, { target: target, draggableType: 'headercell', column: _this.column });\n            if (!_this.groupSettings.allowReordering) {\n                classList(cloneElement, ['e-defaultcur'], ['e-notallowedcur']);\n                if (!(parentsUntil(target, 'e-gridcontent') || parentsUntil(target, 'e-headercell'))) {\n                    classList(cloneElement, ['e-notallowedcur'], ['e-defaultcur']);\n                }\n            }\n        };\n        this.dragStop = function (e) {\n            _this.parent.element.classList.remove('e-ungroupdrag');\n            var preventDrop = !(parentsUntil(e.target, 'e-gridcontent') || parentsUntil(e.target, 'e-gridheader'));\n            if (_this.groupSettings.allowReordering && preventDrop) {\n                remove(e.helper);\n                if (parentsUntil(e.target, 'e-groupdroparea')) {\n                    _this.rearrangeGroup(e);\n                }\n                else if (!(parentsUntil(e.target, 'e-grid'))) {\n                    var field = _this.parent.getColumnByUid(e.helper.getAttribute('e-mappinguid')).field;\n                    if (_this.groupSettings.columns.indexOf(field) !== -1) {\n                        _this.ungroupColumn(field);\n                    }\n                }\n                return;\n            }\n            else if (preventDrop) {\n                remove(e.helper);\n                return;\n            }\n        };\n        this.animateDropper = function (e) {\n            var uid = _this.parent.element.querySelector('.e-cloneproperties').getAttribute('e-mappinguid');\n            var dragField = _this.parent.getColumnByUid(uid).field;\n            var parent = parentsUntil(e.target, 'e-groupdroparea');\n            var dropTarget = parentsUntil(e.target, 'e-group-animator');\n            // tslint:disable-next-line\n            var grouped = [].slice.call(_this.element.querySelectorAll('.e-groupheadercell'))\n                .map(function (e) { return e.querySelector('div').getAttribute('ej-mappingname'); });\n            var cols = JSON.parse(JSON.stringify(grouped));\n            if (dropTarget || parent) {\n                if (dropTarget) {\n                    var dropField = dropTarget.querySelector('div[ej-mappingname]').getAttribute('ej-mappingname');\n                    var dropIndex = +(dropTarget.getAttribute('index'));\n                    if (dropField !== dragField) {\n                        var dragIndex = cols.indexOf(dragField);\n                        if (dragIndex !== -1) {\n                            cols.splice(dragIndex, 1);\n                        }\n                        var flag = dropIndex !== -1 && dragIndex === dropIndex;\n                        cols.splice(dropIndex + (flag ? 1 : 0), 0, dragField);\n                    }\n                }\n                else if (parent && cols.indexOf(dragField) === -1) {\n                    cols.push(dragField);\n                }\n                _this.element.innerHTML = '';\n                if (cols.length && !_this.element.classList.contains('e-grouped')) {\n                    _this.element.classList.add('e-grouped');\n                }\n                _this.reorderingColumns = cols;\n                for (var c = 0; c < cols.length; c++) {\n                    _this.addColToGroupDrop(cols[c]);\n                }\n            }\n            else {\n                _this.addLabel();\n                _this.removeColFromGroupDrop(dragField);\n            }\n        };\n        this.drop = function (e) {\n            var gObj = _this.parent;\n            var column = gObj.getColumnByUid(e.droppedElement.getAttribute('e-mappinguid'));\n            _this.element.classList.remove('e-hover');\n            remove(e.droppedElement);\n            _this.aria.setDropTarget(_this.parent.element.querySelector('.e-groupdroparea'), false);\n            _this.aria.setGrabbed(_this.parent.getHeaderTable().querySelector('[aria-grabbed=true]'), false);\n            if (isNullOrUndefined(column) || column.allowGrouping === false ||\n                parentsUntil(gObj.getColumnHeaderByUid(column.uid), 'e-grid').getAttribute('id') !==\n                    gObj.element.getAttribute('id')) {\n                _this.parent.log('action_disabled_column', { moduleName: _this.getModuleName(), columnName: column.headerText });\n                return;\n            }\n            _this.groupColumn(column.field);\n        };\n        this.contentRefresh = true;\n        this.aria = new AriaService();\n        this.parent = parent;\n        this.groupSettings = groupSettings;\n        this.serviceLocator = serviceLocator;\n        this.sortedColumns = sortedColumns;\n        this.focus = serviceLocator.getService('focus');\n        this.addEventListener();\n        this.groupGenerator = new GroupModelGenerator(this.parent);\n    }\n    Group.prototype.addLabel = function () {\n        if (!this.element.querySelectorAll('.e-group-animator').length) {\n            var dragLabel = this.l10n.getConstant('GroupDropArea');\n            this.element.innerHTML = dragLabel;\n            this.element.classList.remove('e-grouped');\n        }\n    };\n    Group.prototype.rearrangeGroup = function (e) {\n        this.sortRequired = false;\n        this.updateModel();\n    };\n    Group.prototype.columnDrag = function (e) {\n        if (this.groupSettings.allowReordering) {\n            this.animateDropper(e);\n        }\n        var gObj = this.parent;\n        var cloneElement = this.parent.element.querySelector('.e-cloneproperties');\n        classList(cloneElement, ['e-defaultcur'], ['e-notallowedcur']);\n        if (!parentsUntil(e.target, 'e-groupdroparea') &&\n            !(this.parent.allowReordering && parentsUntil(e.target, 'e-headercell'))) {\n            classList(cloneElement, ['e-notallowedcur'], ['e-defaultcur']);\n        }\n        e.target.classList.contains('e-groupdroparea') ? this.element.classList.add('e-hover') : this.element.classList.remove('e-hover');\n    };\n    Group.prototype.columnDragStart = function (e) {\n        if (e.target.classList.contains('e-stackedheadercell')) {\n            return;\n        }\n        var gObj = this.parent;\n        var dropArea = this.parent.element.querySelector('.e-groupdroparea');\n        this.aria.setDropTarget(dropArea, e.column.allowGrouping);\n        var element = e.target.classList.contains('e-headercell') ? e.target : parentsUntil(e.target, 'e-headercell');\n        this.aria.setGrabbed(element, true, !e.column.allowGrouping);\n    };\n    Group.prototype.columnDrop = function (e) {\n        var gObj = this.parent;\n        if (e.droppedElement.getAttribute('action') === 'grouping') {\n            var column = gObj.getColumnByUid(e.droppedElement.getAttribute('e-mappinguid'));\n            if (isNullOrUndefined(column) || column.allowGrouping === false ||\n                parentsUntil(gObj.getColumnHeaderByUid(column.uid), 'e-grid').getAttribute('id') !==\n                    gObj.element.getAttribute('id')) {\n                return;\n            }\n            this.ungroupColumn(column.field);\n        }\n    };\n    /**\n     * @hidden\n     */\n    Group.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.on(events.uiUpdate, this.enableAfterRender, this);\n        this.parent.on(events.groupComplete, this.onActionComplete, this);\n        this.parent.on(events.ungroupComplete, this.onActionComplete, this);\n        this.parent.on(events.inBoundModelChanged, this.onPropertyChanged, this);\n        this.parent.on(events.click, this.clickHandler, this);\n        this.parent.on(events.columnDrag, this.columnDrag, this);\n        this.parent.on(events.columnDragStart, this.columnDragStart, this);\n        this.parent.on(events.headerDrop, this.columnDrop, this);\n        this.parent.on(events.columnDrop, this.columnDrop, this);\n        this.parent.on(events.headerRefreshed, this.refreshSortIcons, this);\n        this.parent.on(events.sortComplete, this.refreshSortIcons, this);\n        this.parent.on(events.keyPressed, this.keyPressHandler, this);\n        this.parent.on(events.contentReady, this.initialEnd, this);\n        this.parent.on(events.onEmpty, this.initialEnd, this);\n        this.parent.on(events.initialEnd, this.render, this);\n        this.parent.on(events.groupAggregates, this.onGroupAggregates, this);\n        this.parent.on('blazor-action-begin', this.blazorActionBegin, this);\n        this.parent.on('group-expand-collapse', this.updateExpand, this);\n        this.parent.on('persist-data-changed', this.initialEnd, this);\n    };\n    /**\n     * @hidden\n     */\n    Group.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off(events.initialEnd, this.render);\n        this.parent.off(events.uiUpdate, this.enableAfterRender);\n        this.parent.off(events.groupComplete, this.onActionComplete);\n        this.parent.off(events.ungroupComplete, this.onActionComplete);\n        this.parent.off(events.inBoundModelChanged, this.onPropertyChanged);\n        this.parent.off(events.click, this.clickHandler);\n        this.parent.off(events.columnDrag, this.columnDrag);\n        this.parent.off(events.columnDragStart, this.columnDragStart);\n        this.parent.off(events.columnDrop, this.columnDrop);\n        this.parent.off(events.headerDrop, this.columnDrop);\n        this.parent.off(events.headerRefreshed, this.refreshSortIcons);\n        this.parent.off(events.sortComplete, this.refreshSortIcons);\n        this.parent.off(events.keyPressed, this.keyPressHandler);\n        this.parent.off(events.groupAggregates, this.onGroupAggregates);\n        this.parent.off('blazor-action-begin', this.blazorActionBegin);\n        this.parent.off('group-expand-collapse', this.updateExpand);\n    };\n    Group.prototype.blazorActionBegin = function () {\n        if (this.parent.allowGrouping && !this.parent.isCollapseStateEnabled()) {\n            this.expandAll();\n        }\n    };\n    Group.prototype.initialEnd = function () {\n        var gObj = this.parent;\n        this.parent.off(events.contentReady, this.initialEnd);\n        this.parent.off(events.onEmpty, this.initialEnd);\n        if (isBlazor() && gObj.isServerRendered) {\n            for (var i = 0; i < gObj.columns.length; i++) {\n                this.removeColFromGroupDrop(gObj.columns[i].field);\n            }\n            this.updateGroupDropArea();\n        }\n        if (this.parent.getColumns().length && this.groupSettings.columns.length) {\n            this.contentRefresh = false;\n            for (var _i = 0, _a = gObj.groupSettings.columns; _i < _a.length; _i++) {\n                var col = _a[_i];\n                this.groupColumn(col);\n            }\n            this.contentRefresh = true;\n        }\n    };\n    Group.prototype.keyPressHandler = function (e) {\n        var gObj = this.parent;\n        if (e.action !== 'ctrlSpace' && (!this.groupSettings.columns.length ||\n            ['altDownArrow', 'altUpArrow', 'ctrlDownArrow', 'ctrlUpArrow', 'enter'].indexOf(e.action) === -1)) {\n            return;\n        }\n        e.preventDefault();\n        switch (e.action) {\n            case 'altDownArrow':\n            case 'altUpArrow':\n                var selected = gObj.allowSelection ? gObj.getSelectedRowIndexes() : [];\n                if (selected.length) {\n                    var rows = gObj.getContentTable().querySelector('tbody').children;\n                    var dataRow = gObj.getDataRows()[selected[selected.length - 1]];\n                    var grpRow = void 0;\n                    for (var i = dataRow.rowIndex; i >= 0; i--) {\n                        if (!rows[i].classList.contains('e-row') && !rows[i].classList.contains('e-detailrow')) {\n                            grpRow = rows[i];\n                            break;\n                        }\n                    }\n                    this.expandCollapseRows(grpRow.querySelector(e.action === 'altUpArrow' ?\n                        '.e-recordplusexpand' : '.e-recordpluscollapse'));\n                }\n                break;\n            case 'ctrlDownArrow':\n                this.expandAll();\n                break;\n            case 'ctrlUpArrow':\n                this.collapseAll();\n                break;\n            case 'enter':\n                if (this.parent.isEdit || (closest(e.target, '#' + this.parent.element.id + '_searchbar') !== null)) {\n                    return;\n                }\n                var element = this.focus.getFocusedElement();\n                var row = element ? element.parentElement.querySelector('[class^=\"e-record\"]') : null;\n                if (!row) {\n                    break;\n                }\n                this.expandCollapseRows(row);\n                break;\n            case 'ctrlSpace':\n                var elem = gObj.focusModule.currentInfo.element;\n                if (elem && elem.classList.contains('e-headercell')) {\n                    var column = gObj.getColumnByUid(elem.firstElementChild.getAttribute('e-mappinguid'));\n                    column.field && gObj.groupSettings.columns.indexOf(column.field) < 0 ?\n                        this.groupColumn(column.field) : this.ungroupColumn(column.field);\n                }\n                break;\n        }\n    };\n    Group.prototype.clickHandler = function (e) {\n        this.expandCollapseRows(e.target);\n        this.applySortFromTarget(e.target);\n        this.unGroupFromTarget(e.target);\n        this.toogleGroupFromHeader(e.target);\n    };\n    Group.prototype.unGroupFromTarget = function (target) {\n        if (target.classList.contains('e-ungroupbutton')) {\n            this.ungroupColumn(target.parentElement.getAttribute('ej-mappingname'));\n        }\n    };\n    Group.prototype.toogleGroupFromHeader = function (target) {\n        if (this.groupSettings.showToggleButton) {\n            if (target.classList.contains('e-grptogglebtn')) {\n                if (target.classList.contains('e-toggleungroup')) {\n                    this.ungroupColumn(this.parent.getColumnByUid(target.parentElement.getAttribute('e-mappinguid')).field);\n                }\n                else {\n                    this.groupColumn(this.parent.getColumnByUid(target.parentElement.getAttribute('e-mappinguid')).field);\n                }\n            }\n            else {\n                if (target.classList.contains('e-toggleungroup')) {\n                    this.ungroupColumn(target.parentElement.getAttribute('ej-mappingname'));\n                }\n            }\n        }\n    };\n    Group.prototype.applySortFromTarget = function (target) {\n        var gObj = this.parent;\n        var gHeader = closest(target, '.e-groupheadercell');\n        if (gObj.allowSorting && gHeader && !target.classList.contains('e-ungroupbutton') &&\n            !target.classList.contains('e-toggleungroup')) {\n            var field = gHeader.firstElementChild.getAttribute('ej-mappingname');\n            if (gObj.getColumnHeaderByField(field).querySelectorAll('.e-ascending').length) {\n                gObj.sortColumn(field, 'Descending', true);\n            }\n            else {\n                gObj.sortColumn(field, 'Ascending', true);\n            }\n        }\n    };\n    /**\n     * Expands or collapses grouped rows by target element.\n     * @param  {Element} target - Defines the target element of the grouped row.\n     * @return {void}\n     */\n    Group.prototype.expandCollapseRows = function (target) {\n        var trgt = parentsUntil(target, 'e-recordplusexpand') ||\n            parentsUntil(target, 'e-recordpluscollapse');\n        if (trgt) {\n            var cellIdx = trgt.cellIndex;\n            var rowIdx = trgt.parentElement.rowIndex;\n            var rowNodes = this.parent.getContentTable().querySelector('tbody').children;\n            var rows = [].slice.call(rowNodes).slice(rowIdx + 1, rowNodes.length);\n            var isHide = void 0;\n            var expandElem = void 0;\n            var dataManager = void 0;\n            var query = void 0;\n            var toExpand = [];\n            var gObj = this.parent;\n            var indent = trgt.parentElement.querySelectorAll('.e-indentcell').length;\n            var expand = false;\n            if (isBlazor() && this.parent.isCollapseStateEnabled()) {\n                this.parent.notify('group-expand-collapse', {\n                    uid: trgt.parentElement.getAttribute('data-uid'),\n                    isExpand: trgt.classList.contains('e-recordpluscollapse')\n                });\n                return;\n            }\n            if (trgt.classList.contains('e-recordpluscollapse')) {\n                addClass([trgt], 'e-recordplusexpand');\n                removeClass([trgt], 'e-recordpluscollapse');\n                trgt.firstElementChild.className = 'e-icons e-gdiagonaldown e-icon-gdownarrow';\n                expand = true;\n                if (isGroupAdaptive(gObj)) {\n                    this.updateVirtualRows(gObj, target, expand, query, dataManager);\n                }\n                if (this.parent.groupSettings.enableLazyLoading) {\n                    this.parent.contentModule.captionExpand(trgt.parentElement);\n                }\n            }\n            else {\n                isHide = true;\n                removeClass([trgt], 'e-recordplusexpand');\n                addClass([trgt], 'e-recordpluscollapse');\n                trgt.firstElementChild.className = 'e-icons e-gnextforward e-icon-grightarrow';\n                if (isGroupAdaptive(gObj)) {\n                    this.updateVirtualRows(gObj, target, !isHide, query, dataManager);\n                }\n                if (this.parent.groupSettings.enableLazyLoading) {\n                    this.parent.contentModule.captionCollapse(trgt.parentElement);\n                }\n            }\n            this.aria.setExpand(trgt, expand);\n            if (!isGroupAdaptive(gObj) && !this.parent.groupSettings.enableLazyLoading) {\n                for (var i = 0, len = rows.length; i < len; i++) {\n                    if (rows[i].querySelectorAll('td')[cellIdx] &&\n                        rows[i].querySelectorAll('td')[cellIdx].classList.contains('e-indentcell') && rows) {\n                        if (isHide) {\n                            rows[i].style.display = 'none';\n                        }\n                        else {\n                            if (rows[i].querySelectorAll('.e-indentcell').length === indent + 1) {\n                                rows[i].style.display = '';\n                                expandElem = rows[i].querySelector('.e-recordplusexpand');\n                                if (expandElem) {\n                                    toExpand.push(expandElem);\n                                }\n                                if (rows[i].classList.contains('e-detailrow')) {\n                                    if (rows[i - 1].querySelectorAll('.e-detailrowcollapse').length) {\n                                        rows[i].style.display = 'none';\n                                    }\n                                }\n                            }\n                        }\n                    }\n                    else {\n                        break;\n                    }\n                }\n            }\n            for (var i = 0, len = toExpand.length; i < len; i++) {\n                removeClass([toExpand[i]], 'e-recordplusexpand');\n                addClass([toExpand[i]], 'e-recordpluscollapse');\n                toExpand[i].firstElementChild.className = 'e-icons e-gnextforward e-icon-grightarrow';\n                this.expandCollapseRows(toExpand[i]);\n            }\n        }\n    };\n    Group.prototype.updateVirtualRows = function (gObj, target, isExpand, query, dataManager) {\n        var rObj = gObj.getRowObjectFromUID(target.closest('tr').getAttribute('data-uid'));\n        rObj.isExpand = isExpand;\n        updatecloneRow(gObj);\n        query = gObj.getDataModule().generateQuery(false);\n        query.queries = gObj.getDataModule().aggregateQuery(gObj.getQuery().clone()).queries;\n        var args = { requestType: 'virtualscroll', rowObject: rObj };\n        dataManager = gObj.getDataModule().getData(args, query.requiresCount());\n        dataManager.then(function (e) { return gObj.renderModule.dataManagerSuccess(e, args); });\n    };\n    Group.prototype.expandCollapse = function (isExpand) {\n        if (isBlazor() && this.parent.isCollapseStateEnabled()) {\n            this.parent.notify('group-expand-collapse', { isExpand: isExpand });\n            return;\n        }\n        if (!isExpand) {\n            this.parent.notify(events.initialCollapse, isExpand);\n        }\n        var rowNodes = this.parent.getContentTable().querySelector('tbody').children;\n        var row;\n        for (var i = 0, len = rowNodes.length; i < len; i++) {\n            if (rowNodes[i].querySelectorAll('.e-recordplusexpand, .e-recordpluscollapse').length) {\n                row = rowNodes[i].querySelector(isExpand ? '.e-recordpluscollapse' : '.e-recordplusexpand');\n                if (row) {\n                    row.className = isExpand ? 'e-recordplusexpand' : 'e-recordpluscollapse';\n                    row.firstElementChild.className = isExpand ? 'e-icons e-gdiagonaldown e-icon-gdownarrow' :\n                        'e-icons e-gnextforward e-icon-grightarrow';\n                }\n                if (!(rowNodes[i].firstElementChild.classList.contains('e-recordplusexpand') ||\n                    rowNodes[i].firstElementChild.classList.contains('e-recordpluscollapse'))) {\n                    rowNodes[i].style.display = isExpand ? '' : 'none';\n                }\n            }\n            else {\n                rowNodes[i].style.display = isExpand ? '' : 'none';\n            }\n        }\n    };\n    /**\n     * Expands all the grouped rows of the Grid.\n     * @return {void}\n     */\n    Group.prototype.expandAll = function () {\n        this.expandCollapse(true);\n    };\n    /**\n     * Collapses all the grouped rows of the Grid.\n     * @return {void}\n     */\n    Group.prototype.collapseAll = function () {\n        this.expandCollapse(false);\n    };\n    /**\n     * The function is used to render grouping\n     * @return {Element}\n     * @hidden\n     */\n    Group.prototype.render = function () {\n        this.l10n = this.serviceLocator.getService('localization');\n        this.renderGroupDropArea();\n        this.initDragAndDrop();\n        this.refreshToggleBtn();\n    };\n    Group.prototype.renderGroupDropArea = function () {\n        var groupElem = this.parent.element.querySelector('.e-groupdroparea');\n        if (groupElem) {\n            remove(groupElem);\n        }\n        this.element = this.parent.createElement('div', { className: 'e-groupdroparea', attrs: { 'tabindex': '-1' } });\n        if (this.groupSettings.allowReordering) {\n            this.element.classList.add('e-group-animate');\n        }\n        this.updateGroupDropArea();\n        this.parent.element.insertBefore(this.element, this.parent.element.firstChild);\n        if (!this.groupSettings.showDropArea) {\n            this.element.style.display = 'none';\n        }\n    };\n    Group.prototype.updateGroupDropArea = function (clear) {\n        if (this.groupSettings.showDropArea && !this.groupSettings.columns.length) {\n            var dragLabel = this.l10n.getConstant('GroupDropArea');\n            this.element.innerHTML = dragLabel;\n            this.element.classList.remove('e-grouped');\n        }\n        else {\n            if ((this.element.innerHTML === this.l10n.getConstant('GroupDropArea') && (this.groupSettings.columns.length === 1\n                || !this.isAppliedGroup && !this.isAppliedUnGroup)) || clear) {\n                this.element.innerHTML = '';\n            }\n            this.element.classList.add('e-grouped');\n        }\n    };\n    Group.prototype.initDragAndDrop = function () {\n        this.initializeGHeaderDrop();\n        this.initializeGHeaderDrag();\n    };\n    Group.prototype.initializeGHeaderDrag = function () {\n        var drag = new Draggable(this.element, {\n            dragTarget: this.groupSettings.allowReordering ? '.e-drag' : '.e-groupheadercell',\n            distance: this.groupSettings.allowReordering ? -10 : 5,\n            helper: this.helper,\n            dragStart: this.dragStart,\n            drag: this.drag,\n            dragStop: this.dragStop\n        });\n    };\n    Group.prototype.initializeGHeaderDrop = function () {\n        var gObj = this.parent;\n        var drop = new Droppable(this.element, {\n            accept: '.e-dragclone',\n            drop: this.drop\n        });\n    };\n    /**\n     * Groups a column by column name.\n     * @param  {string} columnName - Defines the column name to group.\n     * @return {void}\n     */\n    Group.prototype.groupColumn = function (columnName) {\n        var gObj = this.parent;\n        var column = gObj.getColumnByField(columnName);\n        if (isNullOrUndefined(column) || column.allowGrouping === false ||\n            (this.contentRefresh && this.groupSettings.columns.indexOf(columnName) > -1)) {\n            this.parent.log('action_disabled_column', { moduleName: this.getModuleName(), columnName: column.headerText });\n            return;\n        }\n        if (isActionPrevent(gObj)) {\n            gObj.notify(events.preventBatch, { instance: this, handler: this.groupColumn, arg1: columnName });\n            return;\n        }\n        column.visible = gObj.groupSettings.showGroupedColumn;\n        this.colName = columnName;\n        this.isAppliedGroup = true;\n        if (this.contentRefresh) {\n            this.updateModel();\n        }\n        else {\n            this.addColToGroupDrop(columnName);\n        }\n        this.updateGroupDropArea();\n        this.isAppliedGroup = false;\n    };\n    /**\n     * Ungroups a column by column name.\n     * @param  {string} columnName - Defines the column name to ungroup.\n     * @return {void}\n     */\n    Group.prototype.ungroupColumn = function (columnName) {\n        var gObj = this.parent;\n        var column = this.parent.enableColumnVirtualization ?\n            this.parent.columns.filter(function (c) { return c.field === columnName; })[0] : gObj.getColumnByField(columnName);\n        if (isNullOrUndefined(column) || column.allowGrouping === false || this.groupSettings.columns.indexOf(columnName) < 0) {\n            return;\n        }\n        if (isActionPrevent(gObj)) {\n            gObj.notify(events.preventBatch, { instance: this, handler: this.ungroupColumn, arg1: columnName });\n            return;\n        }\n        column.visible = true;\n        if (isBlazor() && gObj.isServerRendered) {\n            var setVisible = [];\n            setVisible[0] = column;\n            this.parent.notify('setvisibility', setVisible);\n        }\n        this.colName = column.field;\n        var columns = JSON.parse(JSON.stringify(this.groupSettings.columns));\n        columns.splice(columns.indexOf(this.colName), 1);\n        if (this.sortedColumns.indexOf(columnName) < 0) {\n            for (var i = 0, len = gObj.sortSettings.columns.length; i < len; i++) {\n                if (columnName === gObj.sortSettings.columns[i].field) {\n                    gObj.sortSettings.columns.splice(i, 1);\n                    break;\n                }\n            }\n        }\n        var isServerRendered = 'isServerRendered';\n        if (isBlazor() && this.parent[isServerRendered]) {\n            gObj.sortSettings.columns = gObj.sortSettings.columns;\n        }\n        if (this.groupSettings.allowReordering) {\n            this.reorderingColumns = columns;\n        }\n        this.groupSettings.columns = columns;\n        if (gObj.allowGrouping) {\n            this.isAppliedUnGroup = true;\n            this.parent.dataBind();\n        }\n    };\n    /**\n     * The function used to update groupSettings\n     * @return {void}\n     * @hidden\n     */\n    Group.prototype.updateModel = function () {\n        var gObj = this.parent;\n        var i = 0;\n        var columns = JSON.parse(JSON.stringify(this.groupSettings.columns));\n        columns = this.reorderingColumns.length ? JSON.parse(JSON.stringify(this.reorderingColumns)) : columns;\n        if (this.sortRequired) {\n            if (columns.indexOf(this.colName) === -1) {\n                columns.push(this.colName);\n            }\n            this.groupAddSortingQuery(this.colName);\n        }\n        this.sortRequired = true;\n        this.parent.groupSettings.columns = columns;\n        this.parent.dataBind();\n    };\n    /**\n     * The function used to trigger onActionComplete\n     * @return {void}\n     * @hidden\n     */\n    Group.prototype.onActionComplete = function (e) {\n        if (isBlazor() && !this.parent.isJsComponent) {\n            e.rows = null;\n        }\n        var gObj = this.parent;\n        if (e.requestType === 'grouping') {\n            this.addColToGroupDrop(this.colName);\n        }\n        else {\n            this.removeColFromGroupDrop(this.colName);\n        }\n        var args = this.groupSettings.columns.indexOf(this.colName) > -1 ? {\n            columnName: this.colName, requestType: 'grouping', type: events.actionComplete\n        } : { requestType: 'ungrouping', type: events.actionComplete };\n        this.parent.trigger(events.actionComplete, extend(e, args));\n        this.colName = null;\n    };\n    Group.prototype.groupAddSortingQuery = function (colName) {\n        var i = 0;\n        while (i < this.parent.sortSettings.columns.length) {\n            if (this.parent.sortSettings.columns[i].field === colName) {\n                break;\n            }\n            i++;\n        }\n        if (this.parent.sortSettings.columns.length === i) {\n            this.parent.sortSettings.columns.push({ field: colName, direction: 'Ascending', isFromGroup: true });\n            var isServerRendered = 'isServerRendered';\n            if (isBlazor() && this.parent[isServerRendered]) {\n                this.parent.sortSettings.columns = this.parent.sortSettings.columns;\n            }\n        }\n        else if (!this.parent.allowSorting) {\n            this.parent.sortSettings.columns[i].direction = 'Ascending';\n        }\n    };\n    Group.prototype.createElement = function (field) {\n        var gObj = this.parent;\n        var direction = 'Ascending';\n        var animator = this.parent.createElement('div', { className: 'e-grid-icon e-group-animator' });\n        var groupedColumn = this.parent.createElement('div', { className: 'e-grid-icon e-groupheadercell' });\n        var childDiv = this.parent.createElement('div', { attrs: { 'ej-mappingname': field } });\n        var column = this.parent.getColumnByField(field);\n        //Todo headerTemplateID for grouped column, disableHtmlEncode                          \n        var headerCell = gObj.getColumnHeaderByUid(column.uid);\n        // if (!isNullOrUndefined(column.headerTemplate)) {\n        //     if (column.headerTemplate.indexOf('#') !== -1) {\n        //         childDiv.innerHTML = document.querySelector(column.headerTemplate).innerHTML.trim();\n        //     } else {\n        //         childDiv.innerHTML = column.headerTemplate;\n        //     }\n        //     childDiv.firstElementChild.classList.add('e-grouptext');\n        // } else {\n        if (this.groupSettings.allowReordering) {\n            childDiv.appendChild(this.parent.createElement('span', {\n                className: 'e-drag e-icons e-icon-drag', innerHTML: '&nbsp;',\n                attrs: { title: 'Drag', tabindex: '-1', 'aria-label': 'Drag the grouped column' }\n            }));\n        }\n        childDiv.appendChild(this.parent.createElement('span', {\n            className: 'e-grouptext', innerHTML: column.headerText,\n            attrs: { tabindex: '-1', 'aria-label': 'sort the grouped column' }\n        }));\n        // }\n        if (this.groupSettings.showToggleButton) {\n            childDiv.appendChild(this.parent.createElement('span', {\n                className: 'e-togglegroupbutton e-icons e-icon-ungroup e-toggleungroup', innerHTML: '&nbsp;',\n                attrs: { tabindex: '-1', 'aria-label': 'ungroup button' }\n            }));\n        }\n        if (headerCell.querySelectorAll('.e-ascending,.e-descending').length) {\n            direction = headerCell.querySelector('.e-ascending') ? 'Ascending' : 'Descending';\n        }\n        childDiv.appendChild(this.parent.createElement('span', {\n            className: 'e-groupsort e-icons ' +\n                ('e-' + direction.toLowerCase() + ' e-icon-' + direction.toLowerCase()), innerHTML: '&nbsp;',\n            attrs: { tabindex: '-1', 'aria-label': 'sort the grouped column' }\n        }));\n        childDiv.appendChild(this.parent.createElement('span', {\n            className: 'e-ungroupbutton e-icons e-icon-hide', innerHTML: '&nbsp;',\n            attrs: { title: isBlazor() ? this.l10n.getConstant('UnGroupButton') : this.l10n.getConstant('UnGroup'),\n                tabindex: '-1', 'aria-label': 'ungroup the grouped column' },\n            styles: this.groupSettings.showUngroupButton ? '' : 'display:none'\n        }));\n        groupedColumn.appendChild(childDiv);\n        var index = this.groupSettings.columns.indexOf(field);\n        if (this.groupSettings.allowReordering) {\n            animator.appendChild(groupedColumn);\n            animator.appendChild(this.createSeparator());\n            groupedColumn = animator;\n        }\n        return groupedColumn;\n    };\n    Group.prototype.addColToGroupDrop = function (field) {\n        if (this.groupSettings.allowReordering\n            && this.parent.element.querySelector('.e-groupdroparea div[ej-mappingname=' + field + ']')) {\n            return;\n        }\n        var column = this.parent.getColumnByField(field);\n        if (isNullOrUndefined(column)) {\n            return;\n        }\n        var groupedColumn = this.createElement(field);\n        if (this.groupSettings.allowReordering) {\n            var index = this.element.querySelectorAll('.e-group-animator').length;\n            groupedColumn.setAttribute('index', index.toString());\n        }\n        this.element.appendChild(groupedColumn);\n        //Todo:  rtl \n    };\n    Group.prototype.createSeparator = function () {\n        return this.parent.createElement('span', {\n            className: 'e-nextgroup e-icons e-icon-next', innerHTML: '&nbsp;',\n            attrs: { tabindex: '-1', 'aria-label': 'Separator for the grouped columns' },\n            styles: this.groupSettings.showUngroupButton ? '' : 'display:none'\n        });\n    };\n    Group.prototype.refreshToggleBtn = function (isRemove) {\n        if (this.groupSettings.showToggleButton) {\n            var headers = [].slice.call(this.parent.getHeaderTable().getElementsByClassName('e-headercelldiv'));\n            for (var i = 0, len = headers.length; i < len; i++) {\n                if (!((headers[i].classList.contains('e-emptycell')) || (headers[i].classList.contains('e-headerchkcelldiv')))) {\n                    var column = this.parent.getColumnByUid(headers[i].getAttribute('e-mappinguid'));\n                    if (!this.parent.showColumnMenu || (this.parent.showColumnMenu && !column.showColumnMenu)) {\n                        if (headers[i].querySelectorAll('.e-grptogglebtn').length) {\n                            remove(headers[i].querySelectorAll('.e-grptogglebtn')[0]);\n                        }\n                        if (!isRemove) {\n                            headers[i].appendChild(this.parent.createElement('span', {\n                                className: 'e-grptogglebtn e-icons ' +\n                                    (this.groupSettings.columns.indexOf(column.field) > -1 ? 'e-toggleungroup e-icon-ungroup'\n                                        : 'e-togglegroup e-icon-group'), attrs: { tabindex: '-1', 'aria-label': 'Group button' }\n                            }));\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Group.prototype.removeColFromGroupDrop = function (field) {\n        if (!isNullOrUndefined(this.getGHeaderCell(field))) {\n            var elem = this.getGHeaderCell(field);\n            if (this.groupSettings.allowReordering) {\n                var parent_1 = parentsUntil(elem, 'e-group-animator');\n                remove(parent_1);\n            }\n            else {\n                remove(elem);\n            }\n            this.updateGroupDropArea();\n        }\n        this.isAppliedUnGroup = false;\n    };\n    Group.prototype.onPropertyChanged = function (e) {\n        if (e.module !== this.getModuleName()) {\n            return;\n        }\n        for (var _i = 0, _a = Object.keys(e.properties); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'columns':\n                    var args = void 0;\n                    if (this.contentRefresh) {\n                        if (!this.isAppliedUnGroup) {\n                            if (!this.isAppliedGroup) {\n                                this.updateGroupDropArea(true);\n                                for (var j = 0; j < this.parent.sortSettings.columns.length; j++) {\n                                    if (this.parent.sortSettings.columns[j].isFromGroup) {\n                                        this.parent.sortSettings.columns.splice(j, 1);\n                                        j--;\n                                    }\n                                }\n                                for (var i = 0; i < this.groupSettings.columns.length; i++) {\n                                    this.colName = this.groupSettings.columns[i];\n                                    var col = this.parent.getColumnByField(this.colName);\n                                    col.visible = this.parent.groupSettings.showGroupedColumn;\n                                    this.groupAddSortingQuery(this.colName);\n                                    if (i < this.groupSettings.columns.length - 1) {\n                                        this.addColToGroupDrop(this.groupSettings.columns[i]);\n                                    }\n                                }\n                            }\n                            args = {\n                                columnName: this.colName, requestType: e.properties[prop].length ? 'grouping' : 'ungrouping',\n                                type: events.actionBegin\n                            };\n                        }\n                        else {\n                            args = { columnName: this.colName, requestType: 'ungrouping', type: events.actionBegin };\n                        }\n                        if (!this.groupSettings.showGroupedColumn) {\n                            var columns = e.oldProperties[prop];\n                            for (var i = 0; i < columns.length; i++) {\n                                if (e.properties[prop].indexOf(columns[i]) === -1) {\n                                    this.parent.getColumnByField(columns[i]).visible = true;\n                                }\n                            }\n                        }\n                        var requestType = 'requestType';\n                        if (isBlazor() && this.parent.isServerRendered && this.parent.isCollapseStateEnabled() &&\n                            args[requestType] === 'grouping') {\n                            this.parent.refreshHeader();\n                        }\n                        this.parent.notify(events.modelChanged, args);\n                    }\n                    break;\n                case 'showDropArea':\n                    this.updateGroupDropArea();\n                    this.groupSettings.showDropArea ? this.element.style.display = '' : this.element.style.display = 'none';\n                    break;\n                case 'showGroupedColumn':\n                    this.updateGroupedColumn(this.groupSettings.showGroupedColumn);\n                    this.parent.notify(events.modelChanged, { requestType: 'refresh' });\n                    break;\n                case 'showUngroupButton':\n                    this.updateButtonVisibility(this.groupSettings.showUngroupButton, 'e-ungroupbutton');\n                    break;\n                case 'showToggleButton':\n                    this.updateButtonVisibility(this.groupSettings.showToggleButton, 'e-togglegroupbutton ');\n                    this.parent.refreshHeader();\n                    break;\n                case 'enableLazyLoading':\n                    this.parent.freezeRefresh();\n                    break;\n            }\n        }\n    };\n    Group.prototype.updateGroupedColumn = function (isVisible) {\n        for (var i = 0; i < this.groupSettings.columns.length; i++) {\n            this.parent.getColumnByField(this.groupSettings.columns[i]).visible = isVisible;\n        }\n    };\n    Group.prototype.updateButtonVisibility = function (isVisible, className) {\n        var gHeader = [].slice.call(this.element.querySelectorAll('.' + className));\n        for (var i = 0; i < gHeader.length; i++) {\n            gHeader[i].style.display = isVisible ? '' : 'none';\n        }\n    };\n    Group.prototype.enableAfterRender = function (e) {\n        if (e.module === this.getModuleName() && e.enable) {\n            this.render();\n        }\n    };\n    /**\n     * To destroy the reorder\n     * @return {void}\n     * @hidden\n     */\n    Group.prototype.destroy = function () {\n        var gridElement = this.parent.element;\n        if (!gridElement || (!gridElement.querySelector('.e-gridheader') && !gridElement.querySelector('.e-gridcontent'))) {\n            return;\n        }\n        // tslint:disable-next-line:no-any\n        if (!this.parent.isDestroyed && !this.parent.refreshing) {\n            this.clearGrouping();\n        }\n        this.removeEventListener();\n        this.refreshToggleBtn(true);\n        remove(this.element);\n        //call ejdrag and drop destroy\n    };\n    /**\n     * Clears all the grouped columns of the Grid.\n     * @return {void}\n     */\n    Group.prototype.clearGrouping = function () {\n        var cols = JSON.parse(JSON.stringify(this.groupSettings.columns));\n        this.contentRefresh = false;\n        for (var i = 0, len = cols.length; i < len; i++) {\n            if (i === (len - 1)) {\n                this.contentRefresh = true;\n            }\n            this.ungroupColumn(cols[i]);\n        }\n        this.contentRefresh = true;\n    };\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    Group.prototype.getModuleName = function () {\n        return 'group';\n    };\n    Group.prototype.refreshSortIcons = function (e) {\n        var gObj = this.parent;\n        var header;\n        var cols = gObj.sortSettings.columns;\n        var gCols = gObj.groupSettings.columns;\n        var fieldNames = this.parent.getColumns().map(function (c) { return c.field; });\n        this.refreshToggleBtn();\n        for (var i = 0, len = cols.length; i < len; i++) {\n            if (fieldNames.indexOf(cols[i].field) === -1) {\n                continue;\n            }\n            header = gObj.getColumnHeaderByField(cols[i].field);\n            if (!gObj.allowSorting && (this.sortedColumns.indexOf(cols[i].field) > -1 ||\n                this.groupSettings.columns.indexOf(cols[i].field) > -1)) {\n                classList(header.querySelector('.e-sortfilterdiv'), ['e-ascending', 'e-icon-ascending'], []);\n                if (cols.length > 1) {\n                    header.querySelector('.e-headercelldiv').appendChild(this.parent.createElement('span', { className: 'e-sortnumber', innerHTML: (i + 1).toString() }));\n                }\n            }\n            else if (this.getGHeaderCell(cols[i].field) && this.getGHeaderCell(cols[i].field).querySelectorAll('.e-groupsort').length) {\n                if (cols[i].direction === 'Ascending') {\n                    classList(this.getGHeaderCell(cols[i].field).querySelector('.e-groupsort'), ['e-ascending', 'e-icon-ascending'], ['e-descending', 'e-icon-descending']);\n                }\n                else {\n                    classList(this.getGHeaderCell(cols[i].field).querySelector('.e-groupsort'), ['e-descending', 'e-icon-descending'], ['e-ascending', 'e-icon-ascending']);\n                }\n            }\n        }\n        for (var i = 0, len = gCols.length; i < len; i++) {\n            if (fieldNames.indexOf(gCols[i]) === -1) {\n                continue;\n            }\n            gObj.getColumnHeaderByField(gCols[i]).setAttribute('aria-grouped', 'true');\n        }\n    };\n    Group.prototype.getGHeaderCell = function (field) {\n        if (this.element && this.element.querySelector('[ej-mappingname=\"' + field + '\"]')) {\n            return this.element.querySelector('[ej-mappingname=\"' + field + '\"]').parentElement;\n        }\n        return null;\n    };\n    Group.prototype.onGroupAggregates = function (editedData) {\n        var aggregates = this.iterateGroupAggregates(editedData);\n        var rowData = this.groupGenerator.generateRows(aggregates, {});\n        var summaryRows = this.parent.getRowsObject().filter(function (row) { return !row.isDataRow; });\n        var updateSummaryRows = rowData.filter(function (data) { return !data.isDataRow; });\n        if (this.parent.isReact) {\n            this.parent.destroyTemplate(['groupFooterTemplate', 'groupCaptionTemplate', 'footerTemplate']);\n        }\n        for (var i = 0; i < updateSummaryRows.length; i++) {\n            var row = updateSummaryRows[i];\n            var cells = row.cells.filter(function (cell) { return cell.isDataCell; });\n            var args = { cells: cells, data: row.data, dataUid: summaryRows[i] ? summaryRows[i].uid : '' };\n            this.parent.notify(events.refreshAggregateCell, args);\n        }\n    };\n    Group.prototype.iterateGroupAggregates = function (editedData) {\n        var updatedData = editedData instanceof Array ? editedData : [];\n        var rows = this.parent.getRowsObject();\n        var initData = this.parent.getCurrentViewRecords();\n        var deletedCols = [];\n        var changeds = rows.map(function (row) {\n            if (row.edit === 'delete') {\n                deletedCols.push(row.data);\n            }\n            return row.changes instanceof Object ? row.changes : row.data;\n        });\n        var field = this.parent.getPrimaryKeyFieldNames()[0];\n        changeds = updatedData.length === 0 ? changeds : updatedData;\n        var mergeData = initData.map(function (item) {\n            var pKeyVal = DataUtil.getObject(field, item);\n            var value;\n            var hasVal = changeds.some(function (cItem) {\n                value = cItem;\n                return pKeyVal === DataUtil.getObject(field, cItem);\n            });\n            return hasVal ? value : item;\n        });\n        var eData = editedData;\n        if (!(eData.type && eData.type === 'cancel') && deletedCols.length > 0) {\n            for (var i = 0; i < deletedCols.length; i++) {\n                var index = mergeData.indexOf(deletedCols[i]);\n                mergeData.splice(index, 1);\n            }\n        }\n        var aggregates = [];\n        var aggregateRows = this.parent.aggregates;\n        for (var j = 0; j < aggregateRows.length; j++) {\n            var row = aggregateRows[j];\n            for (var k = 0; k < row.columns.length; k++) {\n                var aggr = {};\n                var type = row.columns[k].type.toString();\n                aggr = { type: type.toLowerCase(), field: row.columns[k].field };\n                aggregates.push(aggr);\n            }\n        }\n        var result;\n        var aggrds;\n        var groupedCols = this.parent.groupSettings.columns;\n        for (var l = 0; l < groupedCols.length; l++) {\n            aggrds = result ? result : mergeData;\n            result = DataUtil.group(aggrds, groupedCols[l], aggregates, null, null);\n        }\n        return result;\n    };\n    Group.prototype.updateExpand = function (args) {\n        var uid = args.uid;\n        var isExpand = args.isExpand;\n        var rows = this.parent.getRowsObject();\n        for (var i = 0; i < rows.length; i++) {\n            var row = rows[i];\n            if (row.uid === uid || isNullOrUndefined(uid)) {\n                row.isExpand = isExpand;\n                var _loop_1 = function (j) {\n                    var childRow = rows[j];\n                    var closestParent = void 0;\n                    if (childRow.parentUid !== row.uid) {\n                        closestParent = rows.filter(function (x) { return x.uid === childRow.parentUid; })[0];\n                    }\n                    if (childRow.parentUid === row.uid) {\n                        childRow.visible = row.isExpand;\n                    }\n                    else if (!isNullOrUndefined(closestParent) && childRow.parentUid === closestParent.uid) {\n                        if (closestParent.isExpand && closestParent.visible === true) {\n                            childRow.visible = true;\n                        }\n                        else if (closestParent.isExpand && closestParent.visible === false) {\n                            childRow.visible = false;\n                        }\n                    }\n                    if (isNullOrUndefined(uid)) {\n                        return \"break\";\n                    }\n                };\n                for (var j = i + 1; j < rows.length; j++) {\n                    var state_1 = _loop_1(j);\n                    if (state_1 === \"break\")\n                        break;\n                }\n            }\n        }\n        this.parent.notify(events.contentReady, { rows: rows, args: { isFrozen: false, rows: rows } });\n    };\n    return Group;\n}());\nexport { Group };\n"]},"metadata":{},"sourceType":"module"}